<!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->






<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Interface to MRCC by M. Kállay</title>
    <link rel="stylesheet" href="_static/psi4.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="_static/cloud.base.js"></script>
    <script type="text/javascript" src="_static/cloud.js"></script>
    <link rel="shortcut icon" href="_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Interface to PCMSolver by R. Di Remigio" href="pcmsolver.html" />
    <link rel="prev" title="Interface to Molden — molden()" href="molden.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="pcmsolver.html" title="Interface to PCMSolver by R. Di Remigio"
             accesskey="N"><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="molden.html" title="Interface to Molden — molden()"
             accesskey="P"><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             accesskey="C"><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/mrcc.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/406f4de">1.2.1</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="interfacing.html" accesskey="U">Interfaces: Enhancing <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> Capabilities</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="interface-to-mrcc-by-m-ka-acutellay">
<span id="sec-mrcc"></span><span id="index-0"></span><h1>Interface to MRCC by M. Kállay<a class="headerlink" href="#interface-to-mrcc-by-m-ka-acutellay" title="Permalink to this headline">¶</a></h1>
<p><em>Code author: Justin M. Turney and Andrew C. Simmonett</em></p>
<p><em>Section author: Justin M. Turney</em></p>
<p><em>Module:</em> <a class="reference internal" href="autodir_options_c/module__mrcc.html#apdx-mrcc"><span class="std std-ref">Keywords</span></a>, <a class="reference internal" href="autodir_psivariables/module__mrcc.html#apdx-mrcc-psivar"><span class="std std-ref">PSI Variables</span></a>, <a class="reference external" href="https://github.com/psi4/psi4/blob/master/src/bin/mrcc">MRCC</a>, <a class="reference internal" href="autodoc_testsuite_dftd3.html#apdx-testsuitedftd3"><span class="std std-ref">Samples</span></a></p>
<p><span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> contains code to interface to the MRCC program of M. Kállay
and J. Gauss.  The license and source code of the MRCC program must be
obtained from Mihály Kállay (<a class="reference external" href="http://www.mrcc.hu/">http://www.mrcc.hu/</a>).</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Follow the instructions provided with the source to build the MRCC programs.
To be used by <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>, ensure that the program binary (<code class="docutils literal notranslate"><span class="pre">dmrcc</span></code>) can be
found in your <span class="target" id="index-1"></span><a class="reference internal" href="external.html#envvar-PATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code></a>. If <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> is unable to execute the binary, an
error will be reported.</p>
</div>
<div class="section" id="running-mrcc">
<h2>Running MRCC<a class="headerlink" href="#running-mrcc" title="Permalink to this headline">¶</a></h2>
<p>MRCC can be invoked in similar fashion as other theories provided in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>.
For example, if you want to obtain the CCSDT energy for water with cc-pVDZ using
MRCC simply provide the following:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">molecule</span> <span class="n">h2o</span> <span class="p">{</span>
     <span class="n">O</span>
     <span class="n">H</span> <span class="mi">1</span> <span class="mf">1.0</span>
     <span class="n">H</span> <span class="mi">1</span> <span class="mf">1.0</span> <span class="mi">2</span> <span class="mf">104.5</span>
<span class="p">}</span>
<span class="nb">set</span> <span class="p">{</span>
     <span class="n">basis</span> <span class="n">cc</span><span class="o">-</span><span class="n">pVDZ</span>
<span class="p">}</span>
<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;mrccsdt&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p><code class="docutils literal notranslate"><span class="pre">'mrccsdt'</span></code> in the call to <a class="reference internal" href="energy.html#psi4.energy" title="psi4.energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy()</span></code></a> instructs <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> to first
perform an RHF calculation and then call MRCC to compute the CCSDT energy.
For a CCSDT(Q) energy, simply use <code class="docutils literal notranslate"><span class="pre">'mrccsdt(q)'</span></code> in the call to
<a class="reference internal" href="energy.html#psi4.energy" title="psi4.energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy()</span></code></a>. MRCC can be used to perform geometry optimization and
frequency calculations for electronic ground states only.</p>
<p>At this time, <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> is only able to automatically generate the proper
input file for MRCC for the methods listed in table below.
To utilize any method described in the table, you must prefix
the method name with <code class="docutils literal notranslate"><span class="pre">MR</span></code>. For other methods, you will be required to
use the MRCC keywords described in Appendix <a class="reference internal" href="autodir_options_c/module__mrcc.html#apdx-mrcc"><span class="std std-ref">MRCC</span></a>.
Perturbative methods (<code class="docutils literal notranslate"><span class="pre">ccsd(t)</span></code>, <code class="docutils literal notranslate"><span class="pre">ccsdtqp(h)_l</span></code>, etc.)
are available with <a class="reference internal" href="autodoc_glossary_options_c.html#term-reference-scf"><span class="xref std std-term">REFERENCE</span></a> ROHF in versions of MRCC published
at least after July 1, 2014.</p>
<p>When using ROHF-CCSDT(Q), MRCC will compute and report two variants:
CCSDT(Q)/A and CCSDT(Q)/B.[Kallay:2008:144101]_ Psi4 will save both energies but will use
the CCSDT(Q)/B as the CCSDT(Q) energy. CCSDT(Q)/B has been found to be
more robust by Martin.[Martin:2014:785]_</p>
<blockquote id="table-energy-mrcc">
<div><table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">calls method in Kallay’s MRCC program <a class="reference internal" href="#sec-mrcc"><span class="std std-ref">[manual]</span></a></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>mrccsd</td>
<td>CC through doubles</td>
</tr>
<tr class="row-odd"><td>mrccsdt</td>
<td>CC through triples</td>
</tr>
<tr class="row-even"><td>mrccsdtq</td>
<td>CC through quadruples</td>
</tr>
<tr class="row-odd"><td>mrccsdtqp</td>
<td>CC through quintuples</td>
</tr>
<tr class="row-even"><td>mrccsdtqph</td>
<td>CC through sextuples</td>
</tr>
<tr class="row-odd"><td>mrccsd(t)</td>
<td>CC through doubles with perturbative triples</td>
</tr>
<tr class="row-even"><td>mrccsdt(q)</td>
<td>CC through triples with perturbative quadruples</td>
</tr>
<tr class="row-odd"><td>mrccsdtq(p)</td>
<td>CC through quadruples with pertubative quintuples</td>
</tr>
<tr class="row-even"><td>mrccsdtqp(h)</td>
<td>CC through quintuples with pertubative sextuples</td>
</tr>
<tr class="row-odd"><td>mrccsd(t)_l</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>mrccsdt(q)_l</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>mrccsdtq(p)_l</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>mrccsdtqp(h)_l</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>mrccsdt-1a</td>
<td>CC through doubles with iterative triples (cheapest terms)</td>
</tr>
<tr class="row-even"><td>mrccsdtq-1a</td>
<td>CC through triples with iterative quadruples (cheapest terms)</td>
</tr>
<tr class="row-odd"><td>mrccsdtqp-1a</td>
<td>CC through quadruples with iterative quintuples (cheapest terms)</td>
</tr>
<tr class="row-even"><td>mrccsdtqph-1a</td>
<td>CC through quintuples with iterative sextuples (cheapest terms)</td>
</tr>
<tr class="row-odd"><td>mrccsdt-1b</td>
<td>CC through doubles with iterative triples (cheaper terms)</td>
</tr>
<tr class="row-even"><td>mrccsdtq-1b</td>
<td>CC through triples with iterative quadruples (cheaper terms)</td>
</tr>
<tr class="row-odd"><td>mrccsdtqp-1b</td>
<td>CC through quadruples with iterative quintuples (cheaper terms)</td>
</tr>
<tr class="row-even"><td>mrccsdtqph-1b</td>
<td>CC through quintuples with iterative sextuples (cheaper terms)</td>
</tr>
<tr class="row-odd"><td>mrcc2</td>
<td>approximate CC through doubles</td>
</tr>
<tr class="row-even"><td>mrcc3</td>
<td>approximate CC through triples</td>
</tr>
<tr class="row-odd"><td>mrcc4</td>
<td>approximate CC through quadruples</td>
</tr>
<tr class="row-even"><td>mrcc5</td>
<td>approximate CC through quintuples</td>
</tr>
<tr class="row-odd"><td>mrcc6</td>
<td>approximate CC through sextuples</td>
</tr>
<tr class="row-even"><td>mrccsdt-3</td>
<td>CC through doubles with iterative triples (all but the most expensive terms)</td>
</tr>
<tr class="row-odd"><td>mrccsdtq-3</td>
<td>CC through triples with iterative quadruples (all but the most expensive terms)</td>
</tr>
<tr class="row-even"><td>mrccsdtqp-3</td>
<td>CC through quadruples with iterative quintuples (all but the most expensive terms)</td>
</tr>
<tr class="row-odd"><td>mrccsdtqph-3</td>
<td>CC through quintuples with iterative sextuples (all but the most expensive terms)</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Frozen-core approximation is also supported in the MRCC interface.
To optimize CH<sub>4</sub> with CCSDT freezing the 1<em>s</em> on carbon, run:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">molecule</span> <span class="n">H2O</span> <span class="p">{</span>
    <span class="n">O</span>
    <span class="n">H</span> <span class="mi">1</span> <span class="n">r</span>
    <span class="n">H</span> <span class="mi">1</span> <span class="n">r</span> <span class="mi">2</span> <span class="mf">104.5</span>

    <span class="n">r</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="p">}</span>

<span class="nb">set</span> <span class="p">{</span>
    <span class="n">basis</span> <span class="n">cc</span><span class="o">-</span><span class="n">pVDZ</span>
    <span class="n">freeze_core</span> <span class="n">true</span>
<span class="p">}</span>

<span class="n">optimize</span><span class="p">(</span><span class="s1">&#39;mrccsdt&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="interface-details">
<h2>Interface Details<a class="headerlink" href="#interface-details" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils" id="id1">
<span id="table-mrcc-mrcc-method"></span><caption><span class="caption-text">MRCC methods</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="22%" />
<col width="15%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><a class="reference internal" href="autodoc_glossary_options_c.html#term-mrcc-method-mrcc"><span class="xref std std-term">MRCC_METHOD</span></a></th>
<th class="head">Method</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>CC</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>CC(n-1)[n]</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>3</td>
<td>CC(n-1)(n)</td>
<td>(CC(n-1)[n] energy is also calculated)</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>CC(n-1)(n)_L</td>
<td>(CC(n-1)[n] and CC(n-1)(n) energies are also calculated)</td>
</tr>
<tr class="row-even"><td>5</td>
<td>CC(n)-1a</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>CC(n)-1b</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>7</td>
<td>CCn</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>CC(n)-3</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="index.html" title="index">
          <img class="logo" src="_static/psi4square.png" alt="Logo"/>
        </a></p><!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->


<div id="searchbox" style="display: none" role="search">
  <!--<h3>Quick search</h3>-->
    <form class="search" action="search.html" method="get">
      <!--<div><input type="text" name="q" placeholder="search docs" /></div>-->
      <div><input type="text" name="q" placeholder="&#xF002;" style="font-family:FontAwesome, Ariel" /></div>
      <!--<div><input type="submit" value="Go" /></div>-->
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="index.html">table of contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Interface to MRCC by M. Kállay</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#running-mrcc">Running MRCC</a></li>
<li><a class="reference internal" href="#interface-details">Interface Details</a></li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="pcmsolver.html" title="Interface to PCMSolver by R. Di Remigio"
             ><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="molden.html" title="Interface to Molden — molden()"
             ><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             ><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/mrcc.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/406f4de">1.2.1</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="interfacing.html" >Interfaces: Enhancing <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> Capabilities</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, The Psi4 Project.
      Last updated on Wednesday, 25 July 2018 04:21AM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>