<!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->






<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>qcdb.interface_dftd3</title>
    <link rel="stylesheet" href="../../_static/psi4.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../../_static/cloud.base.js"></script>
    <script type="text/javascript" src="../../_static/cloud.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../index.html" title="Table Of Contents"
             accesskey="C"><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/_modules/qcdb/interface_dftd3.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/406f4de">1.2.1</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="../../index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for qcdb.interface_dftd3</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># @BEGIN LICENSE</span>
<span class="c1">#</span>
<span class="c1"># Psi4: an open-source quantum chemistry software package</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2007-2018 The Psi4 Developers.</span>
<span class="c1">#</span>
<span class="c1"># The copyrights for code used from other parties are included in</span>
<span class="c1"># the corresponding files.</span>
<span class="c1">#</span>
<span class="c1"># This file is part of Psi4.</span>
<span class="c1">#</span>
<span class="c1"># Psi4 is free software; you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Lesser General Public License as published by</span>
<span class="c1"># the Free Software Foundation, version 3.</span>
<span class="c1">#</span>
<span class="c1"># Psi4 is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Lesser General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU Lesser General Public License along</span>
<span class="c1"># with Psi4; if not, write to the Free Software Foundation, Inc.,</span>
<span class="c1"># 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>
<span class="c1">#</span>
<span class="c1"># @END LICENSE</span>
<span class="c1">#</span>

<span class="sd">&quot;&quot;&quot;Module with functions that interface with Grimme&#39;s DFTD3 code.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">psi4.driver.p4util.exceptions</span> <span class="k">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">psi4</span> <span class="k">import</span> <span class="n">core</span>
    <span class="n">isP4regime</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.exceptions</span> <span class="k">import</span> <span class="o">*</span>
    <span class="n">isP4regime</span> <span class="o">=</span> <span class="kc">False</span>
<span class="kn">from</span> <span class="nn">.dashparam</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.molecule</span> <span class="k">import</span> <span class="n">Molecule</span>


<div class="viewcode-block" id="run_dftd3"><a class="viewcode-back" href="../../dftd3.html#psi4.core.run_dftd3">[docs]</a><span class="k">def</span> <span class="nf">run_dftd3</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dashlvl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dashparam</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dertype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute dispersion correction using Grimme&#39;s DFTD3 executable.</span>

<span class="sd">    Function to call Grimme&#39;s dftd3 program to compute the -D correction</span>
<span class="sd">    of level `dashlvl` using parameters for the functional `func`.</span>
<span class="sd">    `dashparam` can supply a full set of dispersion parameters in the</span>
<span class="sd">    absence of `func` or individual overrides in the presence of `func`.</span>

<span class="sd">    The DFTD3 executable must be independently compiled and found in</span>
<span class="sd">    :envvar:`PATH` or :envvar:`PSIPATH`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mol : qcdb.Molecule or psi4.core.Molecule or str</span>
<span class="sd">	    Molecule on which to run dispersion calculation. Both qcdb and</span>
<span class="sd">	    psi4.core Molecule classes have been extended by this method, so</span>
<span class="sd">	    either allowed. Alternately, a string that can be instantiated</span>
<span class="sd">	    into a qcdb.Molecule.</span>
<span class="sd">    func : str or None</span>
<span class="sd">	    Density functional (Psi4, not Turbomole, names) for which to</span>
<span class="sd">	    load parameters from dashcoeff[dashlvl][func]. This is not</span>
<span class="sd">	    passed to DFTD3 and thus may be a dummy or `None`. Any or all</span>
<span class="sd">	    parameters initialized can be overwritten via `dashparam`.</span>
<span class="sd">    dashlvl : {&#39;d2p4&#39;, &#39;d2gr&#39;, &#39;d3zero&#39;, &#39;d3bj&#39;, &#39;d3mzero&#39;, d3mbj&#39;, &#39;d&#39;, &#39;d2&#39;, &#39;d3&#39;, &#39;d3m&#39;}</span>
<span class="sd">	    Flavor of a posteriori dispersion correction for which to load</span>
<span class="sd">	    parameters and call procedure in DFTD3. Must be a keys in</span>
<span class="sd">	    dashcoeff dict (or a key in dashalias that resolves to one).</span>
<span class="sd">    dashparam : dict, optional</span>
<span class="sd">	    Dictionary of the same keys as dashcoeff[dashlvl] used to</span>
<span class="sd">	    override any or all values initialized by</span>
<span class="sd">	    dashcoeff[dashlvl][func].</span>
<span class="sd">    dertype : {None, 0, &#39;none&#39;, &#39;energy&#39;, 1, &#39;first&#39;, &#39;gradient&#39;}, optional</span>
<span class="sd">	    Maximum derivative level at which to run DFTD3. For large</span>
<span class="sd">	    `mol`, energy-only calculations can be significantly more</span>
<span class="sd">	    efficient. Also controls return values, see below.</span>
<span class="sd">    verbose : bool, optional</span>
<span class="sd">        When `True`, additionally include DFTD3 output in output.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    energy : float, optional</span>
<span class="sd">        When `dertype` is 0, energy [Eh].</span>
<span class="sd">    gradient : list of lists of floats or psi4.core.Matrix, optional</span>
<span class="sd">        When `dertype` is 1, (nat, 3) gradient [Eh/a0].</span>
<span class="sd">    (energy, gradient) : float and list of lists of floats or psi4.core.Matrix, optional</span>
<span class="sd">        When `dertype` is unspecified, both energy [Eh] and (nat, 3) gradient [Eh/a0].</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    research site: https://www.chemie.uni-bonn.de/pctc/mulliken-center/software/dft-d3</span>
<span class="sd">    Psi4 mode: When `psi4` the python module is importable at `import qcdb`</span>
<span class="sd">               time, Psi4 mode is activated, with the following alterations:</span>
<span class="sd">               * output goes to output file</span>
<span class="sd">               * gradient returned as psi4.core.Matrix, not list o&#39;lists</span>
<span class="sd">               * scratch is written to randomly named subdirectory of psi scratch</span>
<span class="sd">               * psivar &quot;DISPERSION CORRECTION ENERGY&quot; is set</span>
<span class="sd">               * `verbose` triggered when PRINT keywork of SCF module &gt;=3</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create (if necessary) and update qcdb.Molecule</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">Molecule</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Molecule</span><span class="p">)):</span>
        <span class="c1"># 1st: called on a qcdb.Molecule</span>
        <span class="c1"># 2nd: called on a python export of a psi4.Molecule (py-side through Psi4&#39;s driver)</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
        <span class="c1"># called on a string representation of a psi4.Molecule (c-side through psi4.Dispersion)</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Argument mol must be psi4string or qcdb.Molecule&quot;&quot;&quot;</span><span class="p">)</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">update_geometry</span><span class="p">()</span>

    <span class="c1"># Validate arguments</span>
    <span class="k">if</span> <span class="n">dertype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dertype</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="n">der0th</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dertype</span><span class="p">)):</span>
        <span class="n">dertype</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">der1st</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dertype</span><span class="p">)):</span>
        <span class="n">dertype</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">der2nd</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dertype</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Requested derivative level &#39;dertype&#39; </span><span class="si">%s</span><span class="s2"> not valid for run_dftd3.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dertype</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Requested derivative level &#39;dertype&#39; </span><span class="si">%s</span><span class="s2"> not valid for run_dftd3.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dertype</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">dashlvl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dashlvl</span> <span class="o">=</span> <span class="n">dashlvl</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">dashlvl</span> <span class="o">=</span> <span class="n">get_dispersion_aliases</span><span class="p">()[</span><span class="n">dashlvl</span><span class="p">]</span> <span class="k">if</span> <span class="n">dashlvl</span> <span class="ow">in</span> <span class="n">get_dispersion_aliases</span><span class="p">()</span> <span class="k">else</span> <span class="n">dashlvl</span>
        <span class="k">if</span> <span class="n">dashlvl</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dashcoeff</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;-D correction level </span><span class="si">%s</span><span class="s2"> is not available. Choose among </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dashlvl</span><span class="p">,</span> <span class="n">dashcoeff</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Must specify a dashlvl&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dftd3_params</span> <span class="o">=</span> <span class="n">dash_server</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">dashlvl</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dftd3_params</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">dashparam</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dftd3_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dashparam</span><span class="p">)</span>

    <span class="c1"># Move ~/.dftd3par.&lt;hostname&gt; out of the way so it won&#39;t interfere</span>
    <span class="n">defaultfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/.dftd3par.&#39;</span> <span class="o">+</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>
    <span class="n">defmoved</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">defaultfile</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">defaultfile</span><span class="p">,</span> <span class="n">defaultfile</span> <span class="o">+</span> <span class="s1">&#39;_hide&#39;</span><span class="p">)</span>
        <span class="n">defmoved</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Find environment by merging PSIPATH and PATH environment variables</span>
    <span class="n">lenv</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;PATH&#39;</span><span class="p">:</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PSIPATH&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">])</span> <span class="o">+</span> \
                <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PATH&#39;</span><span class="p">),</span>
        <span class="s1">&#39;LD_LIBRARY_PATH&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LD_LIBRARY_PATH&#39;</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="c1">#   Filter out None values as subprocess will fault on them</span>
    <span class="n">lenv</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lenv</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>

    <span class="c1"># Find out if running from Psi4 for scratch details and such</span>
    <span class="c1"># try:</span>
    <span class="c1">#     import psi4</span>
    <span class="c1"># except ImportError as err:</span>
    <span class="c1">#     isP4regime = False</span>
    <span class="c1"># else:</span>
    <span class="c1">#     isP4regime = True</span>

    <span class="c1"># Setup unique scratch directory and move in</span>
    <span class="n">current_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">isP4regime</span><span class="p">:</span>
        <span class="n">psioh</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">IOManager</span><span class="o">.</span><span class="n">shared_object</span><span class="p">()</span>
        <span class="n">psio</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">shared_object</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">psioh</span><span class="o">.</span><span class="n">get_default_path</span><span class="p">())</span>
        <span class="n">dftd3_tmpdir</span> <span class="o">=</span> <span class="s1">&#39;psi.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">psio</span><span class="o">.</span><span class="n">get_default_namespace</span><span class="p">()</span> <span class="o">+</span> \
            <span class="s1">&#39;.dftd3.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())[:</span><span class="mi">8</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dftd3_tmpdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s1">&#39;dftd3_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())[:</span><span class="mi">8</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dftd3_tmpdir</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dftd3_tmpdir</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">dftd3_tmpdir</span><span class="p">)</span>

    <span class="c1"># Write dftd3_parameters file that governs dispersion calc</span>
    <span class="n">paramcontents</span> <span class="o">=</span> <span class="n">dftd3_coeff_formatter</span><span class="p">(</span><span class="n">dashlvl</span><span class="p">,</span> <span class="n">dftd3_params</span><span class="p">)</span>
    <span class="n">paramfile1</span> <span class="o">=</span> <span class="s1">&#39;dftd3_parameters&#39;</span>  <span class="c1"># older patched name</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">paramfile1</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
        <span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">paramcontents</span><span class="p">)</span>
    <span class="n">paramfile2</span> <span class="o">=</span> <span class="s1">&#39;.dftd3par.local&#39;</span>  <span class="c1"># new mainline name</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">paramfile2</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
        <span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">paramcontents</span><span class="p">)</span>

    <span class="c1"># Write dftd3_geometry file that supplies geometry to dispersion calc</span>
    <span class="n">numAtoms</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">natom</span><span class="p">()</span>

    <span class="c1"># We seem to have a problem with one atom, force the correct result</span>
    <span class="k">if</span> <span class="n">numAtoms</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">current_directory</span><span class="p">)</span>
        <span class="n">dashd</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">dashdderiv</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dertype</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dashd</span><span class="p">,</span> <span class="n">dashdderiv</span>
        <span class="k">elif</span> <span class="n">dertype</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dashd</span>
        <span class="k">elif</span> <span class="n">dertype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dashdderiv</span>


    <span class="n">geom</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">save_string_xyz</span><span class="p">()</span>
    <span class="n">reals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">geom</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
        <span class="n">lline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lline</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">lline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Gh&#39;</span><span class="p">:</span>
            <span class="n">numAtoms</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="n">geomtext</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">numAtoms</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reals</span><span class="p">:</span>
        <span class="n">geomtext</span> <span class="o">+=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">geomfile</span> <span class="o">=</span> <span class="s1">&#39;./dftd3_geometry.xyz&#39;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">geomfile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
        <span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">geomtext</span><span class="p">)</span>
    <span class="c1"># TODO somehow the variations on save_string_xyz and</span>
    <span class="c1">#   whether natom and chgmult does or doesn&#39;t get written</span>
    <span class="c1">#   have gotten all tangled. I fear this doesn&#39;t work</span>
    <span class="c1">#   the same btwn libmints and qcdb or for ghosts</span>

    <span class="c1"># Call dftd3 program</span>
    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dftd3&#39;</span><span class="p">,</span> <span class="n">geomfile</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">dertype</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;-grad&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dashout</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">lenv</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Program dftd3 not found in path. </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
    <span class="n">out</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">dashout</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>

    <span class="c1"># Parse output (could go further and break into E6, E8, E10 and Cn coeff)</span>
    <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">out</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39; Edisp /kcal,au&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
            <span class="n">sline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">dashd</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sline</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39; normal termination of dftd3&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
            <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">current_directory</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">Dftd3Error</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Unsuccessful run. Possibly -D variant not available in dftd3 version.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># Parse grad output</span>
    <span class="k">if</span> <span class="n">dertype</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">derivfile</span> <span class="o">=</span> <span class="s1">&#39;./dftd3_gradient&#39;</span>
        <span class="n">dfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">derivfile</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">dashdderiv</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">geom</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="n">lline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lline</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">lline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Gh&#39;</span><span class="p">:</span>
                <span class="n">dashdderiv</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dashdderiv</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
        <span class="n">dfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dashdderiv</span><span class="p">)</span> <span class="o">!=</span> <span class="n">mol</span><span class="o">.</span><span class="n">natom</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Program dftd3 gradient file has </span><span class="si">%d</span><span class="s1"> atoms- </span><span class="si">%d</span><span class="s1"> expected.&#39;</span> <span class="o">%</span> \
                <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dashdderiv</span><span class="p">),</span> <span class="n">mol</span><span class="o">.</span><span class="n">natom</span><span class="p">()))</span>

    <span class="c1"># Prepare results for Psi4</span>
    <span class="k">if</span> <span class="n">isP4regime</span> <span class="ow">and</span> <span class="n">dertype</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">core</span><span class="o">.</span><span class="n">set_variable</span><span class="p">(</span><span class="s1">&#39;DISPERSION CORRECTION ENERGY&#39;</span><span class="p">,</span> <span class="n">dashd</span><span class="p">)</span>
        <span class="n">psi_dashdderiv</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">dashdderiv</span><span class="p">)</span>

    <span class="c1"># Print program output to file if verbose</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">verbose</span> <span class="ow">and</span> <span class="n">isP4regime</span><span class="p">:</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">core</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s1">&#39;SCF&#39;</span><span class="p">,</span> <span class="s1">&#39;PRINT&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>

        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  ==&gt; DFTD3 Output &lt;==</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="n">out</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dertype</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">derivfile</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="n">handle</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">isP4regime</span><span class="p">:</span>
            <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="c1"># Clean up files and remove scratch directory</span>
    <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">paramfile1</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">paramfile2</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">geomfile</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dertype</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">derivfile</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">defmoved</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">defaultfile</span> <span class="o">+</span> <span class="s1">&#39;_hide&#39;</span><span class="p">,</span> <span class="n">defaultfile</span><span class="p">)</span>

    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">dftd3_tmpdir</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Unable to remove dftd3 temporary directory </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">current_directory</span><span class="p">)</span>

    <span class="c1"># return -D &amp; d(-D)/dx</span>
    <span class="k">if</span> <span class="n">dertype</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dashd</span><span class="p">,</span> <span class="n">dashdderiv</span>
    <span class="k">elif</span> <span class="n">dertype</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dashd</span>
    <span class="k">elif</span> <span class="n">dertype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">psi_dashdderiv</span></div>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Attach method to libmints psi4.Molecule class</span>
    <span class="n">core</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">run_dftd3</span> <span class="o">=</span> <span class="n">run_dftd3</span>
<span class="k">except</span> <span class="p">(</span><span class="ne">NameError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
    <span class="c1"># But don&#39;t worry if that doesn&#39;t work b/c</span>
    <span class="c1">#   it&#39;ll get attached to qcdb.Molecule class</span>
    <span class="k">pass</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../../index.html" title="index">
          <img class="logo" src="../../_static/psi4square.png" alt="Logo"/>
        </a></p><!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->


<div id="searchbox" style="display: none" role="search">
  <!--<h3>Quick search</h3>-->
    <form class="search" action="../../search.html" method="get">
      <!--<div><input type="text" name="q" placeholder="search docs" /></div>-->
      <div><input type="text" name="q" placeholder="&#xF002;" style="font-family:FontAwesome, Ariel" /></div>
      <!--<div><input type="submit" value="Go" /></div>-->
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >Index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../index.html" title="Table Of Contents"
             ><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/_modules/qcdb/interface_dftd3.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/406f4de">1.2.1</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="../../index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, The Psi4 Project.
      Last updated on Wednesday, 25 July 2018 04:21AM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>