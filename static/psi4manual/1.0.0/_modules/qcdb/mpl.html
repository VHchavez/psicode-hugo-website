

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>qcdb.mpl &mdash; Psi4 [1.0.0 6a9a71b] Docs</title>
    
    <link rel="stylesheet" href="../../_static/psi4.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.0 6a9a71b',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../../_static/toggle_sections.js"></script>
    <script type="text/javascript" src="../../_static/toggle_sidebar.js"></script>
    <script type="text/javascript" src="../../_static/toggle_codeprompt.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon-psi4.ico"/>
    <link rel="top" title="Psi4 [1.0.0 6a9a71b] Docs" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body role="document">
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../contents.html" title="Table Of Contents"
             accesskey="C">toc</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">Psi4 [1.0.0 6a9a71b]</a> &raquo; </li>

          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for qcdb.mpl</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Module with matplotlib plotting routines. These are not hooked up to</span>
<span class="sd">any particular qcdb data structures but can be called with basic</span>
<span class="sd">arguments.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1">#import matplotlib</span>
<span class="c1">#matplotlib.use(&#39;Agg&#39;)</span>


<div class="viewcode-block" id="expand_saveas"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.mpl.expand_saveas">[docs]</a><span class="k">def</span> <span class="nf">expand_saveas</span><span class="p">(</span><span class="n">saveas</span><span class="p">,</span> <span class="n">def_filename</span><span class="p">,</span> <span class="n">def_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">curdir</span><span class="p">),</span> <span class="n">def_prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Analyzes string *saveas* to see if it contains information on</span>
<span class="sd">    path to save file, name to save file, both or neither (*saveas*</span>
<span class="sd">    ends in &#39;/&#39; to indicate directory only) (able to expand &#39;.&#39;). A full</span>
<span class="sd">    absolute filename is returned, lacking only file extension. Based on</span>
<span class="sd">    analysis of missing parts of *saveas*, path information from *def_path*</span>
<span class="sd">    and/or filename information from *def_prefix* + *def_filename* is</span>
<span class="sd">    inserted. *def_prefix* is intended to be something like ``mplthread_``</span>
<span class="sd">    to identify the type of figure.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">defname</span> <span class="o">=</span> <span class="n">def_prefix</span> <span class="o">+</span> <span class="n">def_filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">pth</span> <span class="o">=</span> <span class="n">def_path</span>
        <span class="n">fil</span> <span class="o">=</span> <span class="n">defname</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pth</span><span class="p">,</span> <span class="n">fil</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">saveas</span><span class="p">)</span>
        <span class="n">pth</span> <span class="o">=</span> <span class="n">pth</span> <span class="k">if</span> <span class="n">pth</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="n">def_path</span>
        <span class="n">fil</span> <span class="o">=</span> <span class="n">fil</span> <span class="k">if</span> <span class="n">fil</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="n">defname</span>

    <span class="n">abspathfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">pth</span><span class="p">),</span> <span class="n">fil</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">relpath</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">abspathfile</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">abspathfile</span></div>


<div class="viewcode-block" id="segment_color"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.mpl.segment_color">[docs]</a><span class="k">def</span> <span class="nf">segment_color</span><span class="p">(</span><span class="n">argcolor</span><span class="p">,</span> <span class="n">saptcolor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find appropriate color expression between overall color directive</span>
<span class="sd">    *argcolor* and particular color availibility *rxncolor*.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>

    <span class="c1"># validate any sapt color</span>
    <span class="k">if</span> <span class="n">saptcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">saptcolor</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="n">saptcolor</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">saptcolor</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="n">argcolor</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># no color argument, so take from rxn</span>
        <span class="k">if</span> <span class="n">rxncolor</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">clr</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span>
        <span class="k">elif</span> <span class="n">saptcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">clr</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">saptcolor</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">clr</span> <span class="o">=</span> <span class="n">rxncolor</span>
    <span class="k">elif</span> <span class="n">argcolor</span> <span class="o">==</span> <span class="s1">&#39;sapt&#39;</span><span class="p">:</span>
        <span class="c1"># sapt color from rxn if available</span>
        <span class="k">if</span> <span class="n">saptcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">clr</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">saptcolor</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">clr</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span>
    <span class="k">elif</span> <span class="n">argcolor</span> <span class="o">==</span> <span class="s1">&#39;rgb&#39;</span><span class="p">:</span>
        <span class="c1"># HB/MX/DD sapt color from rxn if available</span>
        <span class="k">if</span> <span class="n">saptcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">saptcolor</span> <span class="o">&lt;</span> <span class="mf">0.333</span><span class="p">:</span>
                <span class="n">clr</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span>
            <span class="k">elif</span> <span class="n">saptcolor</span> <span class="o">&lt;</span> <span class="mf">0.667</span><span class="p">:</span>
                <span class="n">clr</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">clr</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">clr</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># color argument is name of mpl color</span>
        <span class="n">clr</span> <span class="o">=</span> <span class="n">argcolor</span>

    <span class="k">return</span> <span class="n">clr</span></div>


<div class="viewcode-block" id="bars"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.mpl.bars">[docs]</a><span class="k">def</span> <span class="nf">bars</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">],</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a &#39;gray-bars&#39; diagram between model chemistries with error</span>
<span class="sd">    statistics in list *data*, which is supplied as part of the dictionary</span>
<span class="sd">    for each participating bar/modelchem, along with *mc* keys in argument</span>
<span class="sd">    *data*. The plot is labeled with *title* and each bar with *mc* key and</span>
<span class="sd">    plotted at a fixed scale to facilitate comparison across projects.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">hashlib</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

    <span class="c1"># initialize plot, fix dimensions for consistent Illustrator import</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.86</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>

    <span class="c1"># label plot and tiers</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">4.6</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span>
        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
        <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="n">widths</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">]</span>  <span class="c1"># TT, HB, MX, DD</span>
    <span class="n">xval</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># starting posn along x-axis</span>

    <span class="c1"># plot bar sets</span>
    <span class="k">for</span> <span class="n">bar</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">lefts</span> <span class="o">=</span> <span class="p">[</span><span class="n">xval</span><span class="p">,</span> <span class="n">xval</span> <span class="o">+</span> <span class="mf">0.025</span><span class="p">,</span> <span class="n">xval</span> <span class="o">+</span> <span class="mf">0.065</span><span class="p">,</span> <span class="n">xval</span> <span class="o">+</span> <span class="mf">0.105</span><span class="p">]</span>

            <span class="n">rect</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">lefts</span><span class="p">,</span> <span class="n">bar</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">widths</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">rect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
            <span class="n">rect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="n">rect</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
            <span class="n">rect</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xval</span> <span class="o">+</span> <span class="o">.</span><span class="mi">08</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">,</span> <span class="n">bar</span><span class="p">[</span><span class="s1">&#39;mc&#39;</span><span class="p">],</span>
                <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">xval</span> <span class="o">+=</span> <span class="mf">0.20</span>

    <span class="c1"># save and show</span>
    <span class="n">pltuid</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">([</span><span class="n">bar</span><span class="p">[</span><span class="s1">&#39;mc&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">bar</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">bar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">]))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">pltfile</span> <span class="o">=</span> <span class="n">expand_saveas</span><span class="p">(</span><span class="n">saveas</span><span class="p">,</span> <span class="n">pltuid</span><span class="p">,</span> <span class="n">def_prefix</span><span class="o">=</span><span class="s1">&#39;bar_&#39;</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">)</span>
    <span class="n">files_saved</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">graphicsformat</span><span class="p">:</span>
        <span class="n">savefile</span> <span class="o">=</span> <span class="n">pltfile</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefile</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">ext</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">files_saved</span><span class="p">[</span><span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">savefile</span>
    <span class="k">if</span> <span class="n">view</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">files_saved</span></div>


<div class="viewcode-block" id="flat"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.mpl.flat">[docs]</a><span class="k">def</span> <span class="nf">flat</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">xlines</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">mae</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mape</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Generates a slat diagram between model chemistries with errors in</span>
<span class="sd">    single-item list *data*, which is supplied as part of the dictionary</span>
<span class="sd">    for each participating reaction, along with *dbse* and *rxn* keys in</span>
<span class="sd">    argument *data*. Limits of plot are *xlimit* from the zero-line. If</span>
<span class="sd">    *color* is None, slats are black, if &#39;sapt&#39;, colors are taken from</span>
<span class="sd">    sapt_colors module. Summary statistic *mae* is plotted on the</span>
<span class="sd">    overbound side and relative statistic *mape* on the underbound side.</span>
<span class="sd">    Saves a file with name *title* and plots to screen if *view*.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

    <span class="n">Nweft</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">Nweft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># initialize plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">xlimit</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">Nweft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="c1">#    fig.patch.set_visible(False)</span>
<span class="c1">#    ax.patch.set_visible(False)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">xl</span> <span class="ow">in</span> <span class="n">xlines</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xl</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">xl</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="c1"># plot reaction errors and threads</span>
    <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">xvals</span> <span class="o">=</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
        <span class="n">clr</span> <span class="o">=</span> <span class="n">segment_color</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">in</span> <span class="n">rxn</span> <span class="k">else</span> <span class="bp">None</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mf">13.0</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="c1"># plot trimmings</span>
    <span class="k">if</span> <span class="n">mae</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">mae</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c1"># equivalent to MAE for a 10 kcal/mol interaction energy</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.025</span> <span class="o">*</span> <span class="n">mape</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mf">15.0</span><span class="p">)</span>

    <span class="c1"># save and show</span>
    <span class="n">pltuid</span> <span class="o">=</span> <span class="n">title</span>  <span class="c1"># simple (not really unique) filename for LaTeX integration</span>
    <span class="n">pltfile</span> <span class="o">=</span> <span class="n">expand_saveas</span><span class="p">(</span><span class="n">saveas</span><span class="p">,</span> <span class="n">pltuid</span><span class="p">,</span> <span class="n">def_prefix</span><span class="o">=</span><span class="s1">&#39;flat_&#39;</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">)</span>
    <span class="n">files_saved</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">graphicsformat</span><span class="p">:</span>
        <span class="n">savefile</span> <span class="o">=</span> <span class="n">pltfile</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefile</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">ext</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span>
                   <span class="n">frameon</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">files_saved</span><span class="p">[</span><span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">savefile</span>
    <span class="k">if</span> <span class="n">view</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># give this a try</span>
    <span class="k">return</span> <span class="n">files_saved</span></div>


<span class="c1">#def mpl_distslat_multiplot_files(pltfile, dbid, dbname, xmin, xmax, mcdats, labels, titles):</span>
<span class="c1">#    &quot;&quot;&quot;Saves a plot with basename *pltfile* with a slat representation</span>
<span class="c1">#    of the modelchems errors in *mcdat*. Plot is in PNG, PDF, &amp; EPS</span>
<span class="c1">#    and suitable for download, no mouseover properties. Both labeled</span>
<span class="c1">#    and labelless (for pub) figures are constructed.</span>
<span class="c1">#</span>
<span class="c1">#    &quot;&quot;&quot;</span>
<span class="c1">#    import matplotlib as mpl</span>
<span class="c1">#    from matplotlib.axes import Subplot</span>
<span class="c1">#    import sapt_colors</span>
<span class="c1">#    from matplotlib.figure import Figure</span>
<span class="c1">#</span>
<span class="c1">#    nplots = len(mcdats)</span>
<span class="c1">#    fht = nplots * 0.8</span>
<span class="c1">#    fig, axt = plt.subplots(figsize=(12.0, fht))</span>
<span class="c1">#    plt.subplots_adjust(left=0.01, right=0.99, hspace=0.3)</span>
<span class="c1">#</span>
<span class="c1">#    axt.set_xticks([])</span>
<span class="c1">#    axt.set_yticks([])</span>
<span class="c1">#    plt.axis(&#39;off&#39;)</span>
<span class="c1">#</span>
<span class="c1">#    for item in range(nplots):</span>
<span class="c1">#        mcdat = mcdats[item]</span>
<span class="c1">#        label = labels[item]</span>
<span class="c1">#        title = titles[item]</span>
<span class="c1">#</span>
<span class="c1">#        erdat = np.array(mcdat)</span>
<span class="c1">#        yvals = np.ones(len(mcdat))</span>
<span class="c1">#        y = np.array([sapt_colors.sapt_colors[dbname][i] for i in label])</span>
<span class="c1">#</span>
<span class="c1">#        ax = Subplot(fig, nplots, 1, item + 1)</span>
<span class="c1">#        fig.add_subplot(ax)</span>
<span class="c1">#        sc = ax.scatter(erdat, yvals, c=y, s=3000, marker=&quot;|&quot;, cmap=mpl.cm.jet, vmin=0, vmax=1)</span>
<span class="c1">#</span>
<span class="c1">#        ax.set_yticks([])</span>
<span class="c1">#        ax.set_xticks([])</span>
<span class="c1">#        ax.set_frame_on(False)</span>
<span class="c1">#        ax.set_xlim([xmin, xmax])</span>
<span class="c1">#</span>
<span class="c1">#    # Write files with only slats</span>
<span class="c1">#    plt.savefig(&#39;scratch/&#39; + pltfile + &#39;_plain&#39; + &#39;.png&#39;, transparent=True, format=&#39;PNG&#39;)</span>
<span class="c1">#    plt.savefig(&#39;scratch/&#39; + pltfile + &#39;_plain&#39; + &#39;.pdf&#39;, transparent=True, format=&#39;PDF&#39;)</span>
<span class="c1">#    plt.savefig(&#39;scratch/&#39; + pltfile + &#39;_plain&#39; + &#39;.eps&#39;, transparent=True, format=&#39;EPS&#39;)</span>
<span class="c1">#</span>
<span class="c1">#    # Rewrite files with guides and labels</span>
<span class="c1">#    for item in range(nplots):</span>
<span class="c1">#        ax_again = fig.add_subplot(nplots, 1, item + 1)</span>
<span class="c1">#        ax_again.set_title(titles[item], fontsize=8)</span>
<span class="c1">#        ax_again.text(xmin + 0.3, 1.0, stats(np.array(mcdats[item])), fontsize=7, family=&#39;monospace&#39;, verticalalignment=&#39;center&#39;)</span>
<span class="c1">#        ax_again.plot([0, 0], [0.9, 1.1], color=&#39;#cccc00&#39;, lw=2)</span>
<span class="c1">#        ax_again.set_frame_on(False)</span>
<span class="c1">#        ax_again.set_yticks([])</span>
<span class="c1">#        ax_again.set_xticks([-12.0, -8.0, -4.0, -2.0, -1.0, 0.0, 1.0, 2.0, 4.0, 8.0, 12.0])</span>
<span class="c1">#        ax_again.tick_params(axis=&#39;both&#39;, which=&#39;major&#39;, labelbottom=&#39;off&#39;, bottom=&#39;off&#39;)</span>
<span class="c1">#    ax_again.set_xticks([-12.0, -8.0, -4.0, -2.0, -1.0, 0.0, 1.0, 2.0, 4.0, 8.0, 12.0])</span>
<span class="c1">#    ax_again.tick_params(axis=&#39;both&#39;, which=&#39;major&#39;, labelbottom=&#39;on&#39;, bottom=&#39;off&#39;)</span>
<span class="c1">#</span>
<span class="c1">#    plt.savefig(&#39;scratch/&#39; + pltfile + &#39;_trimd&#39; + &#39;.png&#39;, transparent=True, format=&#39;PNG&#39;)</span>
<span class="c1">#    plt.savefig(&#39;scratch/&#39; + pltfile + &#39;_trimd&#39; + &#39;.pdf&#39;, transparent=True, format=&#39;PDF&#39;)</span>
<span class="c1">#    plt.savefig(&#39;scratch/&#39; + pltfile + &#39;_trimd&#39; + &#39;.eps&#39;, transparent=True, format=&#39;EPS&#39;)</span>


<div class="viewcode-block" id="valerr"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.mpl.valerr">[docs]</a><span class="k">def</span> <span class="nf">valerr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xtitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">hashlib</span>
    <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reaction Energy&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccc00&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy Error&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xtitle</span><span class="p">)</span>

    <span class="n">xmin</span> <span class="o">=</span> <span class="mf">500.0</span>
    <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">500.0</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">vmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">emin</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">emax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">linecycler</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">])</span>
    <span class="c1"># plot reaction errors and threads</span>
    <span class="k">for</span> <span class="n">trace</span><span class="p">,</span> <span class="n">tracedata</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
        <span class="n">vaxis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vmcdata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">verror</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">tracedata</span><span class="p">:</span>
            <span class="n">clr</span> <span class="o">=</span> <span class="n">segment_color</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">in</span> <span class="n">rxn</span> <span class="k">else</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">])</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">])</span>

            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">],</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;mcdata&#39;</span><span class="p">],</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">vmcdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;mcdata&#39;</span><span class="p">])</span>
            <span class="n">vaxis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">])</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;mcdata&#39;</span><span class="p">])</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;mcdata&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;bmdata&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">],</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;bmdata&#39;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;bmdata&#39;</span><span class="p">])</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;bmdata&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">],</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
                <span class="n">emin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">emin</span><span class="p">,</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">emax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">emax</span><span class="p">,</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">verror</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">ls</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">linecycler</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vaxis</span><span class="p">,</span> <span class="n">vmcdata</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vaxis</span><span class="p">,</span> <span class="n">verror</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">xbuf</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">0.02</span> <span class="o">*</span> <span class="n">xmax</span><span class="p">))</span>
    <span class="n">vbuf</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">0.02</span> <span class="o">*</span> <span class="n">vmax</span><span class="p">))</span>
    <span class="n">ebuf</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">0.02</span> <span class="o">*</span> <span class="n">emax</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">xmin</span> <span class="o">-</span> <span class="n">xbuf</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">+</span> <span class="n">xbuf</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">vmin</span> <span class="o">-</span> <span class="n">vbuf</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">+</span> <span class="n">vbuf</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-small&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">emin</span> <span class="o">-</span> <span class="n">ebuf</span><span class="p">,</span> <span class="n">emax</span> <span class="o">+</span> <span class="n">ebuf</span><span class="p">])</span>

    <span class="c1"># save and show</span>
    <span class="n">pltuid</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">pltfile</span> <span class="o">=</span> <span class="n">expand_saveas</span><span class="p">(</span><span class="n">saveas</span><span class="p">,</span> <span class="n">pltuid</span><span class="p">,</span> <span class="n">def_prefix</span><span class="o">=</span><span class="s1">&#39;valerr_&#39;</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">)</span>
    <span class="n">files_saved</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">graphicsformat</span><span class="p">:</span>
        <span class="n">savefile</span> <span class="o">=</span> <span class="n">pltfile</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefile</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">ext</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">files_saved</span><span class="p">[</span><span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">savefile</span>
    <span class="k">if</span> <span class="n">view</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># give this a try</span>
    <span class="k">return</span> <span class="n">files_saved</span></div>


<div class="viewcode-block" id="disthist"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.mpl.disthist">[docs]</a><span class="k">def</span> <span class="nf">disthist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xtitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">me</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">stde</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Saves a plot with name *saveas* with a histogram representation</span>
<span class="sd">    of the reaction errors in *data*. Also plots a gaussian distribution</span>
<span class="sd">    with mean *me* and standard deviation *stde*. Plot has x-range</span>
<span class="sd">    *xmin* to *xmax*, x-axis label *xtitle* and overall title *title*.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">hashlib</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

    <span class="k">def</span> <span class="nf">gaussianpdf</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;*u* is mean, *v* is variance, *x* is value, returns probability&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">pow</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">u</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">v</span><span class="p">)</span>

    <span class="n">me</span> <span class="o">=</span> <span class="n">me</span> <span class="k">if</span> <span class="n">me</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">stde</span> <span class="o">=</span> <span class="n">stde</span> <span class="k">if</span> <span class="n">stde</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">evenerr</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">stde</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">me</span> <span class="o">+</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">stde</span><span class="p">))</span>
    <span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span> <span class="k">if</span> <span class="n">xmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">evenerr</span>
    <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span> <span class="k">if</span> <span class="n">xmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">evenerr</span>

    <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span> <span class="o">/</span> <span class="mf">40.</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span> <span class="o">/</span> <span class="n">dx</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">pdfx</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pdfy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span>
        <span class="n">ix</span> <span class="o">=</span> <span class="n">xmin</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">dx</span>
        <span class="n">pdfx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
        <span class="n">pdfy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gaussianpdf</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="n">stde</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">ix</span><span class="p">))</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccc00&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#2d4065&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xtitle</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">pdfx</span><span class="p">,</span> <span class="n">pdfy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># save and show</span>
    <span class="n">pltuid</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">me</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stde</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">xmax</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">pltfile</span> <span class="o">=</span> <span class="n">expand_saveas</span><span class="p">(</span><span class="n">saveas</span><span class="p">,</span> <span class="n">pltuid</span><span class="p">,</span> <span class="n">def_prefix</span><span class="o">=</span><span class="s1">&#39;disthist_&#39;</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">)</span>
    <span class="n">files_saved</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">graphicsformat</span><span class="p">:</span>
        <span class="n">savefile</span> <span class="o">=</span> <span class="n">pltfile</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefile</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">ext</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">files_saved</span><span class="p">[</span><span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">savefile</span>
    <span class="k">if</span> <span class="n">view</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">files_saved</span></div>


<span class="c1">#def thread(data, labels, color=None, title=&#39;&#39;, xlimit=4.0, mae=None, mape=None):</span>
<span class="c1">#    &quot;&quot;&quot;Generates a tiered slat diagram between model chemistries with</span>
<span class="c1">#    errors (or simply values) in list *data*, which is supplied as part of the</span>
<span class="c1">#    dictionary for each participating reaction, along with *dbse* and *rxn* keys</span>
<span class="c1">#    in argument *data*. The plot is labeled with *title* and each tier with</span>
<span class="c1">#    an element of *labels* and plotted at *xlimit* from the zero-line. If</span>
<span class="c1">#    *color* is None, slats are black, if &#39;sapt&#39;, colors are taken from *color*</span>
<span class="c1">#    key in *data* [0, 1]. Summary statistics *mae* are plotted on the</span>
<span class="c1">#    overbound side and relative statistics *mape* on the underbound side.</span>
<span class="c1">#</span>
<span class="c1">#    &quot;&quot;&quot;</span>
<span class="c1">#    from random import random</span>
<span class="c1">#    import matplotlib.pyplot as plt</span>
<span class="c1">#</span>
<span class="c1">#    # initialize tiers/wefts</span>
<span class="c1">#    Nweft = len(labels)</span>
<span class="c1">#    lenS = 0.2</span>
<span class="c1">#    gapT = 0.04</span>
<span class="c1">#    positions = range(-1, -1 * Nweft - 1, -1)</span>
<span class="c1">#    posnS = []</span>
<span class="c1">#    for weft in range(Nweft):</span>
<span class="c1">#        posnS.extend([positions[weft] + lenS, positions[weft] - lenS, None])</span>
<span class="c1">#    posnT = []</span>
<span class="c1">#    for weft in range(Nweft - 1):</span>
<span class="c1">#        posnT.extend([positions[weft] - lenS - gapT, positions[weft + 1] + lenS + gapT, None])</span>
<span class="c1">#</span>
<span class="c1">#    # initialize plot</span>
<span class="c1">#    fht = Nweft * 0.8</span>
<span class="c1">#    fig, ax = plt.subplots(figsize=(12, fht))</span>
<span class="c1">#    plt.subplots_adjust(left=0.01, right=0.99, hspace=0.3)</span>
<span class="c1">#    plt.xlim([-xlimit, xlimit])</span>
<span class="c1">#    plt.ylim([-1 * Nweft - 1, 0])</span>
<span class="c1">#    plt.yticks([])</span>
<span class="c1">#</span>
<span class="c1">#    # label plot and tiers</span>
<span class="c1">#    ax.text(-0.9 * xlimit, -0.25, title,</span>
<span class="c1">#        verticalalignment=&#39;bottom&#39;, horizontalalignment=&#39;left&#39;,</span>
<span class="c1">#        family=&#39;Times New Roman&#39;, weight=&#39;bold&#39;, fontsize=12)</span>
<span class="c1">#    for weft in labels:</span>
<span class="c1">#        ax.text(-0.9 * xlimit, -(1.2 + labels.index(weft)), weft,</span>
<span class="c1">#            verticalalignment=&#39;bottom&#39;, horizontalalignment=&#39;left&#39;,</span>
<span class="c1">#            family=&#39;Times New Roman&#39;, weight=&#39;bold&#39;, fontsize=18)</span>
<span class="c1">#</span>
<span class="c1">#    # plot reaction errors and threads</span>
<span class="c1">#    for rxn in data:</span>
<span class="c1">#</span>
<span class="c1">#        # preparation</span>
<span class="c1">#        xvals = rxn[&#39;data&#39;]</span>
<span class="c1">#        clr = segment_color(color, rxn[&#39;color&#39;] if &#39;color&#39; in rxn else None)</span>
<span class="c1">#        slat = []</span>
<span class="c1">#        for weft in range(Nweft):</span>
<span class="c1">#            slat.extend([xvals[weft], xvals[weft], None])</span>
<span class="c1">#        thread = []</span>
<span class="c1">#        for weft in range(Nweft - 1):</span>
<span class="c1">#            thread.extend([xvals[weft], xvals[weft + 1], None])</span>
<span class="c1">#</span>
<span class="c1">#        # plotting</span>
<span class="c1">#        ax.plot(slat, posnS, color=clr, linewidth=1.0, solid_capstyle=&#39;round&#39;)</span>
<span class="c1">#        ax.plot(thread, posnT, color=clr, linewidth=0.5, solid_capstyle=&#39;round&#39;,</span>
<span class="c1">#            alpha=0.3)</span>
<span class="c1">#</span>
<span class="c1">#        # labeling</span>
<span class="c1">#        try:</span>
<span class="c1">#            toplblposn = next(item for item in xvals if item is not None)</span>
<span class="c1">#            botlblposn = next(item for item in reversed(xvals) if item is not None)</span>
<span class="c1">#        except StopIteration:</span>
<span class="c1">#            pass</span>
<span class="c1">#        else:</span>
<span class="c1">#            ax.text(toplblposn, -0.75 + 0.6 * random(), rxn[&#39;sys&#39;],</span>
<span class="c1">#                verticalalignment=&#39;bottom&#39;, horizontalalignment=&#39;center&#39;,</span>
<span class="c1">#                family=&#39;Times New Roman&#39;, fontsize=8)</span>
<span class="c1">#            ax.text(botlblposn, -1 * Nweft - 0.75 + 0.6 * random(), rxn[&#39;sys&#39;],</span>
<span class="c1">#                verticalalignment=&#39;bottom&#39;, horizontalalignment=&#39;center&#39;,</span>
<span class="c1">#                family=&#39;Times New Roman&#39;, fontsize=8)</span>
<span class="c1">#</span>
<span class="c1">#    # plot trimmings</span>
<span class="c1">#    if mae is not None:</span>
<span class="c1">#        ax.plot([-x for x in mae], positions, &#39;s&#39;, color=&#39;black&#39;)</span>
<span class="c1">#    if mape is not None:  # equivalent to MAE for a 10 kcal/mol IE</span>
<span class="c1">#        ax.plot([0.025 * x for x in mape], positions, &#39;o&#39;, color=&#39;black&#39;)</span>
<span class="c1">#</span>
<span class="c1">#    plt.axvline(0, color=&#39;black&#39;)</span>
<span class="c1">#    plt.show()</span>


<div class="viewcode-block" id="threads"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.mpl.threads">[docs]</a><span class="k">def</span> <span class="nf">threads</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">mae</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mape</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">mousetext</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mouselink</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mouseimag</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mousetitle</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mousediv</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">labeled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Generates a tiered slat diagram between model chemistries with</span>
<span class="sd">    errors (or simply values) in list *data*, which is supplied as part of the</span>
<span class="sd">    dictionary for each participating reaction, along with *dbse* and *rxn* keys</span>
<span class="sd">    in argument *data*. The plot is labeled with *title* and each tier with</span>
<span class="sd">    an element of *labels* and plotted at *xlimit* from the zero-line. If</span>
<span class="sd">    *color* is None, slats are black, if &#39;sapt&#39;, colors are taken from *color*</span>
<span class="sd">    key in *data* [0, 1]. Summary statistics *mae* are plotted on the</span>
<span class="sd">    overbound side and relative statistics *mape* on the underbound side.</span>
<span class="sd">    HTML code for mouseover if mousetext or mouselink or mouseimag specified</span>
<span class="sd">    based on recipe of Andrew Dalke from</span>
<span class="sd">    http://www.dalkescientific.com/writings/diary/archive/2005/04/24/interactive_html.html</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">random</span>
    <span class="kn">import</span> <span class="nn">hashlib</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>  <span class="c1"># only needed for missing data with mouseiness</span>

    <span class="c1"># initialize tiers/wefts</span>
    <span class="n">Nweft</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">lenS</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">gapT</span> <span class="o">=</span> <span class="mf">0.04</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">Nweft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">posnS</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">weft</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nweft</span><span class="p">):</span>
        <span class="n">posnS</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">positions</span><span class="p">[</span><span class="n">weft</span><span class="p">]</span> <span class="o">+</span> <span class="n">lenS</span><span class="p">,</span> <span class="n">positions</span><span class="p">[</span><span class="n">weft</span><span class="p">]</span> <span class="o">-</span> <span class="n">lenS</span><span class="p">,</span> <span class="bp">None</span><span class="p">])</span>
    <span class="n">posnT</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">weft</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nweft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">posnT</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">positions</span><span class="p">[</span><span class="n">weft</span><span class="p">]</span> <span class="o">-</span> <span class="n">lenS</span> <span class="o">-</span> <span class="n">gapT</span><span class="p">,</span> <span class="n">positions</span><span class="p">[</span><span class="n">weft</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">lenS</span> <span class="o">+</span> <span class="n">gapT</span><span class="p">,</span> <span class="bp">None</span><span class="p">])</span>
    <span class="n">posnM</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># initialize plot</span>
    <span class="n">fht</span> <span class="o">=</span> <span class="n">Nweft</span> <span class="o">*</span> <span class="mf">0.8</span>
    <span class="c1">#fig, ax = plt.subplots(figsize=(12, fht))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">fht</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">xlimit</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">Nweft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labeled</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">xlimit</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">xlimit</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">xlimit</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">xlimit</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
        <span class="n">tick</span><span class="o">.</span><span class="n">tick1line</span><span class="o">.</span><span class="n">set_markersize</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">tick</span><span class="o">.</span><span class="n">tick2line</span><span class="o">.</span><span class="n">set_markersize</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># label plot and tiers</span>
    <span class="k">if</span> <span class="n">labeled</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.9</span> <span class="o">*</span> <span class="n">xlimit</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">weft</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.9</span> <span class="o">*</span> <span class="n">xlimit</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="mf">1.2</span> <span class="o">+</span> <span class="n">labels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">weft</span><span class="p">)),</span> <span class="n">weft</span><span class="p">,</span>
                <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

    <span class="c1"># plot reaction errors and threads</span>
    <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>

        <span class="c1"># preparation</span>
        <span class="n">xvals</span> <span class="o">=</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
        <span class="n">clr</span> <span class="o">=</span> <span class="n">segment_color</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">in</span> <span class="n">rxn</span> <span class="k">else</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">slat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">weft</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nweft</span><span class="p">):</span>
            <span class="n">slat</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">xvals</span><span class="p">[</span><span class="n">weft</span><span class="p">],</span> <span class="n">xvals</span><span class="p">[</span><span class="n">weft</span><span class="p">],</span> <span class="bp">None</span><span class="p">])</span>
        <span class="n">thread</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">weft</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nweft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">thread</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">xvals</span><span class="p">[</span><span class="n">weft</span><span class="p">],</span> <span class="n">xvals</span><span class="p">[</span><span class="n">weft</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">None</span><span class="p">])</span>

        <span class="c1"># plotting</span>
        <span class="k">if</span> <span class="n">Nweft</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">slat</span><span class="p">,</span> <span class="n">posnS</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">solid_capstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">slat</span><span class="p">,</span> <span class="n">posnS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">solid_capstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thread</span><span class="p">,</span> <span class="n">posnT</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">solid_capstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># converting into screen coordinates for image map</span>
        <span class="n">npxvals</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">xvals</span><span class="p">]</span>
        <span class="n">xyscreen</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">npxvals</span><span class="p">,</span> <span class="n">positions</span><span class="p">))</span>
        <span class="n">xscreen</span><span class="p">,</span> <span class="n">yscreen</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">xyscreen</span><span class="p">)</span>
        <span class="n">posnM</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]]</span> <span class="o">*</span> <span class="n">Nweft</span><span class="p">,</span> <span class="p">[</span><span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;sys&#39;</span><span class="p">]]</span> <span class="o">*</span> <span class="n">Nweft</span><span class="p">,</span>
            <span class="n">npxvals</span><span class="p">,</span> <span class="p">[</span><span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">]]</span> <span class="o">*</span> <span class="n">Nweft</span><span class="p">,</span> <span class="n">xscreen</span><span class="p">,</span> <span class="n">yscreen</span><span class="p">))</span>

        <span class="c1"># labeling</span>
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">mousetext</span> <span class="ow">or</span> <span class="n">mouselink</span> <span class="ow">or</span> <span class="n">mouseimag</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">labeled</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">toplblposn</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xvals</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span>
                    <span class="n">botlblposn</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">xvals</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">toplblposn</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span> <span class="o">+</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;sys&#39;</span><span class="p">],</span>
                        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                        <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">botlblposn</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">Nweft</span> <span class="o">-</span> <span class="mf">0.75</span> <span class="o">+</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">rxn</span><span class="p">[</span><span class="s1">&#39;sys&#39;</span><span class="p">],</span>
                        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                        <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="c1"># plot trimmings</span>
    <span class="k">if</span> <span class="n">mae</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mae</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labeled</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c1"># equivalent to MAE for a 10 kcal/mol IE</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.025</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mape</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccc00&#39;</span><span class="p">)</span>

    <span class="c1"># save and show</span>
    <span class="n">pltuid</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;lbld&#39;</span> <span class="k">if</span> <span class="n">labeled</span> <span class="k">else</span> <span class="s1">&#39;bare&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">xlimit</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">pltfile</span> <span class="o">=</span> <span class="n">expand_saveas</span><span class="p">(</span><span class="n">saveas</span><span class="p">,</span> <span class="n">pltuid</span><span class="p">,</span> <span class="n">def_prefix</span><span class="o">=</span><span class="s1">&#39;thread_&#39;</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">)</span>
    <span class="n">files_saved</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">graphicsformat</span><span class="p">:</span>
        <span class="n">savefile</span> <span class="o">=</span> <span class="n">pltfile</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefile</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">ext</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">files_saved</span><span class="p">[</span><span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">savefile</span>
    <span class="k">if</span> <span class="n">view</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">mousetext</span> <span class="ow">or</span> <span class="n">mouselink</span> <span class="ow">or</span> <span class="n">mouseimag</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">files_saved</span><span class="p">,</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dpi</span> <span class="o">=</span> <span class="mi">80</span>
        <span class="n">img_width</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_figwidth</span><span class="p">()</span> <span class="o">*</span> <span class="n">dpi</span>
        <span class="n">img_height</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_figheight</span><span class="p">()</span> <span class="o">*</span> <span class="n">dpi</span>

        <span class="n">htmlcode</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;SCRIPT&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;function mouseshow(db, rxn, val, show) {</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mousetext</span> <span class="ow">or</span> <span class="n">mouselink</span><span class="p">:</span>
            <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;   var cid = document.getElementById(&quot;cid&quot;);</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">mousetext</span><span class="p">:</span>
                <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;   cid.innerHTML = </span><span class="si">%s</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mousetext</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mouselink</span><span class="p">:</span>
                <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;   cid.href = </span><span class="si">%s</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mouselink</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mouseimag</span><span class="p">:</span>
            <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;   var cmpd_img = document.getElementById(&quot;cmpd_img&quot;);</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
            <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;   cmpd_img.src = </span><span class="si">%s</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mouseimag</span><span class="p">)</span>
        <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;}</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;&lt;/SCRIPT&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">mousediv</span><span class="p">:</span>
            <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mousediv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mousetitle</span><span class="p">:</span>
            <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span><span class="s2"> &lt;BR&gt;&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mousetitle</span><span class="p">)</span>
        <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;&lt;h4&gt;Mouseover&lt;/h4&gt;&lt;a id=&quot;cid&quot;&gt;&lt;/a&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mouseimag</span><span class="p">:</span>
            <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;&lt;div class=&quot;text-center&quot;&gt;&quot;&quot;&quot;</span>
            <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;&lt;IMG ID=&quot;cmpd_img&quot; WIDTH=&quot;</span><span class="si">%d</span><span class="s2">&quot; HEIGHT=&quot;</span><span class="si">%d</span><span class="s2">&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">160</span><span class="p">)</span>
            <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;&lt;/div&gt;&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mousediv</span><span class="p">:</span>
            <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mousediv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1">#htmlcode += &quot;&quot;&quot;&lt;IMG SRC=&quot;%s&quot; ismap usemap=&quot;#points&quot; WIDTH=&quot;%d&quot; HEIGHT=&quot;%d&quot;&gt;\n&quot;&quot;&quot; % \</span>
        <span class="c1">#    (pltfile + &#39;.png&#39;, img_width, img_height)</span>
        <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;&lt;IMG SRC=&quot;</span><span class="si">%s</span><span class="s2">&quot; ismap usemap=&quot;#points&quot; WIDTH=&quot;</span><span class="si">%d</span><span class="s2">&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> \
            <span class="p">(</span><span class="n">pltfile</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">img_width</span><span class="p">)</span>
        <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;&lt;MAP name=&quot;points&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>

        <span class="c1"># generating html image map code</span>
        <span class="c1">#   points sorted to avoid overlapping map areas that can overwhelm html for SSI</span>
        <span class="c1">#   y=0 on top for html and on bottom for mpl, so flip the numbers</span>
        <span class="n">posnM</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">posnM</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="n">tup</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">last</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">show</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">posnM</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">val</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">now</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">now</span> <span class="o">==</span> <span class="n">last</span><span class="p">:</span>
                <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;&lt;!-- map overlap! </span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2"> </span><span class="si">%+.2f</span><span class="s2"> skipped --&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;&lt;AREA shape=&quot;rect&quot; coords=&quot;</span><span class="si">%d</span><span class="s2">,</span><span class="si">%d</span><span class="s2">,</span><span class="si">%d</span><span class="s2">,</span><span class="si">%d</span><span class="s2">&quot; onmouseover=&quot;javascript:mouseshow(&#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;</span><span class="si">%+.2f</span><span class="s2">&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;);&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> \
                    <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">img_height</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span>
                    <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">img_height</span> <span class="o">-</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">20</span><span class="p">,</span>
                    <span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">show</span><span class="p">)</span>
                <span class="n">last</span> <span class="o">=</span> <span class="n">now</span>

        <span class="n">htmlcode</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;&lt;/MAP&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">files_saved</span><span class="p">,</span> <span class="n">htmlcode</span></div>


<div class="viewcode-block" id="ternary"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.mpl.ternary">[docs]</a><span class="k">def</span> <span class="nf">ternary</span><span class="p">(</span><span class="n">sapt</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">labeled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Takes array of arrays *sapt* in form [elst, indc, disp] and builds formatted</span>
<span class="sd">    two-triangle ternary diagrams. Either fully-readable or dotsonly depending</span>
<span class="sd">    on *labeled*. Saves in formats *graphicsformat*.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">hashlib</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="kn">as</span> <span class="nn">mpl</span>
    <span class="kn">from</span> <span class="nn">matplotlib.path</span> <span class="kn">import</span> <span class="n">Path</span>
    <span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="kn">as</span> <span class="nn">patches</span>

    <span class="c1"># initialize plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.18</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">labeled</span><span class="p">:</span>
        <span class="c1"># form and color ternary triangles</span>
        <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">]</span>
        <span class="n">pathPos</span> <span class="o">=</span> <span class="n">Path</span><span class="p">([(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.866</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)],</span> <span class="n">codes</span><span class="p">)</span>
        <span class="n">pathNeg</span> <span class="o">=</span> <span class="n">Path</span><span class="p">([(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.866</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.866</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)],</span> <span class="n">codes</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">PathPatch</span><span class="p">(</span><span class="n">pathPos</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">PathPatch</span><span class="p">(</span><span class="n">pathNeg</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#fff5ee&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

        <span class="c1"># form and color HB/MX/DD dividing lines</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.667</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.866</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#eeb4b4&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.333</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.577</span><span class="p">,</span> <span class="mf">0.866</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#eeb4b4&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.333</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.866</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#7ec0ee&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.167</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.289</span><span class="p">,</span> <span class="mf">0.866</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#7ec0ee&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="c1"># label corners</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="s1">u&#39;Elst (</span><span class="se">\u2212</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">u&#39;Ind (</span><span class="se">\u2212</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="s1">u&#39;Disp (</span><span class="se">\u2212</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">u&#39;Elst (+)&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

    <span class="n">xvals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yvals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cvals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sys</span> <span class="ow">in</span> <span class="n">sapt</span><span class="p">:</span>
        <span class="p">[</span><span class="n">elst</span><span class="p">,</span> <span class="n">indc</span><span class="p">,</span> <span class="n">disp</span><span class="p">]</span> <span class="o">=</span> <span class="n">sys</span>

        <span class="c1"># calc ternary posn and color</span>
        <span class="n">Ftop</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">indc</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">elst</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">indc</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">disp</span><span class="p">))</span>
        <span class="n">Fright</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">elst</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">elst</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">indc</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">disp</span><span class="p">))</span>
        <span class="n">xdot</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">Ftop</span> <span class="o">+</span> <span class="n">Fright</span>
        <span class="n">ydot</span> <span class="o">=</span> <span class="mf">0.866</span> <span class="o">*</span> <span class="n">Ftop</span>
        <span class="n">cdot</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="p">(</span><span class="n">xdot</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">Ftop</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">elst</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">xdot</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ftop</span> <span class="o">-</span> <span class="n">Fright</span><span class="p">)</span>
            <span class="n">ydot</span> <span class="o">=</span> <span class="mf">0.866</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ftop</span> <span class="o">+</span> <span class="n">Fright</span><span class="p">)</span>
        <span class="c1">#print elst, indc, disp, &#39;&#39;, xdot, ydot, cdot</span>

        <span class="n">xvals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xdot</span><span class="p">)</span>
        <span class="n">yvals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ydot</span><span class="p">)</span>
        <span class="n">cvals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cdot</span><span class="p">)</span>

    <span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cvals</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> \
        <span class="n">cmap</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># remove figure outline</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

    <span class="c1"># save and show</span>
    <span class="n">pltuid</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;lbld&#39;</span> <span class="k">if</span> <span class="n">labeled</span> <span class="k">else</span> <span class="s1">&#39;bare&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">sapt</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">pltfile</span> <span class="o">=</span> <span class="n">expand_saveas</span><span class="p">(</span><span class="n">saveas</span><span class="p">,</span> <span class="n">pltuid</span><span class="p">,</span> <span class="n">def_prefix</span><span class="o">=</span><span class="s1">&#39;tern_&#39;</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">)</span>
    <span class="n">files_saved</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">graphicsformat</span><span class="p">:</span>
        <span class="n">savefile</span> <span class="o">=</span> <span class="n">pltfile</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefile</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">ext</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span>
                    <span class="n">frameon</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">files_saved</span><span class="p">[</span><span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">savefile</span>
    <span class="k">if</span> <span class="n">view</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">files_saved</span></div>


<span class="c1">#def thread_mouseover_web(pltfile, dbid, dbname, xmin, xmax, mcdats, labels, titles):</span>
<span class="c1">#    &quot;&quot;&quot;Saves a plot with name *pltfile* with a slat representation of</span>
<span class="c1">#    the modelchems errors in *mcdat*. Mouseover shows geometry and error</span>
<span class="c1">#    from *labels* based on recipe of Andrew Dalke from</span>
<span class="c1">#    http://www.dalkescientific.com/writings/diary/archive/2005/04/24/interactive_html.html</span>
<span class="c1">#</span>
<span class="c1">#    &quot;&quot;&quot;</span>
<span class="c1">#    from matplotlib.backends.backend_agg import FigureCanvasAgg</span>
<span class="c1">#    import matplotlib</span>
<span class="c1">#    import sapt_colors</span>
<span class="c1">#</span>
<span class="c1">#    cmpd_width = 200</span>
<span class="c1">#    cmpd_height = 160</span>
<span class="c1">#</span>
<span class="c1">#    nplots = len(mcdats)</span>
<span class="c1">#    fht = nplots * 0.8</span>
<span class="c1">#    fht = nplots * 0.8 * 1.4</span>
<span class="c1">#    fig = matplotlib.figure.Figure(figsize=(12.0, fht))</span>
<span class="c1">#    fig.subplots_adjust(left=0.01, right=0.99, hspace=0.3, top=0.8, bottom=0.2)</span>
<span class="c1">#    img_width = fig.get_figwidth() * 80</span>
<span class="c1">#    img_height = fig.get_figheight() * 80</span>
<span class="c1">#</span>
<span class="c1">#    htmlcode = &quot;&quot;&quot;</span>
<span class="c1">#&lt;SCRIPT&gt;</span>
<span class="c1">#function mouseandshow(name, id, db, dbname) {</span>
<span class="c1">#  var cid = document.getElementById(&quot;cid&quot;);</span>
<span class="c1">#  cid.innerHTML = name;</span>
<span class="c1">#  cid.href = &quot;fragmentviewer.py?name=&quot; + id + &quot;&amp;dataset=&quot; + db;</span>
<span class="c1">#  var cmpd_img = document.getElementById(&quot;cmpd_img&quot;);</span>
<span class="c1">#  cmpd_img.src = dbname + &quot;/dimers/&quot; + id + &quot;.png&quot;;</span>
<span class="c1">#}</span>
<span class="c1">#&lt;/SCRIPT&gt;</span>
<span class="c1">#</span>
<span class="c1">#Distribution of Fragment Errors in Interaction Energy (kcal/mol)&lt;BR&gt;</span>
<span class="c1">#Mouseover:&lt;BR&gt;&lt;a id=&quot;cid&quot;&gt;&lt;/a&gt;&lt;br&gt;</span>
<span class="c1">#&lt;IMG SRC=&quot;scratch/%s&quot; ismap usemap=&quot;#points&quot; WIDTH=&quot;%d&quot; HEIGHT=&quot;%d&quot;&gt;</span>
<span class="c1">#&lt;IMG ID=&quot;cmpd_img&quot; WIDTH=&quot;%d&quot; HEIGHT=&quot;%d&quot;&gt;</span>
<span class="c1">#&lt;MAP name=&quot;points&quot;&gt;</span>
<span class="c1">#&quot;&quot;&quot; % (pltfile, img_width, img_height, cmpd_width, cmpd_height)</span>
<span class="c1">#</span>
<span class="c1">#    for item in range(nplots):</span>
<span class="c1">#        print &#39;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#39;</span>
<span class="c1">#        mcdat = mcdats[item]</span>
<span class="c1">#        label = labels[item]</span>
<span class="c1">#        tttle = titles[item]</span>
<span class="c1">#</span>
<span class="c1">#        erdat = np.array(mcdat)</span>
<span class="c1">#        # No masked_array because interferes with html map</span>
<span class="c1">#        #erdat = np.ma.masked_array(mcdat, mask=mask)</span>
<span class="c1">#        yvals = np.ones(len(mcdat))</span>
<span class="c1">#        y = np.array([sapt_colors.sapt_colors[dbname][i] for i in label])</span>
<span class="c1">#</span>
<span class="c1">#        ax = fig.add_subplot(nplots, 1, item + 1)</span>
<span class="c1">#        sc = ax.scatter(erdat, yvals, c=y, s=3000, marker=&quot;|&quot;, cmap=matplotlib.cm.jet, vmin=0, vmax=1)</span>
<span class="c1">#        ax.set_title(tttle, fontsize=8)</span>
<span class="c1">#        ax.set_yticks([])</span>
<span class="c1">#        lp = ax.plot([0, 0], [0.9, 1.1], color=&#39;#cccc00&#39;, lw=2)</span>
<span class="c1">#        ax.set_ylim([0.95, 1.05])</span>
<span class="c1">#        ax.text(xmin + 0.3, 1.0, stats(erdat), fontsize=7, family=&#39;monospace&#39;, verticalalignment=&#39;center&#39;)</span>
<span class="c1">#        if item + 1 == nplots:</span>
<span class="c1">#            ax.set_xticks([-12.0, -8.0, -4.0, -2.0, -1.0, 0.0, 1.0, 2.0, 4.0, 8.0, 12.0])</span>
<span class="c1">#            for tick in ax.xaxis.get_major_ticks():</span>
<span class="c1">#                tick.tick1line.set_markersize(0)</span>
<span class="c1">#                tick.tick2line.set_markersize(0)</span>
<span class="c1">#        else:</span>
<span class="c1">#            ax.set_xticks([])</span>
<span class="c1">#        ax.set_frame_on(False)</span>
<span class="c1">#        ax.set_xlim([xmin, xmax])</span>
<span class="c1">#</span>
<span class="c1">#        # Convert the data set points into screen space coordinates</span>
<span class="c1">#        #xyscreencoords = ax.transData.transform(zip(erdat, yvals))</span>
<span class="c1">#        xyscreencoords = ax.transData.transform(zip(erdat, yvals))</span>
<span class="c1">#        xcoords, ycoords = zip(*xyscreencoords)</span>
<span class="c1">#</span>
<span class="c1">#        # HTML image coordinates have y=0 on the top.  Matplotlib</span>
<span class="c1">#        # has y=0 on the bottom.  We&#39;ll need to flip the numbers</span>
<span class="c1">#        for cid, x, y, er in zip(label, xcoords, ycoords, erdat):</span>
<span class="c1">#            htmlcode += &quot;&quot;&quot;&lt;AREA shape=&quot;rect&quot; coords=&quot;%d,%d,%d,%d&quot; onmouseover=&quot;javascript:mouseandshow(&#39;%s %+.2f&#39;, &#39;%s&#39;, %s, &#39;%s&#39;);&quot;&gt;\n&quot;&quot;&quot; % \</span>
<span class="c1">#                (x - 2, img_height - y - 20, x + 2, img_height - y + 20, cid, er, cid, dbid, dbname)</span>
<span class="c1">#</span>
<span class="c1">#    htmlcode += &quot;&lt;/MAP&gt;\n&quot;</span>
<span class="c1">#    canvas = FigureCanvasAgg(fig)</span>
<span class="c1">#    canvas.print_figure(&#39;scratch/&#39; + title, dpi=80, transparent=True)</span>
<span class="c1">#</span>
<span class="c1">#    #plt.savefig(&#39;mplflat_&#39; + title + &#39;.pdf&#39;, bbox_inches=&#39;tight&#39;, transparent=True, format=&#39;PDF&#39;)</span>
<span class="c1">#    #plt.savefig(os.environ[&#39;HOME&#39;] + os.sep + &#39;mplflat_&#39; + title + &#39;.pdf&#39;, bbox_inches=&#39;tight&#39;, transparent=T    rue, format=&#39;PDF&#39;)</span>
<span class="c1">#</span>
<span class="c1">#    return htmlcode</span>


<div class="viewcode-block" id="composition_tile"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.mpl.composition_tile">[docs]</a><span class="k">def</span> <span class="nf">composition_tile</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">aa1</span><span class="p">,</span> <span class="n">aa2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes dictionary *db* of label, error pairs and amino acids *aa1*</span>
<span class="sd">    and *aa2* and returns a square array of all errors for that amino</span>
<span class="sd">    acid pair, buffered by zeros.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">re</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
    <span class="n">bfdbpattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;\d\d\d([A-Z][A-Z][A-Z])-\d\d\d([A-Z][A-Z][A-Z])-\d&quot;</span><span class="p">)</span>

    <span class="n">tiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">bfdbname</span> <span class="o">=</span> <span class="n">bfdbpattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">bfdbname</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">aa1</span> <span class="ow">and</span> <span class="n">bfdbname</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">aa2</span><span class="p">)</span> <span class="ow">or</span> \
           <span class="p">(</span><span class="n">bfdbname</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">aa1</span> <span class="ow">and</span> <span class="n">bfdbname</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">aa2</span><span class="p">):</span>
            <span class="n">tiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">tiles</span><span class="p">:</span>
        <span class="c1"># fill in background when no data. only sensible for neutral center colormaps</span>
        <span class="n">tiles</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tiles</span><span class="p">))))</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="n">dim</span> <span class="o">*</span> <span class="n">dim</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">tiles</span><span class="p">)</span>
    <span class="n">tiles</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pad</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tiles</span><span class="p">),</span> <span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span></div>


<div class="viewcode-block" id="iowa"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.mpl.iowa">[docs]</a><span class="k">def</span> <span class="nf">iowa</span><span class="p">(</span><span class="n">mcdat</span><span class="p">,</span> <span class="n">mclbl</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xtitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Saves a plot with (extensionless) name *pltfile* with an Iowa</span>
<span class="sd">    representation of the modelchems errors in *mcdat* for BBI/SSI-style</span>
<span class="sd">    *labels*.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">hashlib</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

    <span class="n">aa</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="s1">&#39;HIE&#39;</span><span class="p">,</span> <span class="s1">&#39;LYS&#39;</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="s1">&#39;GLU&#39;</span><span class="p">,</span> <span class="s1">&#39;SER&#39;</span><span class="p">,</span> <span class="s1">&#39;THR&#39;</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">,</span> <span class="s1">&#39;GLN&#39;</span><span class="p">,</span> <span class="s1">&#39;CYS&#39;</span><span class="p">,</span> <span class="s1">&#39;MET&#39;</span><span class="p">,</span> <span class="s1">&#39;GLY&#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;VAL&#39;</span><span class="p">,</span> <span class="s1">&#39;ILE&#39;</span><span class="p">,</span> <span class="s1">&#39;LEU&#39;</span><span class="p">,</span> <span class="s1">&#39;PRO&#39;</span><span class="p">,</span> <span class="s1">&#39;PHE&#39;</span><span class="p">,</span> <span class="s1">&#39;TYR&#39;</span><span class="p">,</span> <span class="s1">&#39;TRP&#39;</span><span class="p">]</span>
    <span class="c1">#aa = [&#39;ILE&#39;, &#39;LEU&#39;, &#39;ASP&#39;, &#39;GLU&#39;, &#39;PHE&#39;]</span>
    <span class="n">err</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mclbl</span><span class="p">,</span> <span class="n">mcdat</span><span class="p">))</span>

    <span class="c1"># handle for frame, overall axis</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="c1">#axt.set_xticks([])  # for quick nolabel, whiteback</span>
    <span class="c1">#axt.set_yticks([])  # for quick nolabel, whiteback</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aa</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aa</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>  <span class="c1"># comment for quick nolabel, whiteback</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">aa</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>  <span class="c1"># comment for quick nolabel, whiteback</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">aa</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>  <span class="c1"># comment for quick nolabel, whiteback</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1">#axt.set_title(&#39;%s&#39; % (title), fontsize=16, verticalalignment=&#39;bottom&#39;)</span>
    <span class="c1">#axt.text(10.0, -1.5, title, horizontalalignment=&#39;center&#39;, fontsize=16)</span>

    <span class="c1"># nill spacing between 20x20 heatmaps</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

    <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">aa1</span> <span class="ow">in</span> <span class="n">aa</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">aa2</span> <span class="ow">in</span> <span class="n">aa</span><span class="p">:</span>
            <span class="n">cb</span> <span class="o">=</span> <span class="n">composition_tile</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">aa1</span><span class="p">,</span> <span class="n">aa2</span><span class="p">)</span>

            <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">aa</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">aa</span><span class="p">),</span> <span class="n">index</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="n">heatmap</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">PRGn</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1">#plt.title(title)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">4.8</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">8.75</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">11.6</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">4.8</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">8.75</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">11.6</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

    <span class="c1"># save and show</span>
    <span class="n">pltuid</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">xlimit</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">pltfile</span> <span class="o">=</span> <span class="n">expand_saveas</span><span class="p">(</span><span class="n">saveas</span><span class="p">,</span> <span class="n">pltuid</span><span class="p">,</span> <span class="n">def_prefix</span><span class="o">=</span><span class="s1">&#39;iowa_&#39;</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">)</span>
    <span class="n">files_saved</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">graphicsformat</span><span class="p">:</span>
        <span class="n">savefile</span> <span class="o">=</span> <span class="n">pltfile</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefile</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">ext</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="c1">#plt.savefig(savefile, transparent=False, format=ext, bbox_inches=&#39;tight&#39;)  # for quick nolabel, whiteback</span>
        <span class="n">files_saved</span><span class="p">[</span><span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">savefile</span>
    <span class="k">if</span> <span class="n">view</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">files_saved</span></div>


<div class="viewcode-block" id="liliowa"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.mpl.liliowa">[docs]</a><span class="k">def</span> <span class="nf">liliowa</span><span class="p">(</span><span class="n">mcdat</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Saves a plot with a heatmap representation of *mcdat*.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">hashlib</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

    <span class="c1"># handle for frame, overall axis</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">axt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># remove figure outline</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">axt</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

    <span class="n">tiles</span> <span class="o">=</span> <span class="n">mcdat</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tiles</span><span class="p">))))</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="n">dim</span> <span class="o">*</span> <span class="n">dim</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">tiles</span><span class="p">)</span>
    <span class="n">tiles</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pad</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tiles</span><span class="p">),</span> <span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span>

    <span class="n">heatmap</span> <span class="o">=</span> <span class="n">axt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">PRGn</span><span class="p">)</span>

    <span class="c1"># save and show</span>
    <span class="n">pltuid</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">xlimit</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">pltfile</span> <span class="o">=</span> <span class="n">expand_saveas</span><span class="p">(</span><span class="n">saveas</span><span class="p">,</span> <span class="n">pltuid</span><span class="p">,</span> <span class="n">def_prefix</span><span class="o">=</span><span class="s1">&#39;liliowa_&#39;</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">)</span>
    <span class="n">files_saved</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">graphicsformat</span><span class="p">:</span>
        <span class="n">savefile</span> <span class="o">=</span> <span class="n">pltfile</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefile</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">ext</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span>
                   <span class="n">frameon</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">files_saved</span><span class="p">[</span><span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">savefile</span>
    <span class="k">if</span> <span class="n">view</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">files_saved</span></div>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">merge_dats</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;show&#39;</span><span class="p">:</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span><span class="s1">&#39;HSG&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="mf">0.3508</span><span class="p">,</span> <span class="mf">0.1234</span><span class="p">,</span> <span class="mf">0.0364</span><span class="p">,</span> <span class="mf">0.0731</span><span class="p">,</span> <span class="mf">0.0388</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;show&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span><span class="s1">&#39;HSG&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="mf">0.2036</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0736</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1650</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1380</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1806</span><span class="p">]},</span>
    <span class="c1">#{&#39;show&#39;:&#39;&#39;, &#39;db&#39;:&#39;S22&#39;, &#39;sys&#39;:&#39;14&#39;, &#39;data&#39;:[np.nan, -3.2144, np.nan, np.nan, np.nan]},</span>
    <span class="p">{</span><span class="s1">&#39;show&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span><span class="s1">&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span><span class="s1">&#39;14&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="bp">None</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.2144</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;show&#39;</span><span class="p">:</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span><span class="s1">&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span><span class="s1">&#39;15&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="o">-</span><span class="mf">1.5090</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5263</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.9452</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8633</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.1059</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;show&#39;</span><span class="p">:</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span><span class="s1">&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span><span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="mf">0.3046</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2632</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5070</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4925</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6359</span><span class="p">]}]</span>

    <span class="n">threads</span><span class="p">(</span><span class="n">merge_dats</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="s1">&#39;tq&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;sapt&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;MP2-CPa[]z&#39;</span><span class="p">,</span> <span class="n">mae</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">mape</span><span class="o">=</span><span class="p">[</span><span class="mf">20.1</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">])</span>

    <span class="n">more_dats</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;mc&#39;</span><span class="p">:</span><span class="s1">&#39;MP2-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;mc&#39;</span><span class="p">:</span><span class="s1">&#39;MP2-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]},</span>
    <span class="bp">None</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;mc&#39;</span><span class="p">:</span><span class="s1">&#39;MP2-CP-adzagain&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">]}]</span>

    <span class="n">bars</span><span class="p">(</span><span class="n">more_dats</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;asdf&#39;</span><span class="p">)</span>

    <span class="n">single_dats</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;dbse&#39;</span><span class="p">:</span><span class="s1">&#39;HSG&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="mf">0.3508</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;dbse&#39;</span><span class="p">:</span><span class="s1">&#39;HSG&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="mf">0.2036</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;dbse&#39;</span><span class="p">:</span><span class="s1">&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span><span class="s1">&#39;14&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="bp">None</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;dbse&#39;</span><span class="p">:</span><span class="s1">&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span><span class="s1">&#39;15&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="o">-</span><span class="mf">1.5090</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;dbse&#39;</span><span class="p">:</span><span class="s1">&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span><span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:[</span><span class="mf">0.3046</span><span class="p">]}]</span>

    <span class="c1">#flat(single_dats, color=&#39;sapt&#39;, title=&#39;fg_MP2_adz&#39;, mae=0.25, mape=20.1)</span>

    <span class="n">flat</span><span class="p">([{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.6933450559423702</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.45730000000000004</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7627027688599753</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6231999999999998</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7579958735528617</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.7624999999999993</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7560883254421639</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.108600000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7515161912065955</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.2304999999999993</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7235223893438876</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.3782000000000014</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7120099024225569</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.9519000000000002</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.13721565059144678</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.13670000000000004</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3087395095814767</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2966</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.25493207637105103</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.020199999999999996</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.24093814608979347</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5949999999999998</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;12&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3304746631959777</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.7422000000000004</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;13&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.4156050644764822</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0011999999999989797</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;14&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.2667207259626991</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.6083999999999996</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;15&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3767053567641695</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5090000000000003</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;16&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.5572641509433963</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.10749999999999993</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;17&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.4788598239641578</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.29669999999999996</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;18&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3799031371351281</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.10209999999999964</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;19&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.5053227185999078</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.16610000000000014</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.2967660584483015</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.37739999999999974</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;21&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.38836460733750316</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.4712000000000005</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.5585849893078809</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.30460000000000065</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD36-1.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.1383351040559965</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.1921</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD34-2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.23086034843049832</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.367</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_T-5.2&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.254318060864096</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.32230000000000025</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_T-5.1&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.26598486566733337</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3428</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_T-5.0&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.28011258347610224</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.36060000000000025</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;PyPy_S2-3.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.14520332101084785</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.9853000000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;PyPy_S2-3.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.1690757103699542</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0932</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;PyPy_S2-3.5&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.25615734567417053</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.4617</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;PyPy_S2-3.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.19566550224566906</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.2103999999999995</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;PyPy_S2-3.6&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.22476748600170826</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.3333</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD32-2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.31605681987208084</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.6637</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_T-4.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.31533827331543723</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.38759999999999994</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_T-4.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.2966146678069063</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3759999999999999</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzH2S-3.6&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.38284814928043304</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1886000000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD32-1.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3128835191478639</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.8703999999999998</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzMe-3.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.24117892478245323</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.034399999999999986</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzMe-3.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.22230903086047088</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.046499999999999986</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzH2S-3.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.36724255203373696</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.21039999999999992</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzMe-3.6&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.284901522674611</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.007099999999999884</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzMe-3.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.2621086166558813</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.01770000000000005</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD32-1.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.314711251903219</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.7353999999999998</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD32-1.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3136181753200793</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.8039999999999998</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzH2S-3.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3542001591399945</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.22230000000000016</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD36-1.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.14128552184232473</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.1517</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-3.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.08862098445220466</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.3414</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzH2S-4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.33637540012259076</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2265999999999999</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD36-1.5&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.13203548045236127</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.3035</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-3.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.0335358832178858</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.2022</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-3.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.021704594689389095</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0747</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;PyPy_T3-5.1&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3207725129126432</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2958000000000003</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;PyPy_T3-5.0&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3254925304351165</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.30710000000000015</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD36-1.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.13577087141986593</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.2333000000000003</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;PyPy_T3-4.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3443704059902452</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.32010000000000005</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;PyPy_T3-4.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3333442013628509</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3158999999999996</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;PyPy_T3-4.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.35854000505665756</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.31530000000000014</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD36-1.6&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.13364651314909243</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.2705000000000002</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzMe-4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.20560117919562013</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.05389999999999984</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;MeMe-3.6&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.16934865900383142</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.18420000000000003</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;MeMe-3.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.1422332591197123</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.14680000000000004</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;MeMe-3.4&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.23032794290360467</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.29279999999999995</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;MeMe-3.5&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.19879551978386897</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.23260000000000003</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;MeMe-3.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.11744404936205816</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.11680000000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD34-1.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.22537382457222138</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5286999999999997</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD34-1.6&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.22434088042760192</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5754000000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD32-2.2&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3189891685300601</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5093999999999999</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-4.1&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.10884135031532088</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.8547000000000002</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.06911476296747143</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.9590000000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD34-1.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.22685419834431494</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.476</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_PD34-1.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.2287079261672095</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.4223999999999997</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzH2S-3.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3439077006047999</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.22739999999999982</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaNNFaNN-4.1&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7512716174974567</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.7188999999999997</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaNNFaNN-4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7531388297328865</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.9555000000000007</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaNNFaNN-4.3&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7478064149182957</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.2514000000000003</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaNNFaNN-4.2&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7493794908838113</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.4758000000000013</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaON-4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7589275618320565</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.0586</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaON-3.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7619465815742713</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.3492999999999995</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaON-3.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7593958895631474</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.4471000000000007</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaON-3.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7605108059280967</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.8793999999999986</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaONFaON-4.1&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7577459277014137</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.8697999999999997</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaON-3.6&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7633298028299997</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.847599999999998</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaNNFaNN-3.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7548200901251662</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.2089</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaONFaON-3.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7582294603551467</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.967699999999999</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaONFaON-3.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7575285282217349</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.578900000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaONFaON-4.2&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7594549221042256</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5579999999999998</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaNN-3.6&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7661655616885379</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.701599999999999</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaNN-3.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7671068376007428</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.156500000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaNN-3.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.766947626251711</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.720700000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaONFaNN-3.9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7569836601896789</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.4281000000000006</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaONFaNN-3.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.758024548462959</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.7561999999999998</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaOO-3.6&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7623422640217077</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.851800000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaOO-3.7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7597430792159379</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.2754999999999974</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaOO-3.4&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7672554950739594</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.193299999999999</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaOO-3.5&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.764908813123865</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.491900000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaONFaNN-4.2&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7549212942233738</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.534699999999999</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaONFaNN-4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7559404310956357</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.1133000000000024</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaONFaNN-4.1&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7551574698775625</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.813900000000002</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaONFaON-4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7572064604483282</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.2113999999999994</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;FaOOFaOO-3.8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7573810956831686</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.7634000000000007</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.2784121805328983</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3508</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.22013842798900166</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.034600000000000186</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.12832496088281312</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.20360000000000023</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.6993695033529733</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.9092000000000002</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7371192790053749</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.656600000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.5367033190796172</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.27970000000000006</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3014220615964802</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.32289999999999974</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.01605867807629261</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.12199999999999994</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.6106300539083558</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3075999999999999</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.6146680031333968</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6436000000000002</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.6139747851721759</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4551999999999996</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;12&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.32122739401126593</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.44260000000000005</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;13&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.24678148099136055</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.11789999999999967</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;14&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.23700950710597016</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.42689999999999995</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;15&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.23103396678138563</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3266</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;16&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.1922070769654413</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0696000000000001</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;17&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.19082151944747366</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.11159999999999992</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;18&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.2886200282444196</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4114</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;19&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.23560171133945224</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1392</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3268270751294533</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5593</span><span class="p">]},</span> <span class="p">{</span><span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;21&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.7324460869158442</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6806000000000001</span><span class="p">]}],</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;sapt&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;MP2-CP-adz&#39;</span><span class="p">,</span> <span class="n">mae</span><span class="o">=</span><span class="mf">1.21356003247</span><span class="p">,</span> <span class="n">mape</span><span class="o">=</span><span class="mf">24.6665886087</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>

    <span class="n">lin_dats</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">lin_labs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;008ILE-012LEU-1&#39;</span><span class="p">,</span> <span class="s1">&#39;012LEU-085ASP-1&#39;</span><span class="p">,</span> <span class="s1">&#39;004GLU-063LEU-2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;011ILE-014PHE-1&#39;</span><span class="p">,</span> <span class="s1">&#39;027GLU-031LEU-1&#39;</span><span class="p">,</span> <span class="s1">&#39;038PHE-041ILE-1&#39;</span><span class="p">,</span> <span class="s1">&#39;199LEU-202GLU-1&#39;</span><span class="p">]</span>
    <span class="n">iowa</span><span class="p">(</span><span class="n">lin_dats</span><span class="p">,</span> <span class="n">lin_labs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ttl&#39;</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">figs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.69</span><span class="p">]</span>
    <span class="n">liliowa</span><span class="p">(</span><span class="n">figs</span><span class="p">,</span> <span class="n">saveas</span><span class="o">=</span><span class="s1">&#39;SSI-default-MP2-CP-aqz&#39;</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">disthist</span><span class="p">(</span><span class="n">lin_dats</span><span class="p">)</span>

    <span class="n">valerrdata</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.14255710779686612</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-3.6&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.027999999999999803</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.231</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.259</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">3.6</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.08862098445220466</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-3.7&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.02300000000000013</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.535</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.558</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">3.7</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.246634626511043</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-3.4&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.04200000000000001</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="mf">0.189</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="mf">0.147</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">3.4</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.19526236766857613</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-3.5&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.03500000000000003</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.689</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.724</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3443039102164425</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-3.2&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.05999999999999961</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="mf">3.522</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="mf">3.462</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">3.2</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.29638827303466814</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-3.3&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.050999999999999934</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="mf">1.535</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="mf">1.484</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">3.3</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.42859228971962615</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-6.0&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0020000000000000018</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.099</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.101</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.30970751839224836</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-5.0&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0040000000000000036</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.542</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.546</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.3750832778147902</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-5.5&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0030000000000000027</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.248</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.251</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">5.5</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.0335358832178858</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-3.8&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.019000000000000128</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.674</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.693</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">3.8</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.021704594689389095</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-3.9&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.016000000000000014</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.701</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.717</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">3.9</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.22096255119953187</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-4.5&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.008000000000000007</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.058</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.066</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">4.5</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.10884135031532088</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-4.1&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01200000000000001</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.565</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.577</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">4.1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.06911476296747143</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.014000000000000012</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.655</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.669</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.14275218373289067</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-4.2&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01100000000000012</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.448</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.459</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">4.2</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.4740372133275638</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-6.5&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0010000000000000009</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.028</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.029</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">6.5</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="mf">0.6672504378283713</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="s1">&#39;BzBz_S-10.0&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;mcdata&#39;</span><span class="p">:</span> <span class="mf">0.018</span><span class="p">,</span> <span class="s1">&#39;bmdata&#39;</span><span class="p">:</span> <span class="mf">0.018</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">}]</span>
    <span class="n">valerr</span><span class="p">({</span><span class="s1">&#39;cat&#39;</span><span class="p">:</span> <span class="n">valerrdata</span><span class="p">},</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;sapt&#39;</span><span class="p">,</span> <span class="n">xtitle</span><span class="o">=</span><span class="s1">&#39;Rang&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;aggh&#39;</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;png&#39;</span><span class="p">])</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../contents.html" title="Table Of Contents"
             >toc</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">Psi4 [1.0.0 6a9a71b]</a> &raquo; </li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, The Psi4 Project.
      Last updated on Tuesday, 05 July 2016 02:54AM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
    <!-- cloud_sptheme 1.3 -->
  </body>
</html>