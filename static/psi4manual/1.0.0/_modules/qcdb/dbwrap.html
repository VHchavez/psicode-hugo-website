

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>qcdb.dbwrap &mdash; Psi4 [1.0.0 6a9a71b] Docs</title>
    
    <link rel="stylesheet" href="../../_static/psi4.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.0 6a9a71b',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../../_static/toggle_sections.js"></script>
    <script type="text/javascript" src="../../_static/toggle_sidebar.js"></script>
    <script type="text/javascript" src="../../_static/toggle_codeprompt.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon-psi4.ico"/>
    <link rel="top" title="Psi4 [1.0.0 6a9a71b] Docs" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body role="document">
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../contents.html" title="Table Of Contents"
             accesskey="C">toc</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">Psi4 [1.0.0 6a9a71b]</a> &raquo; </li>

          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for qcdb.dbwrap</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cPickle</span> <span class="kn">as</span> <span class="nn">pickle</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="c1"># from collections import defaultdict</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">oldpymodules</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">.exceptions</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.molecule</span> <span class="kn">import</span> <span class="n">Molecule</span>
<span class="kn">from</span> <span class="nn">.modelchems</span> <span class="kn">import</span> <span class="n">Method</span><span class="p">,</span> <span class="n">BasisSet</span><span class="p">,</span> <span class="n">Error</span><span class="p">,</span> <span class="n">methods</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">pubs</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">psiutil</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">textables</span>


<div class="viewcode-block" id="initialize_errors"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.initialize_errors">[docs]</a><span class="k">def</span> <span class="nf">initialize_errors</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Form OrderedDict of all possible statistical measures set to None&quot;&quot;&quot;</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;pe&#39;</span><span class="p">,</span> <span class="s1">&#39;pbe&#39;</span><span class="p">,</span> <span class="s1">&#39;pce&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pex&#39;</span><span class="p">,</span> <span class="s1">&#39;nex&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;ma&#39;</span><span class="p">,</span> <span class="s1">&#39;rms&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]:</span>
            <span class="n">error</span><span class="p">[</span><span class="n">m</span> <span class="o">+</span> <span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">error</span></div>


<div class="viewcode-block" id="initialize_errors_elaborate"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.initialize_errors_elaborate">[docs]</a><span class="k">def</span> <span class="nf">initialize_errors_elaborate</span><span class="p">(</span><span class="n">e</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pe</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pbe</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pce</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">extrema</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;maxe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">extrema</span><span class="p">)</span> <span class="k">else</span> <span class="n">e</span>  <span class="c1"># LD_XA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mine&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">extrema</span><span class="p">)</span> <span class="k">else</span> <span class="n">e</span>  <span class="c1"># LD_XI</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;me&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># LD_MS</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># LD_MA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># LD_RA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;stde&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;maxpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">pe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">extrema</span><span class="p">)</span> <span class="k">else</span> <span class="n">pe</span>  <span class="c1"># FD_XA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;minpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">pe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">extrema</span><span class="p">)</span> <span class="k">else</span> <span class="n">pe</span>  <span class="c1"># FD_XI</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># FD_MS</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># FD_MA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;rmspe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># FD_RA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;stdpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;maxpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">pbe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">extrema</span><span class="p">)</span> <span class="k">else</span> <span class="n">pbe</span>  <span class="c1"># BD_XA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;minpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">pbe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">extrema</span><span class="p">)</span> <span class="k">else</span> <span class="n">pbe</span>  <span class="c1"># BD_XI</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pbe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># BD_MS</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mapbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pbe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># BD_MA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;rmspbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pbe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># BD_RA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;stdpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pbe</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;maxpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">pce</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">extrema</span><span class="p">)</span> <span class="k">else</span> <span class="n">pce</span>  <span class="c1"># BD_XA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;minpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">pce</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">extrema</span><span class="p">)</span> <span class="k">else</span> <span class="n">pce</span>  <span class="c1"># BD_XI</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pce</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># BD_MS</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mapce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pce</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># BD_MA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;rmspce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pce</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>  <span class="c1"># BD_RA</span>
    <span class="n">error</span><span class="p">[</span><span class="s1">&#39;stdpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">pce</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="mf">0.0</span>
    <span class="k">return</span> <span class="n">error</span></div>


<div class="viewcode-block" id="average_errors"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.average_errors">[docs]</a><span class="k">def</span> <span class="nf">average_errors</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Each item in *args* should be an error dictionary. Performs</span>
<span class="sd">    average-like operation over all items, which should be error</span>
<span class="sd">    dictionaries, in *args*. Defined for ME, MAE, STDE, and their</span>
<span class="sd">    relative-error variants. None returned for undefined statistics or</span>
<span class="sd">    when an item is missing.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Ndb</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
    <span class="n">avgerror</span> <span class="o">=</span> <span class="n">initialize_errors</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;pexe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;pexe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;nexe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;nexe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;maxe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;maxe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;mine&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mine&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;me&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;me&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>  <span class="c1"># TODO: unsure of op validity</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;stde&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;stde&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span><span class="p">)</span>

        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;pexpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;pexpe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;nexpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;nexpe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;maxpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;maxpe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;minpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;minpe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;mpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mpe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;rmspe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;rmspe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>  <span class="c1"># TODO: unsure of op validity</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;stdpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;stdpe&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;stdpe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span><span class="p">)</span>

        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;pexpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;pexpbe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;nexpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;nexpbe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;maxpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;maxpbe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;minpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;minpbe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;mpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mpbe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;mapbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mapbe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;rmspbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;rmspbe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>  <span class="c1"># TODO: unsure of op validity</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;stdpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;stdpbe&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;stdpbe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span><span class="p">)</span>

        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;pexpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;pexpce&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;nexpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;nexpce&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;maxpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;maxpce&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;minpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;minpce&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;mpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mpce&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;mapce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mapce&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;rmspce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;rmspce&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span>  <span class="c1"># TODO: unsure of op validity</span>
        <span class="n">avgerror</span><span class="p">[</span><span class="s1">&#39;stdpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;stdpce&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;stdpce&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span> <span class="o">/</span> <span class="n">Ndb</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">avgerror</span></div>


<div class="viewcode-block" id="format_errors"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.format_errors">[docs]</a><span class="k">def</span> <span class="nf">format_errors</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;From error dictionary *err*, returns a LaTeX-formatted string,</span>
<span class="sd">    after handling None entries.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">onedecimal</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;{0:8.1f}&quot;&quot;&quot;</span>
    <span class="n">twodecimal</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;{0:8.2f}&quot;&quot;&quot;</span>
    <span class="n">threedecimal</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;{0:12.3f}&quot;&quot;&quot;</span>
    <span class="n">fourdecimal</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;{0:12.4f}&quot;&quot;&quot;</span>
    <span class="n">shortblank</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;{0:8s}&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">longblank</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;{0:12s}&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">me</span> <span class="o">=</span> <span class="s1">&#39; ----&#39;</span> <span class="k">if</span> <span class="n">err</span><span class="p">[</span><span class="s1">&#39;me&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="si">%+.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="s1">&#39;me&#39;</span><span class="p">])</span>
        <span class="n">stde</span> <span class="o">=</span> <span class="s1">&#39;----&#39;</span> <span class="k">if</span> <span class="n">err</span><span class="p">[</span><span class="s1">&#39;stde&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="s1">&#39;stde&#39;</span><span class="p">])</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="s1">&#39;  ----&#39;</span> <span class="k">if</span> <span class="n">err</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="si">%6.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">])</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="s1">&#39;  ----  &#39;</span> <span class="k">if</span> <span class="n">err</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="si">%6.1f</span><span class="s1">\</span><span class="si">%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">])</span>
        <span class="n">mapbe</span> <span class="o">=</span> <span class="s1">&#39;  ----  &#39;</span> <span class="k">if</span> <span class="n">err</span><span class="p">[</span><span class="s1">&#39;mapbe&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="si">%6.1f</span><span class="s1">\</span><span class="si">%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="s1">&#39;mapbe&#39;</span><span class="p">])</span>
        <span class="n">mapce</span> <span class="o">=</span> <span class="s1">&#39;  ----  &#39;</span> <span class="k">if</span> <span class="n">err</span><span class="p">[</span><span class="s1">&#39;mapce&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="si">%6.1f</span><span class="s1">\</span><span class="si">%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="s1">&#39;mapce&#39;</span><span class="p">])</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;$\{</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">\}$ </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> \
               <span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">stde</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="n">mapce</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">text</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">sdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pexe&#39;</span><span class="p">,</span> <span class="s1">&#39;nexe&#39;</span><span class="p">,</span> <span class="s1">&#39;maxe&#39;</span><span class="p">,</span> <span class="s1">&#39;mine&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">,</span> <span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="s1">&#39;stde&#39;</span><span class="p">]:</span>
            <span class="n">sdict</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;        ----&#39;</span> <span class="k">if</span> <span class="n">err</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">fourdecimal</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="n">lbl</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pexpe&#39;</span><span class="p">,</span> <span class="s1">&#39;nexpe&#39;</span><span class="p">,</span> <span class="s1">&#39;maxpe&#39;</span><span class="p">,</span> <span class="s1">&#39;minpe&#39;</span><span class="p">,</span> <span class="s1">&#39;mpe&#39;</span><span class="p">,</span> <span class="s1">&#39;mape&#39;</span><span class="p">,</span> <span class="s1">&#39;rmspe&#39;</span><span class="p">,</span> <span class="s1">&#39;stdpe&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;pexpbe&#39;</span><span class="p">,</span> <span class="s1">&#39;nexpbe&#39;</span><span class="p">,</span> <span class="s1">&#39;maxpbe&#39;</span><span class="p">,</span> <span class="s1">&#39;minpbe&#39;</span><span class="p">,</span> <span class="s1">&#39;mpbe&#39;</span><span class="p">,</span> <span class="s1">&#39;mapbe&#39;</span><span class="p">,</span> <span class="s1">&#39;rmspbe&#39;</span><span class="p">,</span> <span class="s1">&#39;stdpbe&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;pexpce&#39;</span><span class="p">,</span> <span class="s1">&#39;nexpce&#39;</span><span class="p">,</span> <span class="s1">&#39;maxpce&#39;</span><span class="p">,</span> <span class="s1">&#39;minpce&#39;</span><span class="p">,</span> <span class="s1">&#39;mpce&#39;</span><span class="p">,</span> <span class="s1">&#39;mapce&#39;</span><span class="p">,</span> <span class="s1">&#39;rmspce&#39;</span><span class="p">,</span> <span class="s1">&#39;stdpce&#39;</span><span class="p">]:</span>
            <span class="n">sdict</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;        ----&#39;</span> <span class="k">if</span> <span class="n">err</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">threedecimal</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="n">lbl</span><span class="p">])</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;nex: {nexe}{nexpe}{nexpbe}{nexpce}</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> \
               <span class="sd">&quot;&quot;&quot;pex: {pexe}{pexpe}{pexpbe}{pexpce}\n&quot;&quot;&quot;</span> \
               <span class="sd">&quot;&quot;&quot;min: {mine}{minpe}{minpbe}{minpce}\n&quot;&quot;&quot;</span> \
               <span class="sd">&quot;&quot;&quot;max: {maxe}{maxpe}{maxpbe}{maxpce}\n&quot;&quot;&quot;</span> \
               <span class="sd">&quot;&quot;&quot;m:   {me}{mpe}{mpbe}{mpce}\n&quot;&quot;&quot;</span> \
               <span class="sd">&quot;&quot;&quot;ma:  {mae}{mape}{mapbe}{mapce}\n&quot;&quot;&quot;</span> \
               <span class="sd">&quot;&quot;&quot;rms: {rmse}{rmspe}{rmspbe}{rmspce}\n&quot;&quot;&quot;</span> \
               <span class="sd">&quot;&quot;&quot;std: {stde}{stdpe}{stdpbe}{stdpce}\n&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">sdict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">text</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">sdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1"># shortblanks changed from empty strings Aug 2015</span>
        <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pexe&#39;</span><span class="p">,</span> <span class="s1">&#39;nexe&#39;</span><span class="p">,</span> <span class="s1">&#39;maxe&#39;</span><span class="p">,</span> <span class="s1">&#39;mine&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">,</span> <span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="s1">&#39;stde&#39;</span><span class="p">]:</span>
            <span class="n">sdict</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="o">=</span> <span class="n">shortblank</span> <span class="k">if</span> <span class="n">err</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">twodecimal</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="n">lbl</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pexpe&#39;</span><span class="p">,</span> <span class="s1">&#39;nexpe&#39;</span><span class="p">,</span> <span class="s1">&#39;maxpe&#39;</span><span class="p">,</span> <span class="s1">&#39;minpe&#39;</span><span class="p">,</span> <span class="s1">&#39;mpe&#39;</span><span class="p">,</span> <span class="s1">&#39;mape&#39;</span><span class="p">,</span> <span class="s1">&#39;rmspe&#39;</span><span class="p">,</span> <span class="s1">&#39;stdpe&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;pexpbe&#39;</span><span class="p">,</span> <span class="s1">&#39;nexpbe&#39;</span><span class="p">,</span> <span class="s1">&#39;maxpbe&#39;</span><span class="p">,</span> <span class="s1">&#39;minpbe&#39;</span><span class="p">,</span> <span class="s1">&#39;mpbe&#39;</span><span class="p">,</span> <span class="s1">&#39;mapbe&#39;</span><span class="p">,</span> <span class="s1">&#39;rmspbe&#39;</span><span class="p">,</span> <span class="s1">&#39;stdpbe&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;pexpce&#39;</span><span class="p">,</span> <span class="s1">&#39;nexpce&#39;</span><span class="p">,</span> <span class="s1">&#39;maxpce&#39;</span><span class="p">,</span> <span class="s1">&#39;minpce&#39;</span><span class="p">,</span> <span class="s1">&#39;mpce&#39;</span><span class="p">,</span> <span class="s1">&#39;mapce&#39;</span><span class="p">,</span> <span class="s1">&#39;rmspce&#39;</span><span class="p">,</span> <span class="s1">&#39;stdpce&#39;</span><span class="p">]:</span>
            <span class="n">sdict</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="o">=</span> <span class="n">shortblank</span> <span class="k">if</span> <span class="n">err</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">onedecimal</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="n">lbl</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">sdict</span></div>


<div class="viewcode-block" id="string_contrast"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.string_contrast">[docs]</a><span class="k">def</span> <span class="nf">string_contrast</span><span class="p">(</span><span class="n">ss</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;From an array of strings, *ss*, returns maximum common prefix</span>
<span class="sd">    string, maximum common suffix string, and array of middles.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;q&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ss</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">short</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ib</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">short</span><span class="p">)):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">mc</span><span class="p">[</span><span class="n">ib</span><span class="p">]</span> <span class="o">==</span> <span class="n">short</span><span class="p">[</span><span class="n">ib</span><span class="p">]</span> <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]):</span>
            <span class="n">preidx</span> <span class="o">=</span> <span class="n">ib</span>
            <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">preidx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">ib</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">short</span><span class="p">)):</span>
        <span class="n">ie</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">mc</span><span class="p">[</span><span class="n">ie</span><span class="p">]</span> <span class="o">==</span> <span class="n">short</span><span class="p">[</span><span class="n">ie</span><span class="p">]</span> <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]):</span>
            <span class="n">sufidx</span> <span class="o">=</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sufidx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">short</span><span class="p">))</span>

    <span class="n">miditer</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">([</span><span class="n">mc</span><span class="p">[</span><span class="n">preidx</span><span class="p">:</span><span class="n">sufidx</span><span class="p">]</span> <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">s</span><span class="p">])</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">short</span><span class="p">[:</span><span class="n">preidx</span><span class="p">]</span>
    <span class="n">suffix</span> <span class="o">=</span> <span class="n">short</span><span class="p">[</span><span class="n">sufidx</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">middle</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">mc</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="nb">next</span><span class="p">(</span><span class="n">miditer</span><span class="p">)</span> <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">ss</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">middle</span></div>


<div class="viewcode-block" id="oxcom"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.oxcom">[docs]</a><span class="k">def</span> <span class="nf">oxcom</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns gramatical comma separated string of *lst*.&quot;&quot;&quot;</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">lst</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39; and &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;, and &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">lst</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span></div>


<div class="viewcode-block" id="cure_weight"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.cure_weight">[docs]</a><span class="k">def</span> <span class="nf">cure_weight</span><span class="p">(</span><span class="n">refrxn</span><span class="p">,</span> <span class="n">refeq</span><span class="p">,</span> <span class="n">rrat</span><span class="p">,</span> <span class="n">xi</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param refeq: value of benchmark for equilibrium Reaction</span>
<span class="sd">    :param rrat: ratio of intermonomer separation for Reaction to equilibrium Reaction</span>
<span class="sd">    :param xi: parameter</span>
<span class="sd">    :return: weight for CURE</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">xi</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">refeq</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">rrat</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">refrxn</span><span class="p">),</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">weight</span></div>


<div class="viewcode-block" id="balanced_error"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.balanced_error">[docs]</a><span class="k">def</span> <span class="nf">balanced_error</span><span class="p">(</span><span class="n">refrxn</span><span class="p">,</span> <span class="n">refeq</span><span class="p">,</span> <span class="n">rrat</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">10.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param refrxn:</span>
<span class="sd">    :param refeq:</span>
<span class="sd">    :param rrat:</span>
<span class="sd">    :param m: minimum permitted weight for a point</span>
<span class="sd">    :param p: multiples of abs(refeq) above refeq to which zero-line in head is displaced</span>
<span class="sd">    :return:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">one</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">one</span> <span class="k">if</span> <span class="n">rrat</span> <span class="o">&gt;=</span> <span class="n">one</span> <span class="k">else</span> <span class="n">p</span>
    <span class="n">qm1perat</span> <span class="o">=</span> <span class="n">q</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">refrxn</span> <span class="o">/</span> <span class="n">refeq</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">qm1perat</span> <span class="o">/</span> <span class="n">q</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">q</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">qm1perat</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mask</span><span class="p">,</span> <span class="n">weight</span></div>


<div class="viewcode-block" id="fancify_mc_tag"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.fancify_mc_tag">[docs]</a><span class="k">def</span> <span class="nf">fancify_mc_tag</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;From the usual MTD-opt1_opt2-bas model chemistry identifier, return</span>
<span class="sd">    string based on fullname, if *latex* is False or latex if *latex* is True.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mtd</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">bas</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">mc</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">latex</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;</span><span class="si">%20s</span><span class="s2"> / </span><span class="si">%-20s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">methods</span><span class="p">[</span><span class="n">mtd</span><span class="p">]</span><span class="o">.</span><span class="n">latex</span><span class="p">,</span> <span class="n">bases</span><span class="p">[</span><span class="n">bas</span><span class="p">]</span><span class="o">.</span><span class="n">latex</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;</span><span class="si">%20s</span><span class="s2"> / </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">methods</span><span class="p">[</span><span class="n">mtd</span><span class="p">]</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span> <span class="n">bases</span><span class="p">[</span><span class="n">bas</span><span class="p">]</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span></div>


<div class="viewcode-block" id="ReactionDatum"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.ReactionDatum">[docs]</a><span class="k">class</span> <span class="nc">ReactionDatum</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Piece of quantum chemical information that describes a qcdb.Reaction object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kcal/mol&#39;</span><span class="p">,</span> <span class="n">citation</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># geometry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbrxn</span> <span class="o">=</span> <span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>
        <span class="c1"># qcdb.Method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="c1"># mode, e.g., unCP, CP, RLX, etc.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="c1"># qcdb.BasisSet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">basis</span>
        <span class="c1"># numerical value for reaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="c1"># energy unit attached to value, defaults to kcal/mol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
        <span class="c1"># publication citation of value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">citation</span> <span class="o">=</span> <span class="n">citation</span>
        <span class="c1"># digital object identifier for publication (maybe this should be doi of datum, not of pub?)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="o">=</span> <span class="n">doi</span>
        <span class="c1"># addl comments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="ReactionDatum.library_modelchem"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.ReactionDatum.library_modelchem">[docs]</a>    <span class="k">def</span> <span class="nf">library_modelchem</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kcal/mol&#39;</span><span class="p">,</span> <span class="n">citation</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">comment</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor when method and basis are strings corresponding to</span>
<span class="sd">        qcdb.Method and qcdb.BasisSet already defined in methods and bases.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># computational method</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tmp_method</span> <span class="o">=</span> <span class="n">methods</span><span class="p">[</span><span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Invalid ReactionDatum method </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="c1"># computational basis set</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tmp_basis</span> <span class="o">=</span> <span class="n">bases</span><span class="p">[</span><span class="n">basis</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Invalid ReactionDatum basis </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="c1"># publication</span>
        <span class="k">if</span> <span class="n">citation</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">tmp_pub</span> <span class="o">=</span> <span class="n">citation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tmp_pub</span> <span class="o">=</span> <span class="n">pubs</span><span class="p">[</span><span class="n">citation</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Invalid ReactionDatum publication </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">citation</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">tmp_method</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">tmp_basis</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">citation</span><span class="o">=</span><span class="n">tmp_pub</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="n">doi</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  ==&gt; ReactionDatum &lt;==</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Database reaction:    </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbrxn</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Method:               </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">fullname</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Mode:                 </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Basis:                </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">fullname</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Value:                </span><span class="si">%f</span><span class="s2"> [</span><span class="si">%s</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Citation:             </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">citation</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">citation</span><span class="o">.</span><span class="n">doi</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  DOI:                  </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doi</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Comment:              </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">text</span></div>


<div class="viewcode-block" id="Subset"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Subset">[docs]</a><span class="k">class</span> <span class="nc">Subset</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Affiliated qcdb.Reaction-s</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">hrxn</span><span class="p">,</span> <span class="n">tagl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># identifier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="c1"># array of reactions names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span> <span class="o">=</span> <span class="n">hrxn</span>
        <span class="c1"># description line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tagl</span> <span class="o">=</span> <span class="n">tagl</span>
        <span class="c1"># mathematical relationships of reactions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  ==&gt; </span><span class="si">%s</span><span class="s2"> Subset &lt;==</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Tagline:              </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagl</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  </span><span class="si">%20s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Reactions&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  </span><span class="si">%8s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="p">)):</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  </span><span class="si">%20s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">ix</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  </span><span class="si">%8.3f</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">text</span></div>


<div class="viewcode-block" id="Reagent"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Reagent">[docs]</a><span class="k">class</span> <span class="nc">Reagent</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Chemical entity only slightly dresed up from qcdb.Molecule.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">tagl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># full name, e.g., &#39;S22-2-dimer&#39; or &#39;NBC1-BzMe-8.0-monoA-CP&#39; or &#39;HTBH-HCl-reagent&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="c1"># qcdb.Molecule</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRE</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Reagent must be instantiated with qcdb.Molecule object.&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">create_psi4_string_from_molecule</span><span class="p">()</span>
        <span class="c1"># description line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tagl</span> <span class="o">=</span> <span class="n">tagl</span>
        <span class="c1"># # addl comments</span>
        <span class="c1"># self.comment = comment</span>
        <span class="c1"># # fragmentation</span>
        <span class="c1"># self.fragments = mol.fragments</span>
        <span class="c1"># # frag activation</span>
        <span class="c1"># self.frtype = mol.fragment_types</span>
        <span class="c1"># # frag charge</span>
        <span class="c1"># self.frchg = mol.fragment_charges</span>
        <span class="c1"># # frag multiplicity</span>
        <span class="c1"># self.frmult = mol.fragment_multiplicities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">molecular_charge</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  ==&gt; </span><span class="si">%s</span><span class="s2"> Reagent &lt;==</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Tagline:              </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagl</span><span class="p">)</span>
        <span class="c1"># text += &quot;&quot;&quot;  Comment:              %s\n&quot;&quot;&quot; % (self.comment)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  NRE:                  </span><span class="si">%f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRE</span><span class="p">)</span>
        <span class="c1"># text += &quot;&quot;&quot;  Charge:               %+d\n&quot;&quot;&quot;</span>
        <span class="c1"># text += &quot;&quot;&quot;  Fragments:            %d\n&quot;&quot;&quot; % (len(self.fragments))</span>
        <span class="c1"># text += &quot;&quot;&quot;    FrgNo  Actv  Chg  Mult  AtomRange\n&quot;&quot;&quot;</span>
        <span class="c1"># for fr in range(len(self.fragments)):</span>
        <span class="c1">#    text += &quot;&quot;&quot;    %-4d   %1s     %+2d  %2d     %s\n&quot;&quot;&quot; % (fr + 1,</span>
        <span class="c1">#        &#39;*&#39; if self.frtype[fr] == &#39;Real&#39; else &#39;&#39;,</span>
        <span class="c1">#        self.frchg[fr], self.frmult[fr], self.fragments[fr])</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Molecule:             </span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">text</span></div>


<div class="viewcode-block" id="Reaction"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Reaction">[docs]</a><span class="k">class</span> <span class="nc">Reaction</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dbse</span><span class="p">,</span> <span class="n">indx</span><span class="p">,</span> <span class="n">tagl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># name, e.g., &#39;2&#39; or &#39;BzMe-8.0&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="c1"># database reaction name, e.g., &#39;S22-2&#39; or &#39;NBC1-BzMe-8.0&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbrxn</span> <span class="o">=</span> <span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="c1"># numerical index of reaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indx</span> <span class="o">=</span> <span class="n">indx</span>
        <span class="c1"># description line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tagl</span> <span class="o">=</span> <span class="n">tagl</span>
        <span class="c1"># latex description</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">latex</span> <span class="o">=</span> <span class="n">latex</span>
        <span class="c1"># addl comments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="c1"># reaction matrices, specifying reagent contributions per reaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rxnm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># qcdb.ReactionDatum objects of quantum chemical data pertaining to reaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># benchmark qcdb.ReactionDatum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># color for plotting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  ==&gt; </span><span class="si">%s</span><span class="s2"> Reaction &lt;==</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Database reaction:    </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbrxn</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Index:                </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indx</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  LaTeX representation: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Tagline:              </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagl</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Comment:              </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Benchmark:            </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Benchmark:            </span><span class="si">%f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Color:                </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">))</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Reaction matrix:</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">mode</span><span class="p">,</span> <span class="n">rxnm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rxnm</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;      </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mode</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">rgt</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="n">rxnm</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;       </span><span class="si">%3d</span><span class="s2">  </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">rgt</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Data:</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">datum</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()):</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;      </span><span class="si">%8.2f</span><span class="s2">  </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">datum</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">text</span>

<div class="viewcode-block" id="Reaction.compute_errors"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Reaction.compute_errors">[docs]</a>    <span class="k">def</span> <span class="nf">compute_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">mcset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For all data or modelchem subset *mcset*, computes raw reaction</span>
<span class="sd">        errors between *modelchem* and *benchmark* model chemistries.</span>
<span class="sd">        Returns error if model chemistries are missing for any reaction in</span>
<span class="sd">        subset unless *failoninc* set to False, whereupon returns partial.</span>
<span class="sd">        Returns dictionary of reaction labels and error forms.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mcset</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">lsslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">mcset</span><span class="p">):</span>
            <span class="c1"># mcset is function that will generate subset of HRXN from sset(self)</span>
            <span class="n">lsslist</span> <span class="o">=</span> <span class="p">[</span><span class="n">mc</span> <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">mcset</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span>  <span class="c1"># untested</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># mcset is array containing modelchemistries</span>
            <span class="n">lsslist</span> <span class="o">=</span> <span class="p">[</span><span class="n">mc</span> <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">mcset</span><span class="p">]</span>
        <span class="c1"># assemble dict of qcdb.Reaction objects from array of reaction names</span>
        <span class="n">lsset</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">lsslist</span><span class="p">:</span>
            <span class="n">lsset</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span>

        <span class="n">lbench</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span> <span class="k">if</span> <span class="n">benchmark</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span> <span class="k">else</span> <span class="n">benchmark</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mcGreater</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">lbench</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Reaction </span><span class="si">%s</span><span class="s2"> missing benchmark datum </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>

        <span class="n">err</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">datum</span> <span class="ow">in</span> <span class="n">lsset</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mcLesser</span> <span class="o">=</span> <span class="n">datum</span><span class="o">.</span><span class="n">value</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">failoninc</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Reaction </span><span class="si">%s</span><span class="s2"> missing datum </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>

            <span class="n">err</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mcLesser</span> <span class="o">-</span> <span class="n">mcGreater</span><span class="p">,</span>
                          <span class="p">(</span><span class="n">mcLesser</span> <span class="o">-</span> <span class="n">mcGreater</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mcGreater</span><span class="p">),</span>
                          <span class="p">(</span><span class="n">mcLesser</span> <span class="o">-</span> <span class="n">mcGreater</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mcGreater</span><span class="p">)]</span>  <span class="c1"># TODO define BER</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;p = </span><span class="si">%6.2f</span><span class="s2">, pe = </span><span class="si">%6.1f%%</span><span class="s2">, bpe = </span><span class="si">%6.1f%%</span><span class="s2"> modelchem </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span>
                      <span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">err</span></div>

<div class="viewcode-block" id="Reaction.plot"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Reaction.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">mcset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
             <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;sapt&#39;</span><span class="p">,</span>
             <span class="n">xlimit</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">labeled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
             <span class="n">mousetext</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mouselink</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mouseimag</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mousetitle</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mousediv</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Computes individual errors over model chemistries in *mcset* (which</span>
<span class="sd">        may be default or an array or a function generating an array) versus</span>
<span class="sd">        *benchmark*. Thread *color* can be &#39;rgb&#39; for old coloring, a color</span>
<span class="sd">        name or &#39;sapt&#39; for spectrum coloring.</span>

<span class="sd">        *saveas* conveys directory (&#39;/&#39;) and/or filename for saving the</span>
<span class="sd">        resulting plot. File extension is not accessible, but *graphicsformat*</span>
<span class="sd">        array requests among &#39;png&#39;, &#39;pdf&#39;, and &#39;eps&#39; formats. *relpath*</span>
<span class="sd">        forces paths to saved files to be relative to current directory,</span>
<span class="sd">        rather than absolute paths for returned code and file dictionary.</span>

<span class="sd">        Prepares thread diagram instructions and either executes them if</span>
<span class="sd">        matplotlib available (Canopy or Anaconda) or prints them. Returns a</span>
<span class="sd">        dictionary of all saved plot filenames. If any of *mousetext*, *mouselink*,</span>
<span class="sd">        or *mouseimag* is specified, htmlcode will be returned with an image map of</span>
<span class="sd">        slats to any of text, link, or image, respectively.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># compute errors</span>
        <span class="n">dbse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbrxn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">indiv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_errors</span><span class="p">(</span><span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">mcset</span><span class="o">=</span><span class="n">mcset</span><span class="p">,</span>
                                    <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

        <span class="c1"># repackage</span>
        <span class="n">dbdat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">indiv</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dbdat</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="n">dbse</span><span class="p">,</span>
                          <span class="s1">&#39;show&#39;</span><span class="p">:</span> <span class="n">fancify_mc_tag</span><span class="p">(</span><span class="n">mc</span><span class="p">),</span>
                          <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="n">mc</span><span class="p">,</span>
                          <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">,</span>
                          <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">indiv</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="mi">0</span><span class="p">]]})</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># [errors[ix][self.dbse][&#39;mae&#39;] for ix in index]</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># [100 * errors[ix][self.dbse][&#39;mape&#39;] for ix in index]</span>
        <span class="c1"># form unique filename</span>
        <span class="c1"># ixpre, ixsuf, ixmid = string_contrast(index)</span>
        <span class="c1"># title = self.dbse + &#39; &#39; + ixpre + &#39;[]&#39; + ixsuf</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbrxn</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="c1"># generate matplotlib instructions and call or print</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mpl</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="c1"># if not running from Canopy, print line to execute from Canopy</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;filedict, htmlcode = mpl.threads(</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    color=&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="se">\n</span><span class="s2">    title=&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="se">\n</span><span class="s2">    labels=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    mae=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    mape=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    xlimit=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    labeled=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    saveas=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    mousetext=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    mouselink=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    mouseimag=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    mousetitle=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    mousediv=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    relpath=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    graphicsformat=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span>
                  <span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">xlimit</span><span class="p">),</span>
                   <span class="nb">repr</span><span class="p">(</span><span class="n">labeled</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">saveas</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">mousetext</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">mouselink</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">mouseimag</span><span class="p">),</span>
                   <span class="nb">repr</span><span class="p">(</span><span class="n">mousetitle</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">mousediv</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">relpath</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">graphicsformat</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if running from Canopy, call mpl directly</span>
            <span class="n">filedict</span><span class="p">,</span> <span class="n">htmlcode</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">threads</span><span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">mae</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="o">=</span><span class="n">mape</span><span class="p">,</span>
                                             <span class="n">xlimit</span><span class="o">=</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">labeled</span><span class="o">=</span><span class="n">labeled</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span>
                                             <span class="n">mousetext</span><span class="o">=</span><span class="n">mousetext</span><span class="p">,</span> <span class="n">mouselink</span><span class="o">=</span><span class="n">mouselink</span><span class="p">,</span>
                                             <span class="n">mouseimag</span><span class="o">=</span><span class="n">mouseimag</span><span class="p">,</span> <span class="n">mousetitle</span><span class="o">=</span><span class="n">mousetitle</span><span class="p">,</span> <span class="n">mousediv</span><span class="o">=</span><span class="n">mousediv</span><span class="p">,</span>
                                             <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="n">graphicsformat</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">filedict</span><span class="p">,</span> <span class="n">htmlcode</span></div></div>


<div class="viewcode-block" id="WrappedDatabase"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase">[docs]</a><span class="k">class</span> <span class="nc">WrappedDatabase</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper class for raw Psi4 database modules that does some validation</span>
<span class="sd">    of contents, creates member data and accessors for database structures,</span>
<span class="sd">    defines error computation, and handles database subsets. Not to be used</span>
<span class="sd">    directly-- see qcdb.Database for handling single or multiple</span>
<span class="sd">    qdcb.WrappedDatabase objects and defining nice statistics, plotting, and</span>
<span class="sd">    table functionalities.</span>

<span class="sd">    &gt;&gt;&gt; asdf = qcdb.WrappedDatabase(&#39;Nbc10&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbname</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Instantiate class with case insensitive name *dbname*. Module</span>
<span class="sd">        search path can be prepended with *pythonpath*.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#: internal name of database</span>
        <span class="c1">#:</span>
        <span class="c1">#: &gt;&gt;&gt; print asdf.dbse</span>
        <span class="c1">#: &#39;NBC1&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1">#: description line</span>
        <span class="c1">#:</span>
        <span class="c1">#: &gt;&gt;&gt; print asdf.tagl</span>
        <span class="c1">#: &#39;interaction energies of dissociation curves for non-bonded systems&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tagl</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1">#: OrderedDict of reactions/members</span>
        <span class="c1">#:</span>
        <span class="c1">#: &gt;&gt;&gt; print asdf.hrxn.keys()</span>
        <span class="c1">#: [&#39;BzBz_S-3.2&#39;, &#39;BzBz_S-3.3&#39;, ...  &#39;BzBz_PD36-2.8&#39;, &#39;BzBz_PD36-3.0&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1">#: dict of reagents/geometries</span>
        <span class="c1">#:</span>
        <span class="c1">#: &gt;&gt;&gt; print asdf.hrgt.keys()</span>
        <span class="c1">#: [&#39;NBC1-BzBz_PD32-0.8-monoA-CP&#39;, &#39;NBC1-BzBz_PD34-0.6-dimer&#39;, ... &#39;NBC1-BzBz_PD34-1.7-dimer&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hrgt</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1">#: dict of defined reaction subsets.</span>
        <span class="c1">#: Note that self.sset[&#39;default&#39;] contains all the nonredundant information.</span>
        <span class="c1">#:</span>
        <span class="c1">#: &gt;&gt;&gt; print asdf.sset.keys()</span>
        <span class="c1">#: [&#39;meme&#39;, &#39;mxddpp&#39;, &#39;5min&#39;, ... &#39;small&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># Removing hrxn, hrgt etc. do not reduce the size of the object.</span>
        <span class="c1"># These attributes are stored for ease of access for adding qc info, etc.</span>

        <span class="c1">#: object of defined reaction subsets.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oss</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># load database</span>
        <span class="k">if</span> <span class="n">pythonpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pythonpath</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/../databases&#39;</span><span class="p">)</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">psiutil</span><span class="o">.</span><span class="n">import_ignorecase</span><span class="p">(</span><span class="n">dbname</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">database</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Python module for database </span><span class="si">%s</span><span class="s1"> failed to load</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dbname</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Search path that was tried:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)))</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Python module loading problem for database &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dbname</span><span class="p">))</span>

        <span class="c1"># gross validation of database</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;dbse&#39;</span><span class="p">,</span> <span class="s1">&#39;GEOS&#39;</span><span class="p">,</span> <span class="s1">&#39;HRXN&#39;</span><span class="p">,</span> <span class="s1">&#39;ACTV&#39;</span><span class="p">,</span> <span class="s1">&#39;RXNM&#39;</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Database </span><span class="si">%s</span><span class="s2"> severely deformed with </span><span class="si">%s</span><span class="s2"> missing.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">database</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">item</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;TAGL&#39;</span><span class="p">,</span> <span class="s1">&#39;BIND&#39;</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: Database </span><span class="si">%s</span><span class="s2"> possibly deformed with </span><span class="si">%s</span><span class="s2"> missing.</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">database</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">item</span><span class="p">))</span>

        <span class="c1"># form database name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">dbse</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tagl</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">TAGL</span><span class="p">[</span><span class="s1">&#39;dbse&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: TAGL missing for database </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">))</span>

        <span class="c1"># form array of database contents to process through</span>
        <span class="n">pieces</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">database</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;qcdb&#39;</span><span class="p">,</span> <span class="s1">&#39;rxn&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">,</span> <span class="s1">&#39;TAGL&#39;</span><span class="p">]:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="c1"># form qcdb.Reagent objects from all defined geometries, GEOS</span>
        <span class="n">oHRGT</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">rgt</span><span class="p">,</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">database</span><span class="o">.</span><span class="n">GEOS</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">mol</span><span class="o">.</span><span class="n">update_geometry</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tagl</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">TAGL</span><span class="p">[</span><span class="n">rgt</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">tagl</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: TAGL missing for reagent </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rgt</span><span class="p">))</span>
            <span class="n">oHRGT</span><span class="p">[</span><span class="n">rgt</span><span class="p">]</span> <span class="o">=</span> <span class="n">Reagent</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">rgt</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">mol</span><span class="p">,</span> <span class="n">tagl</span><span class="o">=</span><span class="n">tagl</span><span class="p">)</span>
        <span class="n">pieces</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;GEOS&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hrgt</span> <span class="o">=</span> <span class="n">oHRGT</span>

        <span class="c1"># form qcdb.Reaction objects from comprehensive reaction list, HRXN</span>
        <span class="n">oHRXN</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">database</span><span class="o">.</span><span class="n">HRXN</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tagl</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">TAGL</span><span class="p">[</span><span class="n">database</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">tagl</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: TAGL missing for reaction </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rxn</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elst</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;SAPT ELST ENERGY&#39;</span><span class="p">][</span><span class="n">database</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)]</span>
                <span class="n">disp</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;SAPT DISP ENERGY&#39;</span><span class="p">][</span><span class="n">database</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)]</span>
                <span class="n">color</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">elst</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">elst</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">disp</span><span class="p">))</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: DATA[&#39;SAPT * ENERGY&#39;] missing for reaction </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rxn</span><span class="p">))</span>

            <span class="n">oHRXN</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">rxn</span><span class="p">,</span>
                                  <span class="n">dbse</span><span class="o">=</span><span class="n">database</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span>
                                  <span class="n">indx</span><span class="o">=</span><span class="n">database</span><span class="o">.</span><span class="n">HRXN</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                  <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                                  <span class="n">tagl</span><span class="o">=</span><span class="n">tagl</span><span class="p">)</span>
        <span class="n">pieces</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;HRXN&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span> <span class="o">=</span> <span class="n">oHRXN</span>

        <span class="c1"># list and align database stoichiometry modes, ACTV* and RXNM*</span>
        <span class="n">oACTV</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">modactv</span> <span class="ow">in</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">pieces</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ACTV&#39;</span><span class="p">)]:</span>
            <span class="n">modrxnm</span> <span class="o">=</span> <span class="n">modactv</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ACTV&#39;</span><span class="p">,</span> <span class="s1">&#39;RXNM&#39;</span><span class="p">)</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span> <span class="k">if</span> <span class="n">modactv</span> <span class="o">==</span> <span class="s1">&#39;ACTV&#39;</span> <span class="k">else</span> <span class="n">modactv</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ACTV_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">modrxnm</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">modrxnm</span> <span class="o">=</span> <span class="s1">&#39;RXNM&#39;</span>
            <span class="n">oACTV</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">modactv</span><span class="p">,</span> <span class="n">modrxnm</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="n">tmp</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">pieces</span> <span class="k">if</span> <span class="n">tmp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ACTV&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">tmp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;RXNM&#39;</span><span class="p">)]:</span>
            <span class="n">pieces</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="c1"># populate reaction matrices in qcdb.Reaction objects</span>
        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">database</span><span class="o">.</span><span class="n">HRXN</span><span class="p">:</span>
            <span class="n">dbrxn</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">mode</span><span class="p">,</span> <span class="n">actvrxnm</span> <span class="ow">in</span> <span class="n">oACTV</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">tdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">rgt</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">actvrxnm</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="n">dbrxn</span><span class="p">]:</span>
                    <span class="n">tdict</span><span class="p">[</span><span class="n">oHRGT</span><span class="p">[</span><span class="n">rgt</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">actvrxnm</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="n">dbrxn</span><span class="p">][</span><span class="n">rgt</span><span class="p">]</span>
                <span class="n">oHRXN</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">rxnm</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">=</span> <span class="n">tdict</span>

        <span class="c1"># list embedded quantum chem info per rxn, incl. BIND*</span>
        <span class="n">arrsbind</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">pieces</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;BIND_&#39;</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arrsbind</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;BIND&#39;</span> <span class="ow">in</span> <span class="n">pieces</span><span class="p">:</span>
                <span class="n">arrsbind</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BIND&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arrsbind</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: No BIND array with reference values.&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">arrbind</span> <span class="ow">in</span> <span class="n">arrsbind</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">arrbind</span><span class="p">)</span> <span class="ow">is</span> <span class="n">database</span><span class="o">.</span><span class="n">BIND</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: No BIND_* array assigned to be master BIND.&quot;&quot;&quot;</span><span class="p">)</span>

        <span class="n">oBIND</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">arrbind</span> <span class="ow">in</span> <span class="n">arrsbind</span><span class="p">:</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;REF&#39;</span> <span class="k">if</span> <span class="n">arrbind</span> <span class="o">==</span> <span class="s1">&#39;BIND&#39;</span> <span class="k">else</span> <span class="n">arrbind</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;BIND_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">methods</span><span class="p">[</span><span class="n">ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">Method</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
            <span class="n">bases</span><span class="p">[</span><span class="n">ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">BasisSet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="s1">&#39;BINDINFO_&#39;</span> <span class="o">+</span> <span class="n">ref</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">arrbindinfo</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: No BINDINFO dict with BIND attribution and modelchem for </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ref</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arrbindinfo</span> <span class="o">=</span> <span class="s1">&#39;BINDINFO_&#39;</span> <span class="o">+</span> <span class="n">ref</span>
            <span class="n">oBIND</span><span class="p">[</span><span class="n">ref</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">methods</span><span class="p">[</span><span class="n">ref</span><span class="p">],</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">bases</span><span class="p">[</span><span class="n">ref</span><span class="p">],</span> <span class="n">arrbind</span><span class="p">,</span>
                          <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">arrbind</span><span class="p">)</span> <span class="ow">is</span> <span class="n">database</span><span class="o">.</span><span class="n">BIND</span><span class="p">),</span>
                          <span class="n">arrbindinfo</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="n">tmp</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">pieces</span> <span class="k">if</span> <span class="n">tmp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;BIND&#39;</span><span class="p">)]:</span>
            <span class="n">pieces</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="c1"># populate data with reference values in qcdb.Reaction objects</span>
        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">database</span><span class="o">.</span><span class="n">HRXN</span><span class="p">:</span>
            <span class="n">dbrxn</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ref</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">oBIND</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">bindval</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="n">dbrxn</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">methodfeed</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">modefeed</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">basisfeed</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">citationkey</span> <span class="o">=</span> <span class="s1">&#39;anon&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bindinforxn</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="mi">5</span><span class="p">])[</span><span class="n">dbrxn</span><span class="p">]</span>
                    <span class="n">methodfeed</span> <span class="o">=</span> <span class="n">methods</span><span class="p">[</span><span class="n">bindinforxn</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span> <span class="k">if</span> <span class="s1">&#39;method&#39;</span> <span class="ow">in</span> <span class="n">bindinforxn</span> <span class="k">else</span> <span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">modefeed</span> <span class="o">=</span> <span class="n">bindinforxn</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;mode&#39;</span> <span class="ow">in</span> <span class="n">bindinforxn</span> <span class="k">else</span> <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">basisfeed</span> <span class="o">=</span> <span class="n">bases</span><span class="p">[</span><span class="n">bindinforxn</span><span class="p">[</span><span class="s1">&#39;basis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="k">if</span> <span class="s1">&#39;basis&#39;</span> <span class="ow">in</span> <span class="n">bindinforxn</span> <span class="k">else</span> <span class="n">info</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">citationkey</span> <span class="o">=</span> <span class="n">bindinforxn</span><span class="p">[</span><span class="s1">&#39;citation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;citation&#39;</span> <span class="ow">in</span> <span class="n">bindinforxn</span> <span class="k">else</span> <span class="s1">&#39;anon&#39;</span>
                <span class="n">citationfeed</span> <span class="o">=</span> <span class="n">pubs</span><span class="p">[</span><span class="n">citationkey</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">bindval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">oHRXN</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">ReactionDatum</span><span class="p">(</span><span class="n">dbse</span><span class="o">=</span><span class="n">database</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="o">=</span><span class="n">rxn</span><span class="p">,</span>
                                                         <span class="n">method</span><span class="o">=</span><span class="n">methodfeed</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">modefeed</span><span class="p">,</span>
                                                         <span class="n">basis</span><span class="o">=</span><span class="n">basisfeed</span><span class="p">,</span> <span class="n">citation</span><span class="o">=</span><span class="n">citationfeed</span><span class="p">,</span>
                                                         <span class="n">value</span><span class="o">=</span><span class="n">bindval</span><span class="p">)</span>
                    <span class="c1"># oHRXN[rxn].data[ref] = ReactionDatum(dbse=database.dbse,</span>
                    <span class="c1">#                                     rxn=rxn,</span>
                    <span class="c1">#                                     method=info[0],</span>
                    <span class="c1">#                                     mode=info[1],</span>
                    <span class="c1">#                                     basis=info[2],</span>
                    <span class="c1">#                                     value=bindval)</span>
                    <span class="c1">#                                     #value=getattr(database, info[3])[dbrxn])</span>
                    <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
                        <span class="n">oHRXN</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="n">ref</span>

        <span class="c1"># Process subsets</span>
        <span class="n">oSSET</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">fsHRXN</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">database</span><span class="o">.</span><span class="n">HRXN</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sset</span> <span class="ow">in</span> <span class="n">pieces</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">sset</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;AXIS_&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">fssset</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">sset</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">fssset</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">fsHRXN</span><span class="p">):</span>
                    <span class="n">oSSET</span><span class="p">[</span><span class="n">sset</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">sset</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">oSSET</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">pieces</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">oSSET</span><span class="p">[</span><span class="s1">&#39;HRXN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">HRXN</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oss</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>  <span class="c1"># just in case oss replaces sset someday</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">oSSET</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;HRXN_SM&#39;</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;small&#39;</span>
            <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;HRXN_LG&#39;</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;large&#39;</span>
            <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;HRXN_EQ&#39;</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;equilibrium&#39;</span>
            <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;HRXN&#39;</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
            <span class="k">elif</span> <span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;HRXN_&#39;</span><span class="p">):</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;HRXN_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

            <span class="c1"># subsets may have different ordering from HRXN</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">oSSET</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="n">rxn</span><span class="p">]</span> <span class="o">=</span> <span class="n">oHRXN</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span>

            <span class="c1"># initialize subset objects with light info</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">sstagl</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">TAGL</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">sstagl</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">TAGL</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">sstagl</span> <span class="o">=</span> <span class="bp">None</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: TAGL missing for subset </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">label</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oss</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">Subset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                                     <span class="n">hrxn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                                     <span class="n">tagl</span><span class="o">=</span><span class="n">sstagl</span><span class="p">)</span>

        <span class="c1"># Process axes</span>
        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">pieces</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;AXIS_&#39;</span><span class="p">)]:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;AXIS_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">defn</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Axis </span><span class="si">%s</span><span class="s2"> not importable.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">label</span><span class="p">))</span>
            <span class="n">axisrxns</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">defn</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">attached</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">for</span> <span class="n">ss</span><span class="p">,</span> <span class="n">rxns</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">rxns</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">axisrxns</span><span class="p">):</span>
                    <span class="n">ordered_floats</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">rx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">oss</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span><span class="o">.</span><span class="n">hrxn</span><span class="p">:</span>
                        <span class="n">ordered_floats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">defn</span><span class="p">[</span><span class="n">rx</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">oss</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">ordered_floats</span>
                    <span class="n">attached</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">attached</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: AXIS </span><span class="si">%s</span><span class="s2"> not affiliated with a subset&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">label</span><span class="p">))</span>
            <span class="n">pieces</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;WrappedDatabase </span><span class="si">%s</span><span class="s2">: Unparsed attributes&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">),</span> <span class="n">pieces</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  ==&gt; </span><span class="si">%s</span><span class="s2"> WrappedDatabase &lt;==</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Reagents:             </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hrgt</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Reactions:            </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Subsets:              </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Reference:            </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="p">())</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">text</span>

<div class="viewcode-block" id="WrappedDatabase.add_ReactionDatum"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.add_ReactionDatum">[docs]</a>    <span class="k">def</span> <span class="nf">add_ReactionDatum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kcal/mol&#39;</span><span class="p">,</span> <span class="n">citation</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">overwrite</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new quantum chemical value to *rxn* by creating a</span>
<span class="sd">        qcdb.ReactionDatum from same arguments as that class&#39;s</span>
<span class="sd">        object-less constructor. *rxn* may be actual Reaction.name</span>
<span class="sd">        or Reaction.indx.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">==</span> <span class="n">dbse</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="p">:</span>
                <span class="n">rxnname</span> <span class="o">=</span> <span class="n">rxn</span>  <span class="c1"># rxn is proper reaction name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">rxn</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">rxn</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">items</span><span class="p">()[</span><span class="n">rxn</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">indx</span><span class="p">):</span>
                        <span class="n">rxnname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">items</span><span class="p">()[</span><span class="n">rxn</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>  <span class="c1"># rxn is reaction index (maybe dangerous?)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;Inconsistent to add ReactionDatum for %s to database %s with reactions %s.&quot;&quot;&quot;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">method</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">basis</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">overwrite</span> <span class="ow">or</span> <span class="p">(</span><span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxnname</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxnname</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">ReactionDatum</span><span class="o">.</span><span class="n">library_modelchem</span><span class="p">(</span><span class="n">dbse</span><span class="o">=</span><span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="o">=</span><span class="n">rxnname</span><span class="p">,</span>
                                                                                 <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span>
                                                                                 <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
                                                                                 <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">citation</span><span class="o">=</span><span class="n">citation</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;ReactionDatum </span><span class="si">%s</span><span class="s2"> already present in Database.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">label</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Inconsistent to add ReactionDatum for </span><span class="si">%s</span><span class="s2"> to database </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span>
                                  <span class="p">(</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">))</span></div>

<div class="viewcode-block" id="WrappedDatabase.add_Subset"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.add_Subset">[docs]</a>    <span class="k">def</span> <span class="nf">add_Subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Define a new subset labeled *name* by providing a function</span>
<span class="sd">        *func* that filters *self.hrxn*.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sname</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">sname</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">tagl</span> <span class="o">=</span> <span class="n">sname</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">sname</span> <span class="k">else</span> <span class="bp">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">filtered</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">lsslist</span> <span class="o">=</span> <span class="p">[</span><span class="n">rxn</span> <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">filtered</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Function </span><span class="si">%s</span><span class="s2"> did not return list: </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lsslist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;WrappedDatabase </span><span class="si">%s</span><span class="s2">: Subset </span><span class="si">%s</span><span class="s2"> NOT formed: empty&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">label</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">lsslist</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="n">rxn</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oss</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">Subset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                                 <span class="n">hrxn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                                 <span class="n">tagl</span><span class="o">=</span><span class="n">tagl</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;WrappedDatabase </span><span class="si">%s</span><span class="s2">: Subset </span><span class="si">%s</span><span class="s2"> formed: </span><span class="si">%d</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span></div>

<div class="viewcode-block" id="WrappedDatabase.compute_errors"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.compute_errors">[docs]</a>    <span class="k">def</span> <span class="nf">compute_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For full database or subset *sset*, computes raw reaction</span>
<span class="sd">        errors between *modelchem* and *benchmark* model chemistries.</span>
<span class="sd">        Returns error if model chemistries are missing for any reaction in</span>
<span class="sd">        subset unless *failoninc* set to False, whereupon returns partial.</span>
<span class="sd">        Returns dictionary of reaction labels and error forms.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sset</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
            <span class="c1"># sset is normal subset name &#39;MX&#39; corresponding to HRXN_MX or MX array in database module</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">lsset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">sset</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># raise ValidationError(&quot;&quot;&quot;Subset named %s not available&quot;&quot;&quot; % (str(e)))</span>
                <span class="n">lsset</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">sset</span><span class="p">):</span>
                <span class="c1"># sset is function that will generate subset of HRXN from sset(self)</span>
                <span class="n">lsslist</span> <span class="o">=</span> <span class="p">[</span><span class="n">rxn</span> <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">sset</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># sset is array containing reactions</span>
                <span class="n">lsslist</span> <span class="o">=</span> <span class="p">[</span><span class="n">rxn</span> <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">sset</span><span class="p">]</span>
            <span class="c1"># assemble dict of qcdb.Reaction objects from array of reaction names</span>
            <span class="n">lsset</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">lsslist</span><span class="p">:</span>
                <span class="n">lsset</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span>

<span class="c1">#        cureinfo = self.get_pec_weightinfo()</span>
        <span class="n">err</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">oRxn</span> <span class="ow">in</span> <span class="n">lsset</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">lbench</span> <span class="o">=</span> <span class="n">oRxn</span><span class="o">.</span><span class="n">benchmark</span> <span class="k">if</span> <span class="n">benchmark</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span> <span class="k">else</span> <span class="n">benchmark</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mcLesser</span> <span class="o">=</span> <span class="n">oRxn</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">modelchem</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">failoninc</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Reaction </span><span class="si">%s</span><span class="s2"> missing datum </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mcGreater</span> <span class="o">=</span> <span class="n">oRxn</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">lbench</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">lbench</span> <span class="o">==</span> <span class="s1">&#39;ZEROS&#39;</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Reaction </span><span class="si">%s</span><span class="s2"> missing benchmark&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)))</span>
                    <span class="k">continue</span>
            <span class="c1"># handle particulars of PEC error measures</span>
<span class="c1">#            rxncureinfo = cureinfo[rxn]</span>
<span class="c1">#            try:</span>
<span class="c1">#                mcGreaterCrvmin = self.hrxn[rxncureinfo[&#39;eq&#39;]].data[lbench].value</span>
<span class="c1">#            except KeyError as e:</span>
<span class="c1">#                print &quot;&quot;&quot;Reaction %s missing benchmark&quot;&quot;&quot; % (str(eqrxn))</span>

<span class="c1">#            cure_denom = cure_weight(refrxn=mcGreater, refeq=mcGreaterCrvmin, rrat=rxncureinfo[&#39;Rrat&#39;])</span>
<span class="c1">#            balanced_mask, balwt = balanced_error(refrxn=mcGreater, refeq=mcGreaterCrvmin, rrat=rxncureinfo[&#39;Rrat&#39;])</span>

            <span class="k">if</span> <span class="n">lbench</span> <span class="o">==</span> <span class="s1">&#39;ZEROS&#39;</span><span class="p">:</span>
                <span class="n">err</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mcLesser</span><span class="p">,</span>
                            <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># FAKE</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">err</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mcLesser</span> <span class="o">-</span> <span class="n">mcGreater</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">mcLesser</span> <span class="o">-</span> <span class="n">mcGreater</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mcGreater</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">mcLesser</span> <span class="o">-</span> <span class="n">mcGreater</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mcGreater</span><span class="p">),</span>  <span class="c1"># FAKE</span>
                        <span class="p">(</span><span class="n">mcLesser</span> <span class="o">-</span> <span class="n">mcGreater</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mcGreater</span><span class="p">),</span>  <span class="c1"># FKAE</span>
                        <span class="mf">1.0</span>  <span class="c1"># FAKE</span>
                        <span class="p">]</span>
<span class="c1">#                        (mcLesser - mcGreater) / abs(cure_denom),</span>
<span class="c1">#                        (mcLesser - mcGreater) * balanced_mask / abs(mcGreaterCrvmin),</span>
<span class="c1">#                        balwt]</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;p = </span><span class="si">%8.4f</span><span class="s2">, pe = </span><span class="si">%8.3f%%</span><span class="s2">, pbe = </span><span class="si">%8.3f%%</span><span class="s2"> pce = </span><span class="si">%8.3f%%</span><span class="s2"> reaction </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span>
                 <span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="n">rxn</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="n">rxn</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="n">rxn</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="n">rxn</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">err</span></div>

<div class="viewcode-block" id="WrappedDatabase.compute_statistics"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.compute_statistics">[docs]</a>    <span class="k">def</span> <span class="nf">compute_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                           <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For full database or subset *sset*, computes many error</span>
<span class="sd">        statistics between single *modelchem* and *benchmark* model</span>
<span class="sd">        chemistries. Returns error if model chemistries are missing</span>
<span class="sd">        for any reaction in subset unless *failoninc* set to False,</span>
<span class="sd">        whereupon returns partial statistics. Returns dictionary of</span>
<span class="sd">        statistics labels and values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_errors</span><span class="p">(</span><span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">,</span> <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">initialize_errors</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: nothing to compute.&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Nrxn</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="c1"># linear (absolute) error</span>
            <span class="n">linear</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">err</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;pexe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">linear</span><span class="p">)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;nexe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">linear</span><span class="p">)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;maxe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mine&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">linear</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;me&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">linear</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nrxn</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">abs</span><span class="p">,</span> <span class="n">linear</span><span class="p">))</span> <span class="o">/</span> <span class="n">Nrxn</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">linear</span><span class="p">))</span> <span class="o">/</span> <span class="n">Nrxn</span><span class="p">)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;stde&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">linear</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">linear</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nrxn</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nrxn</span><span class="p">)</span>
            <span class="c1"># fractional (relative) error</span>
            <span class="n">relative</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">err</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;pexpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">relative</span><span class="p">)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;nexpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">relative</span><span class="p">)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;maxpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">relative</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;minpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">relative</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">relative</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nrxn</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">abs</span><span class="p">,</span> <span class="n">relative</span><span class="p">))</span> <span class="o">/</span> <span class="n">Nrxn</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;rmspe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">relative</span><span class="p">))</span> <span class="o">/</span> <span class="n">Nrxn</span><span class="p">)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;stdpe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">relative</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">relative</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nrxn</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nrxn</span><span class="p">)</span>
            <span class="c1"># balanced (relative) error</span>
            <span class="n">balanced</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">err</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
            <span class="n">balwt</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">val</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">err</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>  <span class="c1"># get the wt fn. highly irregular TODO</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;pexpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">balanced</span><span class="p">)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;nexpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">balanced</span><span class="p">)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;maxpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">balanced</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;minpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">balanced</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">balanced</span><span class="p">)</span> <span class="o">/</span> <span class="n">balwt</span> <span class="c1">#Nrxn</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mapbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">abs</span><span class="p">,</span> <span class="n">balanced</span><span class="p">))</span> <span class="o">/</span> <span class="n">balwt</span> <span class="c1">#Nrxn</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;rmspbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">balanced</span><span class="p">))</span> <span class="o">/</span> <span class="n">balwt</span><span class="p">)</span> <span class="c1">#Nrxn)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;stdpbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># get math domain errors w/wt in denom math.sqrt((sum(map(lambda x: x ** 2, balanced)) - (sum(balanced) ** 2) / balwt) / balwt) #/ Nrxn) / Nrxn)</span>
            <span class="c1"># capped (relative) error</span>
            <span class="n">capped</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">err</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;pexpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">capped</span><span class="p">)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;nexpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">capped</span><span class="p">)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;maxpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">capped</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;minpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">capped</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">capped</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nrxn</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;mapce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">abs</span><span class="p">,</span> <span class="n">capped</span><span class="p">))</span> <span class="o">/</span> <span class="n">Nrxn</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;rmspce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">capped</span><span class="p">))</span> <span class="o">/</span> <span class="n">Nrxn</span><span class="p">)</span>
            <span class="n">error</span><span class="p">[</span><span class="s1">&#39;stdpce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">capped</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">capped</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nrxn</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nrxn</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="si">%d</span><span class="s2"> systems in </span><span class="si">%s</span><span class="s2"> for </span><span class="si">%s</span><span class="s2"> vs. </span><span class="si">%s</span><span class="s2">, subset </span><span class="si">%s</span><span class="s2">.</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span>
                      <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">err</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="p">,</span> <span class="n">format_errors</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">returnindiv</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">error</span><span class="p">,</span> <span class="n">err</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">error</span></div>

<div class="viewcode-block" id="WrappedDatabase.load_qcdata"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.load_qcdata">[docs]</a>    <span class="k">def</span> <span class="nf">load_qcdata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modname</span><span class="p">,</span> <span class="n">funcname</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads qcdb.ReactionDatums from module *modname* function</span>
<span class="sd">        *funcname*. Module search path can be prepended with *pythonpath*.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pythonpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pythonpath</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/../data&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">datamodule</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">modname</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">failoninc</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span><span class="s2"> data unavailable for database </span><span class="si">%s</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">modname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">))</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">Python module for database data </span><span class="si">%s</span><span class="s2"> failed to load</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">modname</span><span class="p">))</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">Search path that was tried:</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)))</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Python module loading problem for database data &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">modname</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">datamodule</span><span class="p">,</span> <span class="n">funcname</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">failoninc</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> data unavailable for database </span><span class="si">%s</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">modname</span><span class="p">,</span> <span class="n">funcname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">))</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Python module missing function </span><span class="si">%s</span><span class="s2"> for loading data &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">funcname</span><span class="p">)))</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;WrappedDatabase </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> results loaded&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">modname</span><span class="p">,</span> <span class="n">funcname</span><span class="p">))</span></div>

<div class="viewcode-block" id="WrappedDatabase.load_qcdata_byproject"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.load_qcdata_byproject">[docs]</a>    <span class="k">def</span> <span class="nf">load_qcdata_byproject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads qcdb.ReactionDatums from standard location for *project*</span>
<span class="sd">        :module dbse_project and function load_project. Module search path</span>
<span class="sd">        can be prepended with *pythonpath*.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">project</span>
        <span class="n">func</span> <span class="o">=</span> <span class="s1">&#39;load_&#39;</span> <span class="o">+</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_qcdata</span><span class="p">(</span><span class="n">modname</span><span class="o">=</span><span class="n">mod</span><span class="p">,</span> <span class="n">funcname</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="n">pythonpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="WrappedDatabase.load_qcdata_hrxn_byproject"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.load_qcdata_hrxn_byproject">[docs]</a>    <span class="k">def</span> <span class="nf">load_qcdata_hrxn_byproject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/../data&#39;</span>
        <span class="n">pklfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;_hrxn_&#39;</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;.pickle&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">pklfile</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                <span class="s2">&quot;Reactions pickle file for loading database data from file </span><span class="si">%s</span><span class="s2"> does not exist&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pklfile</span><span class="p">))</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pklfile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
            <span class="n">hrxns</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
        <span class="c1"># no error checking for speed</span>
        <span class="k">for</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">hrxns</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="WrappedDatabase.load_qcdata_hdf5_trusted"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.load_qcdata_hdf5_trusted">[docs]</a>    <span class="k">def</span> <span class="nf">load_qcdata_hdf5_trusted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads qcdb.ReactionDatums from HDF5 file at path/dbse_project.h5 .</span>
<span class="sd">        If path not given, looks in qcdb/data. This file is written by</span>
<span class="sd">        reap-DB and so has been largely validated.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/../data&#39;</span>
        <span class="n">hdf5file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;.h5&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">hdf5file</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;HDF5 file for loading database data from file </span><span class="si">%s</span><span class="s2"> does not exist&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">hdf5file</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Pandas data managment module must be available for import&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">intrxn</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">intrxn</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_store</span><span class="p">(</span><span class="n">hdf5file</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">handle</span><span class="p">[</span><span class="s1">&#39;pdie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">lmc</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>  <span class="c1"># TODO could be done better</span>
                <span class="n">method</span> <span class="o">=</span> <span class="n">lmc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">bsse</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lmc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">basis</span> <span class="o">=</span> <span class="n">lmc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">df</span> <span class="o">=</span> <span class="n">handle</span><span class="p">[</span><span class="s1">&#39;pdie&#39;</span><span class="p">][</span><span class="n">mc</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">dbrxn</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                    <span class="p">[</span><span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dbrxn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">intrxn</span><span class="p">:</span>
                        <span class="n">rxn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="n">ReactionDatum</span><span class="o">.</span><span class="n">library_modelchem</span><span class="p">(</span><span class="n">dbse</span><span class="o">=</span><span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="o">=</span><span class="n">rxn</span><span class="p">,</span>
                                                                              <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">bsse</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span>
                                                                              <span class="n">value</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">dbrxn</span><span class="p">])</span></div>

<div class="viewcode-block" id="WrappedDatabase.integer_reactions"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.integer_reactions">[docs]</a>    <span class="k">def</span> <span class="nf">integer_reactions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns boolean of whether reaction names need to be cast to integer&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span></div>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="WrappedDatabase.load_pickled"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.load_pickled">[docs]</a>    <span class="k">def</span> <span class="nf">load_pickled</span><span class="p">(</span><span class="n">dbname</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/../data&#39;</span>
        <span class="n">picklefile</span> <span class="o">=</span> <span class="n">psiutil</span><span class="o">.</span><span class="n">findfile_ignorecase</span><span class="p">(</span><span class="n">dbname</span><span class="p">,</span>
                                                 <span class="n">pre</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="s1">&#39;_WDb.pickle&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">picklefile</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Pickle file for loading database data from file </span><span class="si">%s</span><span class="s2"> does not exist&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">dbname</span> <span class="o">+</span> <span class="s1">&#39;.pickle&#39;</span><span class="p">))</span>
        <span class="c1"># with open(&#39;/var/www/html/bfdb_devel/bfdb/scratch/ASDFlogfile.txt&#39;, &#39;a&#39;) as handle:</span>
        <span class="c1">#    handle.write(&#39;&lt;!-- PICKLE %s\n&#39; % (picklefile))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">picklefile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">instance</span></div>

<div class="viewcode-block" id="WrappedDatabase.available_modelchems"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.available_modelchems">[docs]</a>    <span class="k">def</span> <span class="nf">available_modelchems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">union</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns all the labels of model chemistries that have been</span>
<span class="sd">        loaded. Either all modelchems that have data for any reaction if</span>
<span class="sd">        *union* is True or all modelchems that have data for all reactions</span>
<span class="sd">        if *union* is False.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mcs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">itervalues</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">union</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">mcs</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="o">*</span><span class="n">mcs</span><span class="p">))</span></div>

<div class="viewcode-block" id="WrappedDatabase.benchmark"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.benchmark">[docs]</a>    <span class="k">def</span> <span class="nf">benchmark</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the model chemistry label for the database&#39;s benchmark.&quot;&quot;&quot;</span>
        <span class="n">bm</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">rxns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">itervalues</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">bm</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">bm</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">rxns</span><span class="p">)</span><span class="o">.</span><span class="n">benchmark</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">bm</span></div>
        <span class="c1"># return next(self.hrxn.itervalues()).benchmark</span>
        <span class="c1"># TODO all rxns have same bench in db module so all have same here in obj</span>
        <span class="c1">#   but the way things stored in Reactions, this doesn&#39;t have to be so</span>

<div class="viewcode-block" id="WrappedDatabase.load_subsets"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.load_subsets">[docs]</a>    <span class="k">def</span> <span class="nf">load_subsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modname</span><span class="o">=</span><span class="s1">&#39;subsetgenerator&#39;</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads subsets from all functions in module *modname*.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pythonpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pythonpath</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ssmod</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">modname</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">Python module for database data </span><span class="si">%s</span><span class="s2"> failed to load</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">modname</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">Search path that was tried:</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)))</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Python module loading problem for database subset generator &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">modname</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">ssmod</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">ssmod</span><span class="p">,</span> <span class="n">func</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_Subset</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">ssmod</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="n">__doc__</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ssmod</span><span class="p">,</span> <span class="n">func</span><span class="p">))</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;WrappedDatabase </span><span class="si">%s</span><span class="s2">: Defined subsets loaded&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">))</span></div>

<div class="viewcode-block" id="WrappedDatabase.get_pec_weightinfo"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.WrappedDatabase.get_pec_weightinfo">[docs]</a>    <span class="k">def</span> <span class="nf">get_pec_weightinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">closest</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">commonprefix</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">])))</span>

        <span class="n">dbdat</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">oss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oss</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span>
        <span class="n">eqrxns</span> <span class="o">=</span> <span class="p">[</span><span class="n">rxn</span> <span class="k">for</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">rr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">oss</span><span class="o">.</span><span class="n">hrxn</span><span class="p">,</span> <span class="n">oss</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="s1">&#39;Rrat&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">rr</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">rxnix</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">oss</span><span class="o">.</span><span class="n">hrxn</span><span class="p">):</span>
            <span class="n">dbdat</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;eq&#39;</span><span class="p">:</span> <span class="n">closest</span><span class="p">(</span><span class="n">rxn</span><span class="p">,</span> <span class="n">eqrxns</span><span class="p">),</span>
                          <span class="s1">&#39;Rrat&#39;</span><span class="p">:</span> <span class="n">oss</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="s1">&#39;Rrat&#39;</span><span class="p">][</span><span class="n">rxnix</span><span class="p">]}</span>
        <span class="k">return</span> <span class="n">dbdat</span></div></div>

    <span class="c1"># def table_simple1(self, mtd, bas, opt=[&#39;CP&#39;], err=[&#39;mae&#39;], benchmark=&#39;default&#39;, failoninc=True,</span>
    <span class="c1">#                   plotpath=&#39;analysis/flats/flat_&#39;, theme=&#39;smmerge&#39;):</span>
    <span class="c1">#     rowplan = [&#39;bas&#39;, &#39;mtd&#39;]</span>
    <span class="c1">#     columnplan = [</span>
    <span class="c1">#         [&#39;l&#39;, r&quot;&quot;&quot;Method \&amp; Basis Set&quot;&quot;&quot;, &#39;&#39;, textables.label, {}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;S22&#39;, &#39;HB&#39;, textables.val, {&#39;sset&#39;: &#39;hb&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;S22&#39;, &#39;MX&#39;, textables.val, {&#39;sset&#39;: &#39;mx&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;S22&#39;, &#39;DD&#39;, textables.val, {&#39;sset&#39;: &#39;dd&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;S22&#39;, &#39;TT&#39;, textables.val, {&#39;sset&#39;: &#39;default&#39;}],</span>
    <span class="c1">#     ]</span>
    <span class="c1">#</span>
    <span class="c1"># def table_simple2(self, mtd, bas, opt=[&#39;CP&#39;], err=[&#39;mae&#39;], benchmark=&#39;default&#39;, failoninc=True,</span>
    <span class="c1">#                   plotpath=&#39;analysis/flats/flat_&#39;, theme=&#39;smmerge&#39;):</span>
    <span class="c1">#     rowplan = [&#39;bas&#39;, &#39;mtd&#39;]</span>
    <span class="c1">#     columnplan = [</span>
    <span class="c1">#         [&#39;l&#39;, r&quot;&quot;&quot;Method \&amp; Basis Set&quot;&quot;&quot;, &#39;&#39;, textables.label, {}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MAE&#39;, &#39;HB&#39;, textables.val, {&#39;sset&#39;: &#39;hb&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MAE&#39;, &#39;MX&#39;, textables.val, {&#39;sset&#39;: &#39;mx&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MAE&#39;, &#39;DD&#39;, textables.val, {&#39;sset&#39;: &#39;dd&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MAE&#39;, &#39;TT&#39;, textables.val, {&#39;sset&#39;: &#39;default&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MA\%E&#39;, &#39;HB&#39;, textables.val, {&#39;sset&#39;: &#39;hb&#39;, &#39;err&#39;: &#39;mape&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MA\%E&#39;, &#39;MX&#39;, textables.val, {&#39;sset&#39;: &#39;mx&#39;, &#39;err&#39;: &#39;mape&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MA\%E&#39;, &#39;DD&#39;, textables.val, {&#39;sset&#39;: &#39;dd&#39;, &#39;err&#39;: &#39;mape&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MA\%E&#39;, &#39;TT&#39;, textables.val, {&#39;sset&#39;: &#39;default&#39;, &#39;err&#39;: &#39;mape&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;maxE&#39;, &#39;TT &#39;, textables.val, {&#39;sset&#39;: &#39;default&#39;, &#39;err&#39;: &#39;maxe&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;min\%E&#39;, &#39; TT&#39;, textables.val, {&#39;sset&#39;: &#39;default&#39;, &#39;err&#39;: &#39;minpe&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;rmsE&#39;, &#39;TT &#39;, textables.val, {&#39;sset&#39;: &#39;default&#39;, &#39;err&#39;: &#39;rmse&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;devE&#39;, &#39; TT&#39;, textables.val, {&#39;sset&#39;: &#39;default&#39;, &#39;err&#39;: &#39;stde&#39;}],</span>
    <span class="c1">#     ]</span>
    <span class="c1">#</span>
    <span class="c1"># def table_simple3(self, mtd, bas, opt=[&#39;CP&#39;], err=[&#39;mae&#39;], benchmark=&#39;default&#39;, failoninc=True,</span>
    <span class="c1">#                   plotpath=&#39;analysis/flats/flat_&#39;, theme=&#39;smmerge&#39;):</span>
    <span class="c1">#     rowplan = [&#39;err&#39;, &#39;bas&#39;, &#39;mtd&#39;]</span>
    <span class="c1">#     columnplan = [</span>
    <span class="c1">#         [&#39;l&#39;, r&quot;&quot;&quot;Method \&amp; Basis Set&quot;&quot;&quot;, &#39;&#39;, textables.label, {}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MAE&#39;, &#39;HB&#39;, textables.val, {&#39;sset&#39;: &#39;hb&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MAE&#39;, &#39;MX&#39;, textables.val, {&#39;sset&#39;: &#39;mx&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MAE&#39;, &#39;DD&#39;, textables.val, {&#39;sset&#39;: &#39;dd&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;MAE&#39;, &#39;TT&#39;, textables.val, {&#39;sset&#39;: &#39;default&#39;}],</span>
    <span class="c1">#     ]</span>
    <span class="c1">#</span>
    <span class="c1"># def table_simple4(self, mtd, bas, opt=[&#39;CP&#39;], err=[&#39;mae&#39;], benchmark=&#39;default&#39;, failoninc=True,</span>
    <span class="c1">#                   plotpath=&#39;analysis/flats/flat_&#39;, theme=&#39;smmerge&#39;):</span>
    <span class="c1">#     plotpath = &#39;autogen&#39;  # TODO handle better</span>
    <span class="c1">#     rowplan = [&#39;bas&#39;, &#39;mtd&#39;]</span>
    <span class="c1">#     columnplan = [</span>
    <span class="c1">#         [&#39;l&#39;, r&quot;&quot;&quot;Method \&amp; Basis Set&quot;&quot;&quot;, &#39;&#39;, textables.label, {}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;S22&#39;, &#39;HB&#39;, textables.val, {&#39;sset&#39;: &#39;hb&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;S22&#39;, &#39;MX&#39;, textables.val, {&#39;sset&#39;: &#39;mx&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;S22&#39;, &#39;DD&#39;, textables.val, {&#39;sset&#39;: &#39;dd&#39;}],</span>
    <span class="c1">#         [&#39;d&#39;, r&#39;S22&#39;, &#39;TT&#39;, textables.val, {&#39;sset&#39;: &#39;default&#39;}],</span>
    <span class="c1">#         # [&#39;l&#39;, r&quot;&quot;&quot;Error Distribution\footnotemark[1]&quot;&quot;&quot;, r&quot;&quot;&quot;\includegraphics[width=6.67cm,height=3.5mm]{%s%s.pdf}&quot;&quot;&quot; % (plotpath, &#39;blank&#39;), textables.graphics, {}],</span>
    <span class="c1">#         [&#39;l&#39;, r&quot;&quot;&quot;Error Distribution\footnotemark[1]&quot;&quot;&quot;, r&quot;&quot;&quot;&quot;&quot;&quot;, textables.graphics, {}],</span>
    <span class="c1">#     ]</span>


<div class="viewcode-block" id="Database"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database">[docs]</a><span class="k">class</span> <span class="nc">Database</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Collection for handling single or multiple qcdb.WrappedDatabase objects.</span>
<span class="sd">    Particularly, unifying modelchem and subset names that when inconsistent</span>
<span class="sd">    across component databases. Also, defining statistics across databases.</span>

<span class="sd">    &gt;&gt;&gt; asdf = qcdb.Database([&#39;s22&#39;, &#39;Nbc10&#39;, &#39;hbc6&#39;, &#39;HSG&#39;], &#39;DB4&#39;)</span>
<span class="sd">    &gt;&gt;&gt; qwer = qcdb.Database(&#39;s22&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbnamelist</span><span class="p">,</span> <span class="n">dbse</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">loadfrompickle</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1">#: internal name of database collection</span>
        <span class="c1">#:</span>
        <span class="c1">#: &gt;&gt;&gt; print asdf.dbse</span>
        <span class="c1">#: &#39;DB4&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1">#: ordered component Database objects</span>
        <span class="c1">#:</span>
        <span class="c1">#: &gt;&gt;&gt; print asdf.dbdict</span>
        <span class="c1">#: XXXX</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

        <span class="c1">#: subset assembly pattern</span>
        <span class="c1">#:</span>
        <span class="c1">#: &gt;&gt;&gt; print asdf.sset.keys()</span>
        <span class="c1">#: XXXX</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

        <span class="c1">#: assembly pattern for transspecies modelchems</span>
        <span class="c1">#:</span>
        <span class="c1">#: &gt;&gt;&gt; print asdf.mcs.keys()</span>
        <span class="c1">#: XXXX</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># slight validation, repackaging into dbnamelist</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dbnamelist</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
            <span class="n">dbnamelist</span> <span class="o">=</span> <span class="p">[</span><span class="n">dbnamelist</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dbnamelist</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Database::constructor: Inappropriate configuration of constructor arguments&#39;</span><span class="p">)</span>

        <span class="c1"># load databases</span>
        <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">dbnamelist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">loadfrompickle</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">WrappedDatabase</span><span class="o">.</span><span class="n">load_pickled</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">WrappedDatabase</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="n">pythonpath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">dbse</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>

        <span class="c1"># slurp up the obvious overlaps</span>
        <span class="n">consolidated_bench</span> <span class="o">=</span> <span class="p">[</span><span class="n">odb</span><span class="o">.</span><span class="n">benchmark</span><span class="p">()</span> <span class="k">for</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">consolidated_bench</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="n">consolidated_bench</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">consolidated_bench</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="p">]</span> <span class="o">=</span> <span class="n">consolidated_bench</span>

        <span class="c1"># methods[ref] = Method(name=ref)</span>
        <span class="c1"># bases[ref] = BasisSet(name=ref)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">consolidated_bench</span>
        <span class="c1"># self.mcs[&#39;default&#39;] = [odb.benchmark() for odb in self.dbdict.values()]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intersect_subsets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intersect_modelchems</span><span class="p">()</span>

        <span class="c1"># complex subsets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_subsets</span><span class="p">()</span>

        <span class="c1"># collection name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">if</span> <span class="n">dbse</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">dbse</span>

        <span class="c1"># merge Reaction-s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">orxn</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">orxn</span><span class="o">.</span><span class="n">dbrxn</span><span class="p">]</span> <span class="o">=</span> <span class="n">orxn</span>

        <span class="c1"># merge Reagent-s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hrgt</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rgt</span><span class="p">,</span> <span class="n">orgt</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrgt</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hrgt</span><span class="p">[</span><span class="n">orgt</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">orgt</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Database </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  ===&gt; </span><span class="si">%s</span><span class="s2"> Database &lt;===</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">)</span>
        <span class="c1"># text += &quot;&quot;&quot;  Reagents:             %s\n&quot;&quot;&quot; % (self.hrgt.keys())</span>
        <span class="c1"># text += &quot;&quot;&quot;  Reactions:            %s\n&quot;&quot;&quot; % (self.hrxn.keys())</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Subsets:              </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="c1"># text += &quot;&quot;&quot;  Reference:            %s\n&quot;&quot;&quot; % (&#39;default: &#39; + &#39; + &#39;.join(self.mcs[&#39;default&#39;]))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Reference:            </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="p">]))</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Reference:            </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  Model Chemistries:    </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([</span><span class="n">mc</span> <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">mc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">])))</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="p">[</span><span class="n">db</span><span class="p">]</span><span class="o">.</span><span class="n">__str__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">text</span>

    <span class="c1"># def benchmark(self):</span>
    <span class="c1">#     &quot;&quot;&quot;Returns the model chemistry label for the database&#39;s benchmark.&quot;&quot;&quot;</span>
    <span class="c1">#     return self.benchmark  #TODO not sure if right way to go about this self.mcs[&#39;default&#39;]</span>

<div class="viewcode-block" id="Database.fancy_mcs"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.fancy_mcs">[docs]</a>    <span class="k">def</span> <span class="nf">fancy_mcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fmcs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mtd</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">bas</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">fmcs</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="n">mc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">latex</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> \
                          <span class="p">(</span><span class="n">methods</span><span class="p">[</span><span class="n">mtd</span><span class="p">]</span><span class="o">.</span><span class="n">latex</span><span class="p">,</span> <span class="n">bases</span><span class="p">[</span><span class="n">bas</span><span class="p">]</span><span class="o">.</span><span class="n">latex</span><span class="p">,</span> <span class="n">mod</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">_&#39;</span><span class="p">))</span>
                    <span class="n">fmcs</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%45s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fmcs</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%20s</span><span class="s2"> / </span><span class="si">%-20s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> \
                               <span class="p">(</span><span class="n">methods</span><span class="p">[</span><span class="n">mtd</span><span class="p">]</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span> <span class="n">bases</span><span class="p">[</span><span class="n">bas</span><span class="p">]</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fmcs</span></div>

    <span class="c1"># def fancy_mcs_nested(self):</span>
    <span class="c1">#    &quot;&quot;&quot;</span>

    <span class="c1">#    &quot;&quot;&quot;</span>
    <span class="c1">#    fmcs = defaultdict(lambda: defaultdict(dict))</span>
    <span class="c1">#    for mc in self.mcs.keys():</span>
    <span class="c1">#        try:</span>
    <span class="c1">#            mtd, mod, bas = mc.split(&#39;-&#39;)</span>
    <span class="c1">#        except ValueError:</span>
    <span class="c1">#            fmcs[&#39;All&#39;][&#39;All&#39;][mc] = mc</span>
    <span class="c1">#            fmcs[&#39;Method&#39;][&#39;Others&#39;][mc] = mc</span>
    <span class="c1">#            fmcs[&#39;Options&#39;][&#39;Others&#39;][mc] = mc</span>
    <span class="c1">#            fmcs[&#39;Basis Treatment&#39;][&#39;Others&#39;][mc] = mc</span>
    <span class="c1">#        else:</span>
    <span class="c1">#            fancyrepr = &quot;&quot;&quot;%20s / %-20s %s&quot;&quot;&quot; % (methods[mtd].latex, bases[bas].latex, mod)</span>
    <span class="c1">#            fmcs[&#39;All&#39;][&#39;All&#39;][mc] = fancyrepr</span>
    <span class="c1">#            fmcs[&#39;Method&#39;][methods[mtd].latex][mc] = fancyrepr</span>
    <span class="c1">#            fmcs[&#39;Options&#39;][mod][mc] = fancyrepr</span>
    <span class="c1">#            fmcs[&#39;Basis Treatment&#39;][bases[bas].latex][mc] = fancyrepr</span>
    <span class="c1">#    return fmcs</span>

<div class="viewcode-block" id="Database.integer_reactions"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.integer_reactions">[docs]</a>    <span class="k">def</span> <span class="nf">integer_reactions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns boolean of whether reaction names need to be cast to integer&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">db</span><span class="p">:</span> <span class="n">odb</span><span class="o">.</span><span class="n">integer_reactions</span><span class="p">()</span> <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span></div>

<div class="viewcode-block" id="Database.load_qcdata_byproject"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.load_qcdata_byproject">[docs]</a>    <span class="k">def</span> <span class="nf">load_qcdata_byproject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For each component database, loads qcdb.ReactionDatums from</span>
<span class="sd">        standard location for *project* :module dbse_project and function</span>
<span class="sd">        load_project. Module search path can be prepended with *pythonpath*.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">odb</span><span class="o">.</span><span class="n">load_qcdata_byproject</span><span class="p">(</span><span class="n">project</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="n">pythonpath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intersect_modelchems</span><span class="p">()</span></div>

<div class="viewcode-block" id="Database.load_qcdata_hdf5_trusted"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.load_qcdata_hdf5_trusted">[docs]</a>    <span class="k">def</span> <span class="nf">load_qcdata_hdf5_trusted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For each component database, loads qcdb.ReactionDatums from</span>
<span class="sd">        HDF5 file at path/dbse_project.h5 . If path not given, looks in</span>
<span class="sd">        qcdb/data. This file is written by reap-DB and so has been largely</span>
<span class="sd">        validated.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">odb</span><span class="o">.</span><span class="n">load_qcdata_hdf5_trusted</span><span class="p">(</span><span class="n">project</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intersect_modelchems</span><span class="p">()</span></div>

<div class="viewcode-block" id="Database.load_qcdata_hrxn_byproject"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.load_qcdata_hrxn_byproject">[docs]</a>    <span class="k">def</span> <span class="nf">load_qcdata_hrxn_byproject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">odb</span><span class="o">.</span><span class="n">load_qcdata_hrxn_byproject</span><span class="p">(</span><span class="n">project</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intersect_modelchems</span><span class="p">()</span></div>

<div class="viewcode-block" id="Database.available_projects"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.available_projects">[docs]</a>    <span class="k">def</span> <span class="nf">available_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">glob</span>

        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/../data&#39;</span>

        <span class="n">projects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pjfn</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/*_hrxn_*.pickle&#39;</span><span class="p">):</span>
            <span class="n">pj</span> <span class="o">=</span> <span class="n">pjfn</span><span class="p">[:</span><span class="o">-</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">projects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pj</span><span class="p">)</span>

        <span class="n">complete_projects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">projects</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">db</span> <span class="o">+</span> <span class="s1">&#39;_hrxn_&#39;</span> <span class="o">+</span> <span class="n">pj</span> <span class="o">+</span> <span class="s1">&#39;.pickle&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()]):</span>
                <span class="n">complete_projects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pj</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">complete_projects</span></div>

<div class="viewcode-block" id="Database.load_subsets"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.load_subsets">[docs]</a>    <span class="k">def</span> <span class="nf">load_subsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modname</span><span class="o">=</span><span class="s1">&#39;subsetgenerator&#39;</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For each component database, loads subsets from all functions</span>
<span class="sd">        in module *modname*. Default *modname* usues standard generators.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">odb</span><span class="o">.</span><span class="n">load_subsets</span><span class="p">(</span><span class="n">modname</span><span class="o">=</span><span class="n">modname</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="n">pythonpath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intersect_subsets</span><span class="p">()</span></div>

<div class="viewcode-block" id="Database.add_Subset"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.add_Subset">[docs]</a>    <span class="k">def</span> <span class="nf">add_Subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Define a new subset labeled *name* by providing a database</span>
<span class="sd">        *func* whose keys are the keys of dbdict and whose values are a</span>
<span class="sd">        function that filters each WrappedDatabase&#39;s *self.hrxn*.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">merged</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">db</span><span class="p">]):</span>
                <span class="n">ssfunc</span> <span class="o">=</span> <span class="n">func</span><span class="p">[</span><span class="n">db</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ssfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">func</span><span class="p">[</span><span class="n">db</span><span class="p">]</span>
            <span class="n">odb</span><span class="o">.</span><span class="n">add_Subset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">ssfunc</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">sset</span><span class="p">:</span>
                <span class="n">merged</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">merged</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">merged</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Database </span><span class="si">%s</span><span class="s2">: Subset </span><span class="si">%s</span><span class="s2"> formed: </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">label</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Database </span><span class="si">%s</span><span class="s2">: Subset </span><span class="si">%s</span><span class="s2"> NOT formed: empty&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">label</span><span class="p">))</span></div>

<div class="viewcode-block" id="Database.add_Subset_union"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.add_Subset_union">[docs]</a>    <span class="k">def</span> <span class="nf">add_Subset_union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">sslist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Define a new subset labeled *name* (note that there&#39;s nothing to</span>
<span class="sd">        prevent overwriting an existing subset name) from the union of</span>
<span class="sd">        existing named subsets in *sslist*.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">funcdb</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">dbix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
            <span class="n">overlapping_dbrxns</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
                <span class="n">lss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">ss</span><span class="p">][</span><span class="n">dbix</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">lss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">overlapping_dbrxns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="p">[</span><span class="n">db</span><span class="p">]</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">lss</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">rxnlist</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">overlapping_dbrxns</span><span class="p">)</span>
            <span class="n">funcdb</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="o">=</span> <span class="n">rxnlist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Subset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">funcdb</span><span class="p">)</span></div>

<div class="viewcode-block" id="Database.add_sampled_Subset"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.add_sampled_Subset">[docs]</a>    <span class="k">def</span> <span class="nf">add_sampled_Subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">number_of_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;rand&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate and register *number_of_samples* new subsets of size</span>
<span class="sd">        *sample_size* and name built from *prefix*. Reactions chosen from *sset*.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">random</span>

        <span class="n">intrxn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">integer_reactions</span><span class="p">()</span>
        <span class="n">rxns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_hrxn</span><span class="p">(</span><span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">random_sample</span><span class="p">(</span><span class="n">ssname</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Generate and register a single new subset of size *sample_size* and</span>
<span class="sd">            name *ssname*.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">sample</span> <span class="o">=</span> <span class="p">{</span><span class="n">db</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
            <span class="k">for</span> <span class="n">dbrxn</span> <span class="ow">in</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">rxns</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">):</span>
                <span class="n">db</span><span class="p">,</span> <span class="n">rxn</span> <span class="o">=</span> <span class="n">dbrxn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">typed_rxn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span> <span class="k">if</span> <span class="n">intrxn</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="k">else</span> <span class="n">rxn</span>
                <span class="n">sample</span><span class="p">[</span><span class="n">db</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">typed_rxn</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_Subset</span><span class="p">(</span><span class="n">ssname</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sidx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_samples</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">number_of_samples</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ssname</span> <span class="o">=</span> <span class="n">prefix</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ssname</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sidx</span><span class="p">)</span>
            <span class="n">random_sample</span><span class="p">(</span><span class="n">ssname</span><span class="p">)</span></div>

<div class="viewcode-block" id="Database.promote_Subset"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.promote_Subset">[docs]</a>    <span class="k">def</span> <span class="nf">promote_Subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Examine component databases and elevate subset *name* not necessarily</span>
<span class="sd">        present for all component databases to a subset for the *self*. When *name*</span>
<span class="sd">        is None, promotes all subsets found for component databases. Also promotes</span>
<span class="sd">        entirety of each component database as a subset with name of component</span>
<span class="sd">        database dbse in lowercase.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sss</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">odb</span><span class="o">.</span><span class="n">sset</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
            <span class="n">new</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">sss</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">new</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ss</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span> <span class="k">if</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">sset</span> <span class="k">else</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()]</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Database </span><span class="si">%s</span><span class="s2">: Subset </span><span class="si">%s</span><span class="s2"> promoted: </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">ss</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">dbix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
                <span class="n">ss</span> <span class="o">=</span> <span class="n">odb</span><span class="o">.</span><span class="n">dbse</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">ss</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;default&#39;</span> <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="n">dbix</span> <span class="k">else</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="p">))]</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Database </span><span class="si">%s</span><span class="s2">: Subset </span><span class="si">%s</span><span class="s2"> promoted: </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">ss</span><span class="p">]))</span></div>

    <span class="k">def</span> <span class="nf">_intersect_subsets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Examine component database subsets and collect common names as</span>
<span class="sd">        Database subset.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sss</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">odb</span><span class="o">.</span><span class="n">sset</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">new</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="o">*</span><span class="n">sss</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_intersect_modelchems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Examine component database qcdata and collect common names as</span>
<span class="sd">        Database modelchem.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mcs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">odb</span><span class="o">.</span><span class="n">available_modelchems</span><span class="p">())</span> <span class="k">for</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">itervalues</span><span class="p">()]</span>
        <span class="n">new</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="o">*</span><span class="n">mcs</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="c1"># def reaction_generator(self):</span>
    <span class="c1">#    &quot;&quot;&quot;</span>

    <span class="c1">#    &quot;&quot;&quot;</span>
    <span class="c1">#    for db, odb in self.dbdict.items():</span>
    <span class="c1">#        for rxn, orxn in odb.hrxn.items():</span>
    <span class="c1">#            yield orxn</span>

<div class="viewcode-block" id="Database.compute_statistics"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.compute_statistics">[docs]</a>    <span class="k">def</span> <span class="nf">compute_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                           <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes summary statistics and, if *returnindiv* True,</span>
<span class="sd">        individual errors for single model chemistry *modelchem* versus</span>
<span class="sd">        *benchmark* over subset *sset* over all component databases.</span>
<span class="sd">        Particularly, imposes cross-database definitions for sset and</span>
<span class="sd">        modelchem.</span>
<span class="sd">        #Returns error if model chemistries are missing</span>
<span class="sd">        #for any reaction in subset unless *failoninc* set to False,</span>
<span class="sd">        #whereupon returns partial statistics. Returns dictionary of</span>
<span class="sd">        #statistics labels and values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">indiv</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">actvdb</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">dbix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">sset</span><span class="p">][</span><span class="n">dbix</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">errors</span><span class="p">[</span><span class="n">db</span><span class="p">],</span> <span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">errors</span><span class="p">[</span><span class="n">db</span><span class="p">],</span> <span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="o">=</span> <span class="n">odb</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="n">modelchem</span><span class="p">][</span><span class="n">dbix</span><span class="p">],</span>
                                                               <span class="n">sset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">sset</span><span class="p">][</span><span class="n">dbix</span><span class="p">],</span>
                                                               <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;ZEROS&#39;</span> <span class="k">if</span> <span class="n">benchmark</span> <span class="o">==</span> <span class="s1">&#39;ZEROS&#39;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="n">benchmark</span><span class="p">][</span><span class="n">dbix</span><span class="p">],</span>
                                                               <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">actvdb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="n">db</span><span class="p">])</span>
        <span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">]</span> <span class="o">=</span> <span class="n">average_errors</span><span class="p">(</span><span class="o">*</span><span class="n">actvdb</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">returnindiv</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">indiv</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">errors</span></div>

<div class="viewcode-block" id="Database.analyze_modelchems"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.analyze_modelchems">[docs]</a>    <span class="k">def</span> <span class="nf">analyze_modelchems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For each component database, compute and print nicely formatted</span>
<span class="sd">        summary error statistics for each model chemistry in array</span>
<span class="sd">        *modelchem* versus *benchmark* for all available subsets.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># compute errors</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">modelchem</span><span class="p">:</span>
            <span class="n">errors</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">errors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span>
                                                         <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c1"># present errors</span>
        <span class="n">pre</span><span class="p">,</span> <span class="n">suf</span><span class="p">,</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">string_contrast</span><span class="p">(</span><span class="n">modelchem</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">  ==&gt; </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">[]</span><span class="si">%s</span><span class="s2"> Errors &lt;==</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">suf</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%20s</span><span class="s2">    </span><span class="si">%44s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;==&gt; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39; &lt;==&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%44s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;=&gt; &#39;</span> <span class="o">+</span> <span class="n">odb</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39; &lt;=&#39;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">collabel</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;      {:5}   {:4}   {:6} {:6}    {:6}&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="s1">&#39;STDE&#39;</span><span class="p">,</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span> <span class="s1">&#39;MA</span><span class="si">%E</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;MA%BE&#39;</span><span class="p">)</span>

        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;{:20}    &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">collabel</span>
        <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">collabel</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;{:20}    {}&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span> <span class="o">*</span> <span class="mi">44</span><span class="p">)</span>
        <span class="n">ul</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;{}&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;_&#39;</span> <span class="o">*</span> <span class="mi">44</span> <span class="k">if</span> <span class="n">ul</span> <span class="k">else</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">44</span><span class="p">)</span>
            <span class="n">ul</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ul</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;   =&gt; </span><span class="si">%s</span><span class="s2"> &lt;=</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ss</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">modelchem</span><span class="p">:</span>
                <span class="n">perr</span> <span class="o">=</span> <span class="n">errors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">]</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%20s</span><span class="s2">    </span><span class="si">%44s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mid</span><span class="p">[</span><span class="n">modelchem</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">mc</span><span class="p">)],</span>
                                              <span class="n">format_errors</span><span class="p">(</span><span class="n">perr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">]))</span>
                <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%44s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">perr</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">format_errors</span><span class="p">(</span><span class="n">perr</span><span class="p">[</span><span class="n">db</span><span class="p">]))</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="Database.plot_bars"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.plot_bars">[docs]</a>    <span class="k">def</span> <span class="nf">plot_bars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;hb&#39;</span><span class="p">,</span> <span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">],</span>
                  <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Prepares &#39;grey bars&#39; diagram for each model chemistry in array</span>
<span class="sd">        *modelchem* versus *benchmark* over all component databases. A wide bar</span>
<span class="sd">        is plotted with three smaller bars, corresponding to the &#39;mae&#39;</span>
<span class="sd">        summary statistic of the four subsets in *sset*.</span>

<span class="sd">        *saveas* conveys directory (&#39;/&#39;) and/or filename for saving the</span>
<span class="sd">        resulting plot. File extension is not accessible, but *graphicsformat*</span>
<span class="sd">        array requests among &#39;png&#39;, &#39;pdf&#39;, and &#39;eps&#39; formats. *relpath*</span>
<span class="sd">        forces paths to saved files to be relative to current directory,</span>
<span class="sd">        rather than absolute paths for returned code and file dictionary.</span>

<span class="sd">        Prepares bars diagram instructions and either executes them if</span>
<span class="sd">        matplotlib available (Canopy or Anaconda) or prints them. Returns a</span>
<span class="sd">        dictionary of all saved plot filenames.</span>

<span class="sd">        &gt;&gt;&gt; asdf.plot_bars([&#39;MP2-CP-adz&#39;, &#39;MP2-CP-adtz&#39;], sset=[&#39;tt-5min&#39;, &#39;hb-5min&#39;, &#39;mx-5min&#39;, &#39;dd-5min&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># compute errors</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">modelchem</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">errors</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sset</span><span class="p">:</span>
                    <span class="n">errors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span>
                                                             <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c1"># repackage</span>
        <span class="n">pre</span><span class="p">,</span> <span class="n">suf</span><span class="p">,</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">string_contrast</span><span class="p">(</span><span class="n">modelchem</span><span class="p">)</span>
        <span class="n">dbdat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">modelchem</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mc</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">dbdat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dbdat</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;mc&#39;</span><span class="p">:</span> <span class="n">mid</span><span class="p">[</span><span class="n">modelchem</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">mc</span><span class="p">)],</span>
                              <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">errors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sset</span><span class="p">]})</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">pre</span> <span class="o">+</span> <span class="s1">&#39;[]&#39;</span> <span class="o">+</span> <span class="n">suf</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sset</span><span class="p">)</span>
        <span class="c1"># generate matplotlib instructions and call or print</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mpl</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="c1"># if not running from Canopy, print line to execute from Canopy</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;filedict = mpl.bars(</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    title=&#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">    saveas=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    relpath=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    graphicsformat=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span>
                  <span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">saveas</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">relpath</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">graphicsformat</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if running from Canopy, call mpl directly</span>
            <span class="n">filedict</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">bars</span><span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span>
                                <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="n">graphicsformat</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">filedict</span></div>

    <span class="c1"># def get_pec_weightinfo(self):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     def closest(u, options):</span>
    <span class="c1">#         return max(options, key=lambda v: len(os.path.commonprefix([u, v])))</span>
    <span class="c1">#</span>
    <span class="c1">#     dbdat = {}</span>
    <span class="c1">#     for db, odb in self.dbdict.iteritems():</span>
    <span class="c1">#         #dbix = self.dbdict.keys().index(db)</span>
    <span class="c1">#         oss = odb.oss[&#39;default&#39;]</span>
    <span class="c1">#         eqrxns = [rxn for rxn, rr in zip(oss.hrxn, oss.axis[&#39;Rrat&#39;]) if rr == 1.0]</span>
    <span class="c1">#         for rxnix, rxn in enumerate(oss.hrxn):</span>
    <span class="c1">#             dbrxn = &#39;-&#39;.join([db, rxn])</span>
    <span class="c1">#             rrat = oss.axis[&#39;Rrat&#39;][rxnix]</span>
    <span class="c1">#             eq = closest(rxn, eqrxns)</span>
    <span class="c1">#             print rxn, rxnix, eq, rrat, dbrxn</span>
    <span class="c1">#             dbdat[dbrxn] = {&#39;eq&#39;: eq, &#39;Rrat&#39;: rrat}</span>
    <span class="c1">#     return dbdat</span>

<div class="viewcode-block" id="Database.plot_axis"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.plot_axis">[docs]</a>    <span class="k">def</span> <span class="nf">plot_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                  <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;sapt&#39;</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dbdatdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">modelchem</span><span class="p">:</span>
            <span class="c1"># compute errors</span>
            <span class="n">errors</span><span class="p">,</span> <span class="n">indiv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">,</span>
                                                    <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="c1"># repackage</span>
            <span class="n">dbdat</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">dbix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
                <span class="n">oss</span> <span class="o">=</span> <span class="n">odb</span><span class="o">.</span><span class="n">oss</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">sset</span><span class="p">][</span><span class="n">dbix</span><span class="p">]]</span>
                <span class="c1"># TODO may need to make axis name distributable across wrappeddbs</span>
                <span class="c1"># TODO not handling mc present bm absent</span>
                <span class="k">if</span> <span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">oss</span><span class="o">.</span><span class="n">hrxn</span><span class="p">:</span>
                        <span class="n">rxnix</span> <span class="o">=</span> <span class="n">oss</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>
                        <span class="n">bm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="n">benchmark</span><span class="p">][</span><span class="n">dbix</span><span class="p">]</span>
                        <span class="n">bmpresent</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="p">(</span><span class="n">bm</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">bm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">else</span> <span class="bp">True</span>
                        <span class="n">mcpresent</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">dbix</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">else</span> <span class="bp">True</span>
                        <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="n">db</span><span class="p">,</span>
                                 <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">),</span>
                                 <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">color</span><span class="p">,</span>
                                 <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="n">oss</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="n">rxnix</span><span class="p">]}</span>

                        <span class="k">if</span> <span class="n">bmpresent</span><span class="p">:</span>
                            <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;bmdata&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="n">benchmark</span><span class="p">][</span><span class="n">dbix</span><span class="p">]]</span><span class="o">.</span><span class="n">value</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;bmdata&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

                        <span class="k">if</span> <span class="n">mcpresent</span><span class="p">:</span>
                            <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;mcdata&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">dbix</span><span class="p">]]</span><span class="o">.</span><span class="n">value</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">continue</span>

                        <span class="k">if</span> <span class="n">bmpresent</span> <span class="ow">and</span> <span class="n">mcpresent</span><span class="p">:</span>
                            <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">][</span><span class="n">rxn</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span>
                        <span class="n">dbdat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="n">dbdatdict</span><span class="p">[</span><span class="n">fancify_mc_tag</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">dbdat</span>

        <span class="n">pre</span><span class="p">,</span> <span class="n">suf</span><span class="p">,</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">string_contrast</span><span class="p">(</span><span class="n">modelchem</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span><span class="s2">[</span><span class="si">%s</span><span class="s2">]</span><span class="si">%s</span><span class="s2"> vs </span><span class="si">%s</span><span class="s2"> axis </span><span class="si">%s</span><span class="s2"> for </span><span class="si">%s</span><span class="s2"> subset </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mid</span><span class="p">)),</span> <span class="n">suf</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">sset</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="c1">#for mc, dbdat in dbdatdict.iteritems():</span>
        <span class="c1">#    print mc</span>
        <span class="c1">#    for d in dbdat:</span>
        <span class="c1">#        print &#39;{:20s} {:8.2f}    {:8.2f} {:8.2f}&#39;.format(d[&#39;sys&#39;], d[&#39;axis&#39;],</span>
        <span class="c1">#            0.0 if d[&#39;bmdata&#39;] is None else d[&#39;bmdata&#39;],</span>
        <span class="c1">#            0.0 if d[&#39;mcdata&#39;] is None else d[&#39;mcdata&#39;])</span>
        <span class="c1"># generate matplotlib instructions and call or print</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mpl</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="c1"># if not running from Canopy, print line to execute from Canopy</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;filedict = mpl.valerr(</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    color=&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="se">\n</span><span class="s2">    title=&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="se">\n</span><span class="s2">    xtitle=&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="se">\n</span><span class="s2">    view=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    saveas=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    relpath=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    graphicsformat=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span>
                  <span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">saveas</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">relpath</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">graphicsformat</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if running from Canopy, call mpl directly</span>
            <span class="n">filedict</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">valerr</span><span class="p">(</span><span class="n">dbdatdict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xtitle</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                                  <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span>
                                  <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="n">graphicsformat</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">filedict</span></div>

<div class="viewcode-block" id="Database.load_saptdata_frombfdb"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.load_saptdata_frombfdb">[docs]</a>    <span class="k">def</span> <span class="nf">load_saptdata_frombfdb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
        <span class="n">pythonpath</span><span class="o">=</span><span class="s1">&#39;/Users/loriab/linux/bfdb/sapt_punt&#39;</span><span class="p">,</span> <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>  <span class="c1"># pythonpath=None</span>
        <span class="sd">&quot;&quot;&quot;This is a stopgap function that loads sapt component data from</span>
<span class="sd">        sapt_punt in bfdb repo.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">saptpackage</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">modname</span> <span class="o">=</span> <span class="s1">&#39;sapt_&#39;</span> <span class="o">+</span> <span class="n">odb</span><span class="o">.</span><span class="n">dbse</span>
            <span class="k">if</span> <span class="n">pythonpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pythonpath</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/../data&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">datamodule</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">modname</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">Python module for database data </span><span class="si">%s</span><span class="s2"> failed to load</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">modname</span><span class="p">))</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">Search path that was tried:</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)))</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Python module loading problem for database subset generator &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">modname</span><span class="p">))</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">saptdata</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">datamodule</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;SAPT punt module does not contain DATA&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">modname</span><span class="p">))</span>
            <span class="n">saptmc</span> <span class="o">=</span> <span class="n">saptdata</span><span class="p">[</span><span class="s1">&#39;SAPT MODELCHEM&#39;</span><span class="p">]</span>

            <span class="n">dbix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">orxn</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">lss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">sset</span><span class="p">][</span><span class="n">dbix</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">lss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">lss</span><span class="p">]:</span>
                        <span class="n">dbrxn</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">dbrxn</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">elst</span> <span class="o">=</span> <span class="n">saptdata</span><span class="p">[</span><span class="s1">&#39;SAPT ELST ENERGY&#39;</span><span class="p">][</span><span class="n">dbrxn</span><span class="p">]</span>
                            <span class="n">exch</span> <span class="o">=</span> <span class="n">saptdata</span><span class="p">[</span><span class="s1">&#39;SAPT EXCH ENERGY&#39;</span><span class="p">][</span><span class="n">dbrxn</span><span class="p">]</span>
                            <span class="n">ind</span> <span class="o">=</span> <span class="n">saptdata</span><span class="p">[</span><span class="s1">&#39;SAPT IND ENERGY&#39;</span><span class="p">][</span><span class="n">dbrxn</span><span class="p">]</span>
                            <span class="n">disp</span> <span class="o">=</span> <span class="n">saptdata</span><span class="p">[</span><span class="s1">&#39;SAPT DISP ENERGY&#39;</span><span class="p">][</span><span class="n">dbrxn</span><span class="p">]</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: DATA[&#39;SAPT * ENERGY&#39;] missing for reaction </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dbrxn</span><span class="p">))</span>
                            <span class="k">if</span> <span class="n">failoninc</span><span class="p">:</span>
                                <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">elst</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">disp</span><span class="p">]):</span>  <span class="c1"># exch sometimes physically zero</span>
                                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Warning: DATA[&#39;SAPT * ENERGY&#39;] missing piece for reaction </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dbrxn</span><span class="p">,</span> <span class="p">[</span><span class="n">elst</span><span class="p">,</span> <span class="n">exch</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">disp</span><span class="p">]))</span>
                                <span class="k">if</span> <span class="n">failoninc</span><span class="p">:</span>
                                    <span class="k">break</span>
                        <span class="n">saptpackage</span><span class="p">[</span><span class="n">dbrxn</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mc&#39;</span><span class="p">:</span> <span class="n">saptmc</span><span class="p">,</span>
                                              <span class="s1">&#39;elst&#39;</span><span class="p">:</span> <span class="n">elst</span><span class="p">,</span>
                                              <span class="s1">&#39;exch&#39;</span><span class="p">:</span> <span class="n">exch</span><span class="p">,</span>
                                              <span class="s1">&#39;ind&#39;</span><span class="p">:</span> <span class="n">ind</span><span class="p">,</span>
                                              <span class="s1">&#39;disp&#39;</span><span class="p">:</span> <span class="n">disp</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">saptpackage</span></div>

<div class="viewcode-block" id="Database.plot_ternary"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.plot_ternary">[docs]</a>    <span class="k">def</span> <span class="nf">plot_ternary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">labeled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">pythonpath</span><span class="o">=</span><span class="s1">&#39;/Users/loriab/linux/bfdb/sapt_punt&#39;</span><span class="p">,</span> <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>  <span class="c1"># pythonpath=None</span>
        <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;This is a stopgap function that loads sapt component data from</span>
<span class="sd">        sapt_punt in bfdb repo, then formats it to plot a ternary diagram.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">saptdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_saptdata_frombfdb</span><span class="p">(</span><span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="n">pythonpath</span><span class="p">,</span>
            <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">)</span>

        <span class="n">dbdat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mcs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dat</span> <span class="ow">in</span> <span class="n">saptdata</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">dbdat</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">dat</span><span class="p">[</span><span class="s1">&#39;elst&#39;</span><span class="p">],</span> <span class="n">dat</span><span class="p">[</span><span class="s1">&#39;ind&#39;</span><span class="p">],</span> <span class="n">dat</span><span class="p">[</span><span class="s1">&#39;disp&#39;</span><span class="p">]])</span>
            <span class="k">if</span> <span class="n">dat</span><span class="p">[</span><span class="s1">&#39;mc&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mcs</span><span class="p">:</span>
                <span class="n">mcs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="s1">&#39;mc&#39;</span><span class="p">])</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">sset</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mcs</span><span class="p">)])</span>

        <span class="c1"># generate matplotlib instructions and call or print</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mpl</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">pass</span>
            <span class="c1"># if not running from Canopy, print line to execute from Canopy</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if running from Canopy, call mpl directly</span>
            <span class="n">filedict</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">ternary</span><span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">labeled</span><span class="o">=</span><span class="n">labeled</span><span class="p">,</span>
                                   <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span>
                                   <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="n">graphicsformat</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">filedict</span></div>

<div class="viewcode-block" id="Database.plot_flat"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.plot_flat">[docs]</a>    <span class="k">def</span> <span class="nf">plot_flat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                  <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;sapt&#39;</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">xlines</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
                  <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Computes individual errors and summary statistics for single</span>
<span class="sd">        model chemistry *modelchem* versus *benchmark* over</span>
<span class="sd">        subset *sset* over all component databases. Thread *color* can be</span>
<span class="sd">        &#39;rgb&#39; for old coloring, a color name or &#39;sapt&#39; for spectrum coloring.</span>

<span class="sd">        *saveas* conveys directory (&#39;/&#39;) and/or filename for saving the</span>
<span class="sd">        resulting plot. File extension is not accessible, but *graphicsformat*</span>
<span class="sd">        array requests among &#39;png&#39;, &#39;pdf&#39;, and &#39;eps&#39; formats. *relpath*</span>
<span class="sd">        forces paths to saved files to be relative to current directory,</span>
<span class="sd">        rather than absolute paths for returned code and file dictionary.</span>

<span class="sd">        Prepares flat diagram instructions and either executes them if</span>
<span class="sd">        matplotlib available (Canopy or Anaconda) or prints them. Returns a</span>
<span class="sd">        dictionary of all saved plot filenames.</span>

<span class="sd">        asdf.plot_flat(&#39;CCSD-CP-atqzadz&#39;, failoninc=False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># compute errors</span>
        <span class="n">mc</span> <span class="o">=</span> <span class="n">modelchem</span>
        <span class="n">errors</span><span class="p">,</span> <span class="n">indiv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">,</span>
                                                <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="c1"># repackage</span>
        <span class="n">dbdat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">dbdat</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="n">db</span><span class="p">,</span>
                                  <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">),</span>
                                  <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">color</span><span class="p">,</span>
                                  <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">][</span><span class="n">rxn</span><span class="p">][</span><span class="mi">0</span><span class="p">]]})</span>
        <span class="n">pre</span><span class="p">,</span> <span class="n">suf</span><span class="p">,</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">string_contrast</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">sset</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">pre</span> <span class="o">+</span> <span class="s1">&#39;[]&#39;</span> <span class="o">+</span> <span class="n">suf</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># mape = 100 * errors[self.dbse][&#39;mape&#39;]</span>
        <span class="n">mapbe</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># generate matplotlib instructions and call or print</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mpl</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="c1"># if not running from Canopy, print line to execute from Canopy</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;filedict = mpl.flat(</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    color=&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="se">\n</span><span class="s2">    title=&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="se">\n</span><span class="s2">    mae=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    mape=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    xlimit=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    xlines=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    view=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    saveas=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    relpath=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    graphicsformat=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span>
                  <span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">mc</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="n">xlimit</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">xlines</span><span class="p">),</span> <span class="n">view</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">saveas</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">relpath</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">graphicsformat</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if running from Canopy, call mpl directly</span>
            <span class="n">filedict</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">flat</span><span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">mc</span><span class="p">,</span> <span class="n">mae</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="o">=</span><span class="n">mape</span><span class="p">,</span>
                                <span class="n">xlimit</span><span class="o">=</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">xlines</span><span class="o">=</span><span class="n">xlines</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span>
                                <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="n">graphicsformat</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">filedict</span></div>

<div class="viewcode-block" id="Database.write_xyz_files"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.write_xyz_files">[docs]</a>    <span class="k">def</span> <span class="nf">write_xyz_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Writes xyz files for every reagent in the Database to directory</span>
<span class="sd">        in *path* or to directory dbse_xyzfiles that it createsin cwd if</span>
<span class="sd">        *path* is None. Additionally, writes a script to that directory</span>
<span class="sd">        that will generate transparent-background ray-traced png files for</span>
<span class="sd">        every reagent with PyMol.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">xyzdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;_xyzfiles&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xyzdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">xyzdir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">xyzdir</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">rgt</span><span class="p">,</span> <span class="n">orgt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hrgt</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">omol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">orgt</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">omol</span><span class="o">.</span><span class="n">update_geometry</span><span class="p">()</span>
            <span class="n">omol</span><span class="o">.</span><span class="n">save_xyz</span><span class="p">(</span><span class="n">xyzdir</span> <span class="o">+</span> <span class="n">rgt</span> <span class="o">+</span> <span class="s1">&#39;.xyz&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">xyzdir</span> <span class="o">+</span> <span class="s1">&#39;pymol_xyz2png_script.pml&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
            <span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Launch PyMOL and run from its command line:</span>
<span class="s2"># PyMOL&gt; cd {}</span>
<span class="s2"># PyMOL&gt; @{}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xyzdir</span><span class="p">,</span> <span class="s1">&#39;pymol_xyz2png_script.pml&#39;</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">rgt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hrgt</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">load {xyzfile}</span>
<span class="s2">hide lines</span>
<span class="s2">show sticks</span>
<span class="s2">color grey, name c</span>
<span class="s2">cmd.set(&#39;&#39;&#39;opaque_background&#39;&#39;&#39;,&#39;&#39;&#39;0&#39;&#39;&#39;,quiet=0)</span>
<span class="s2">reset</span>
<span class="s2">orient</span>
<span class="s2">cmd.zoom(buffer=0.3, complete=1)</span>
<span class="s2">ray</span>
<span class="s2">png {pngfile}</span>
<span class="s2">reinitialize</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">xyzfile</span><span class="o">=</span><span class="n">xyzdir</span> <span class="o">+</span> <span class="n">rgt</span> <span class="o">+</span> <span class="s1">&#39;.xyz&#39;</span><span class="p">,</span>
                    <span class="n">pngfile</span><span class="o">=</span><span class="n">xyzdir</span> <span class="o">+</span> <span class="n">rgt</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">))</span></div>

<div class="viewcode-block" id="Database.plot_all_flats"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.plot_all_flats">[docs]</a>    <span class="k">def</span> <span class="nf">plot_all_flats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
                       <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Generate pieces for inclusion into tables. Supply list of</span>
<span class="sd">        modelchemistries to plot from *modelchem*, otherwise defaults to</span>
<span class="sd">        all those available. Can modify subset *sset* and plotting</span>
<span class="sd">        range *xlimit*.</span>

<span class="sd">        &gt;&gt;&gt; asdf.plot_all_flats(sset=&#39;tt-5min&#39;, xlimit=4.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mcs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">modelchem</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">modelchem</span>
        <span class="n">filedict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">mcs</span><span class="p">):</span>
            <span class="n">minifiledict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_flat</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                          <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span>
                                          <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="n">graphicsformat</span><span class="p">)</span>
            <span class="n">filedict</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="n">minifiledict</span>
        <span class="k">return</span> <span class="n">filedict</span></div>

<div class="viewcode-block" id="Database.get_hrxn"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.get_hrxn">[docs]</a>    <span class="k">def</span> <span class="nf">get_hrxn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rhrxn</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">dbix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
            <span class="n">lss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">sset</span><span class="p">][</span><span class="n">dbix</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">lss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">lss</span><span class="p">]:</span>
                        <span class="n">orxn</span> <span class="o">=</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span>
                        <span class="n">rhrxn</span><span class="p">[</span><span class="n">orxn</span><span class="o">.</span><span class="n">dbrxn</span><span class="p">]</span> <span class="o">=</span> <span class="n">orxn</span>  <span class="c1"># this is a change and conflict with vergil version</span>
        <span class="k">return</span> <span class="n">rhrxn</span></div>

<div class="viewcode-block" id="Database.get_hrgt"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.get_hrgt">[docs]</a>    <span class="k">def</span> <span class="nf">get_hrgt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">actv</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rhrxn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_hrxn</span><span class="p">(</span><span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">)</span>
        <span class="n">rhrgt</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">orxn</span> <span class="ow">in</span> <span class="n">rhrxn</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">orgt</span> <span class="ow">in</span> <span class="n">orxn</span><span class="o">.</span><span class="n">rxnm</span><span class="p">[</span><span class="n">actv</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">rhrgt</span><span class="p">[</span><span class="n">orgt</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">orgt</span>
        <span class="c1"># TODO prob need to avoid duplicates or pass</span>

        <span class="k">return</span> <span class="n">rhrgt</span></div>

<div class="viewcode-block" id="Database.get_reactions"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.get_reactions">[docs]</a>    <span class="k">def</span> <span class="nf">get_reactions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                      <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Collects the reactions present in *sset* from each WrappedDatabase,</span>
<span class="sd">        checks that *modelchem* and *benchmark* ReactionDatum are present</span>
<span class="sd">        (fails if *failoninc* True), then returns in an array a tuple for</span>
<span class="sd">        each reaction containing the modelchem key needed to access</span>
<span class="sd">        *modelchem*, the modelchem key needed to access *benchmark*, and</span>
<span class="sd">        the Reaction object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dbdat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rhrxn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_hrxn</span><span class="p">(</span><span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">orxn</span> <span class="ow">in</span> <span class="n">rhrxn</span><span class="o">.</span><span class="n">itervalues</span><span class="p">():</span>
            <span class="n">dbix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">orxn</span><span class="o">.</span><span class="n">dbrxn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">lmc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="n">modelchem</span><span class="p">][</span><span class="n">dbix</span><span class="p">]</span>
            <span class="n">lbm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="n">benchmark</span><span class="p">][</span><span class="n">dbix</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">orxn</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">lbm</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># not sure if should treat bm differently</span>
                <span class="n">lbm</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">orxn</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">lmc</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">failoninc</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">e</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lmc</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">dbdat</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">lmc</span><span class="p">,</span> <span class="n">lbm</span><span class="p">,</span> <span class="n">orxn</span><span class="p">))</span>
            <span class="c1"># this is diff in that returning empties not just pass over- may break bfdb</span>
            <span class="c1"># try:</span>
            <span class="c1">#     orxn.data[lmc]</span>
            <span class="c1">#     orxn.data[lbm]</span>
            <span class="c1"># except KeyError as e:</span>
            <span class="c1">#     if failoninc:</span>
            <span class="c1">#         raise e</span>
            <span class="c1">#     else:</span>
            <span class="c1">#         # not sure yet if should return empties or just pass over</span>
            <span class="c1">#         pass</span>
            <span class="c1"># else:</span>
            <span class="c1">#     dbdat.append((lmc, lbm, orxn))</span>
        <span class="k">return</span> <span class="n">dbdat</span></div>

<div class="viewcode-block" id="Database.get_missing_reactions"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.get_missing_reactions">[docs]</a>    <span class="k">def</span> <span class="nf">get_missing_reactions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary (keys self.dbse and all component</span>
<span class="sd">        WrappedDatabase.dbse) of two elements, the first being the number</span>
<span class="sd">        of reactions *sset* should contain and the second being a list of</span>
<span class="sd">        the reaction names (dbrxn) not available for *modelchem*. Absence</span>
<span class="sd">        of benchmark not considered.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">counts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[]]</span>
        <span class="n">soledb</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">soledb</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">counts</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[]]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">lmc</span><span class="p">,</span> <span class="n">lbm</span><span class="p">,</span> <span class="n">orxn</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reactions</span><span class="p">(</span><span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                                                   <span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">,</span> <span class="n">failoninc</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
            <span class="n">db</span><span class="p">,</span> <span class="n">rxn</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">dbrxn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">mcdatum</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">lmc</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="n">lmc</span> <span class="k">else</span> <span class="bp">None</span>
            <span class="n">counts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">soledb</span><span class="p">:</span>
                <span class="n">counts</span><span class="p">[</span><span class="n">db</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">mcdatum</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">counts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orxn</span><span class="o">.</span><span class="n">dbrxn</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">soledb</span><span class="p">:</span>
                    <span class="n">counts</span><span class="p">[</span><span class="n">db</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orxn</span><span class="o">.</span><span class="n">dbrxn</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">counts</span></div>

<div class="viewcode-block" id="Database.plot_disthist"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.plot_disthist">[docs]</a>    <span class="k">def</span> <span class="nf">plot_disthist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                      <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">xtitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                      <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Computes individual errors and summary statistics for single</span>
<span class="sd">        model chemistry *modelchem* versus *benchmark* over</span>
<span class="sd">        subset *sset* over all component databases. Computes histogram</span>
<span class="sd">        of errors and gaussian distribution.</span>

<span class="sd">        *saveas* conveys directory (&#39;/&#39;) and/or filename for saving the</span>
<span class="sd">        resulting plot. File extension is not accessible, but *graphicsformat*</span>
<span class="sd">        array requests among &#39;png&#39;, &#39;pdf&#39;, and &#39;eps&#39; formats. *relpath*</span>
<span class="sd">        forces paths to saved files to be relative to current directory,</span>
<span class="sd">        rather than absolute paths for returned code and file dictionary.</span>

<span class="sd">        Prepares disthist diagram instructions and either executes them if</span>
<span class="sd">        matplotlib available (Canopy or Anaconda) or prints them. Returns a</span>
<span class="sd">        dictionary of all saved plot filenames.</span>

<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># compute errors</span>
        <span class="n">mc</span> <span class="o">=</span> <span class="n">modelchem</span>
        <span class="n">errors</span><span class="p">,</span> <span class="n">indiv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">,</span>
                                                <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="c1"># repackage</span>
        <span class="n">dbdat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">dbdat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">][</span><span class="n">rxn</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span><span class="s2"> vs </span><span class="si">%s</span><span class="s2"> for </span><span class="si">%s</span><span class="s2"> subset </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">sset</span><span class="p">)</span>
        <span class="n">me</span> <span class="o">=</span> <span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;me&#39;</span><span class="p">]</span>
        <span class="n">stde</span> <span class="o">=</span> <span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;stde&#39;</span><span class="p">]</span>
        <span class="c1"># generate matplotlib instructions and call or print</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mpl</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="c1"># if not running from Canopy, print line to execute from Canopy</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;filedict = mpl.disthist(</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    title=&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="se">\n</span><span class="s2">    xtitle=&#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">    me=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    stde=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    saveas=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    relpath=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    graphicsformat=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span>
                  <span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xtitle</span><span class="p">,</span> <span class="n">me</span><span class="p">,</span> <span class="n">stde</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">saveas</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">relpath</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">graphicsformat</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if running from Canopy, call mpl directly</span>
            <span class="n">filedict</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">disthist</span><span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xtitle</span><span class="o">=</span><span class="n">xtitle</span><span class="p">,</span> <span class="n">me</span><span class="o">=</span><span class="n">me</span><span class="p">,</span> <span class="n">stde</span><span class="o">=</span><span class="n">stde</span><span class="p">,</span>
                                    <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span>
                                    <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="n">graphicsformat</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">filedict</span></div>

<div class="viewcode-block" id="Database.plot_modelchems"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.plot_modelchems">[docs]</a>    <span class="k">def</span> <span class="nf">plot_modelchems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">mbenchmark</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">msset</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;sapt&#39;</span><span class="p">,</span>
                        <span class="n">xlimit</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">labeled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                        <span class="n">mousetext</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mouselink</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mouseimag</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mousetitle</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mousediv</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Computes individual errors and summary statistics over all component</span>
<span class="sd">        databases for each model chemistry in array *modelchem* versus *benchmark*</span>
<span class="sd">        over subset *sset*. *mbenchmark* and *msset* are array options (same</span>
<span class="sd">        length as *modelchem*) that override *benchmark* and *sset*, respectively,</span>
<span class="sd">        for non-uniform specification. Thread *color* can be &#39;rgb&#39; for old</span>
<span class="sd">        coloring, a color name or &#39;sapt&#39; for spectrum coloring.</span>

<span class="sd">        *saveas* conveys directory (&#39;/&#39;) and/or filename for saving the</span>
<span class="sd">        resulting plot. File extension is not accessible, but *graphicsformat*</span>
<span class="sd">        array requests among &#39;png&#39;, &#39;pdf&#39;, and &#39;eps&#39; formats. *relpath*</span>
<span class="sd">        forces paths to saved files to be relative to current directory,</span>
<span class="sd">        rather than absolute paths for returned code and file dictionary.</span>

<span class="sd">        Prepares thread diagram instructions and either executes them if</span>
<span class="sd">        matplotlib available (Canopy or Anaconda) or prints them. Returns a</span>
<span class="sd">        dictionary of all saved plot filenames. If any of *mousetext*, *mouselink*,</span>
<span class="sd">        or *mouseimag* is specified, htmlcode will be returned with an image map of</span>
<span class="sd">        slats to any of text, link, or image, respectively.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># distribute benchmark</span>
        <span class="k">if</span> <span class="n">mbenchmark</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">lbenchmark</span> <span class="o">=</span> <span class="p">[</span><span class="n">benchmark</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">modelchem</span><span class="p">)</span>  <span class="c1"># normal bm modelchem name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mbenchmark</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">mbenchmark</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">modelchem</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                    <span class="sd">&quot;&quot;&quot;mbenchmark must be array of length distributable among modelchem&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mbenchmark</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lbenchmark</span> <span class="o">=</span> <span class="n">mbenchmark</span>  <span class="c1"># array of bm for each modelchem</span>
        <span class="c1"># distribute sset</span>
        <span class="k">if</span> <span class="n">msset</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">lsset</span> <span class="o">=</span> <span class="p">[</span><span class="n">sset</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">modelchem</span><span class="p">)</span>  <span class="c1"># normal ss name like &#39;MX&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">msset</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">msset</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">modelchem</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;msset must be array of length distributable among modelchem&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">msset</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lsset</span> <span class="o">=</span> <span class="n">msset</span>  <span class="c1"># array of ss for each modelchem</span>
        <span class="c1"># compute errors</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">indiv</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">mc</span><span class="p">,</span> <span class="n">bm</span><span class="p">,</span> <span class="n">ss</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">modelchem</span><span class="p">,</span> <span class="n">lbenchmark</span><span class="p">,</span> <span class="n">lsset</span><span class="p">):</span>
            <span class="n">ix</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">mc</span><span class="p">,</span> <span class="n">bm</span><span class="p">)</span>
            <span class="n">index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
            <span class="n">errors</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">indiv</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">bm</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span>
                                                            <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="c1"># repackage</span>
        <span class="n">dbdat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">odb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">dbix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">indiv</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="n">db</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">odb</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">lsset</span><span class="p">[</span><span class="n">index</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ix</span><span class="p">)]][</span><span class="n">dbix</span><span class="p">]]:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indiv</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="n">db</span><span class="p">][</span><span class="n">rxn</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">failoninc</span><span class="p">:</span>
                                    <span class="k">raise</span> <span class="n">e</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span> <span class="ow">or</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">):</span>
                    <span class="k">pass</span>  <span class="c1"># filter out empty reactions</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dbdat</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="n">db</span><span class="p">,</span>
                                  <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">),</span>
                                  <span class="s1">&#39;show&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">),</span>
                                  <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">odb</span><span class="o">.</span><span class="n">hrxn</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span><span class="o">.</span><span class="n">color</span><span class="p">,</span>
                                  <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="p">[</span><span class="n">errors</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">index</span><span class="p">]</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span> <span class="o">*</span> <span class="n">errors</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">index</span><span class="p">]</span>
        <span class="c1"># form unique filename</span>
        <span class="n">ixpre</span><span class="p">,</span> <span class="n">ixsuf</span><span class="p">,</span> <span class="n">ixmid</span> <span class="o">=</span> <span class="n">string_contrast</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">ixpre</span> <span class="o">+</span> <span class="s1">&#39;[]&#39;</span> <span class="o">+</span> <span class="n">ixsuf</span>
        <span class="c1"># generate matplotlib instructions and call or print</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mpl</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="c1"># if not running from Canopy, print line to execute from Canopy</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;filedict, htmlcode = mpl.threads(</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    color=&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="se">\n</span><span class="s2">    title=&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="se">\n</span><span class="s2">    labels=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    mae=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    mape=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    xlimit=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    labeled=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    saveas=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    mousetext=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    mouselink=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    mouseimag=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    mousetitle=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    mousediv=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    relpath=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    graphicsformat=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span>
                  <span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">ixmid</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">xlimit</span><span class="p">),</span>
                  <span class="nb">repr</span><span class="p">(</span><span class="n">labeled</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">saveas</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">mousetext</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">mouselink</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">mouseimag</span><span class="p">),</span>
                  <span class="nb">repr</span><span class="p">(</span><span class="n">mousetitle</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">mousediv</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">relpath</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">graphicsformat</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if running from Canopy, call mpl directly</span>
            <span class="n">filedict</span><span class="p">,</span> <span class="n">htmlcode</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">threads</span><span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">ixmid</span><span class="p">,</span> <span class="n">mae</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="o">=</span><span class="n">mape</span><span class="p">,</span>
                                             <span class="n">xlimit</span><span class="o">=</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">labeled</span><span class="o">=</span><span class="n">labeled</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span>
                                             <span class="n">mousetext</span><span class="o">=</span><span class="n">mousetext</span><span class="p">,</span> <span class="n">mouselink</span><span class="o">=</span><span class="n">mouselink</span><span class="p">,</span>
                                             <span class="n">mouseimag</span><span class="o">=</span><span class="n">mouseimag</span><span class="p">,</span> <span class="n">mousetitle</span><span class="o">=</span><span class="n">mousetitle</span><span class="p">,</span> <span class="n">mousediv</span><span class="o">=</span><span class="n">mousediv</span><span class="p">,</span>
                                             <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="n">graphicsformat</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">filedict</span><span class="p">,</span> <span class="n">htmlcode</span></div>

<div class="viewcode-block" id="Database.plot_liliowa"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.plot_liliowa">[docs]</a>    <span class="k">def</span> <span class="nf">plot_liliowa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                     <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                     <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Note that not possible to access sset of component databases. That is, for Database SSIBBI, SSI-only arylaryl is accessible b/c not defined in BBI, but SSI-only neutral is not accessible.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># compute errors</span>
        <span class="n">mc</span> <span class="o">=</span> <span class="n">modelchem</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">errors</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span>
                                                 <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="c1"># repackage</span>
        <span class="n">dbdat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ssarray</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pospos&#39;</span><span class="p">,</span> <span class="s1">&#39;posneg&#39;</span><span class="p">,</span> <span class="s1">&#39;pospolar&#39;</span><span class="p">,</span> <span class="s1">&#39;posaliph&#39;</span><span class="p">,</span> <span class="s1">&#39;posaryl&#39;</span><span class="p">,</span>
                   <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;negneg&#39;</span><span class="p">,</span> <span class="s1">&#39;negpolar&#39;</span><span class="p">,</span> <span class="s1">&#39;negaliph&#39;</span><span class="p">,</span> <span class="s1">&#39;negaryl&#39;</span><span class="p">,</span>
                   <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;polarpolar&#39;</span><span class="p">,</span> <span class="s1">&#39;polaraliph&#39;</span><span class="p">,</span> <span class="s1">&#39;polararyl&#39;</span><span class="p">,</span>
                   <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;aliphaliph&#39;</span><span class="p">,</span> <span class="s1">&#39;alipharyl&#39;</span><span class="p">,</span>
                   <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;arylaryl&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">ssarray</span><span class="p">:</span>
            <span class="n">dbdat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="n">ss</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">errors</span><span class="p">[</span><span class="n">ss</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;mae&#39;</span><span class="p">])</span>

        <span class="c1"># generate matplotlib instructions and call or print</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mpl</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Matplotlib not avail&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filedict</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">liliowa</span><span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span>
                                <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="n">graphicsformat</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">filedict</span></div>

<div class="viewcode-block" id="Database.plot_iowa"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.plot_iowa">[docs]</a>    <span class="k">def</span> <span class="nf">plot_iowa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                  <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xtitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
                  <span class="n">view</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">saveas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Computes individual errors for single *modelchem* versus</span>
<span class="sd">        *benchmark* over subset *sset*. Coloring green-to-purple with</span>
<span class="sd">        maximum intensity at *xlimit*. Prepares Iowa plot instructions and</span>
<span class="sd">        either executes them if matplotlib available (Canopy) or prints them.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">modelchem</span>
        <span class="c1"># compute errors</span>
        <span class="n">mc</span> <span class="o">=</span> <span class="n">modelchem</span>
        <span class="n">errors</span><span class="p">,</span> <span class="n">indiv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">,</span>
                                                <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="c1"># repackage</span>
        <span class="n">dbdat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dblbl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">dbdat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indiv</span><span class="p">[</span><span class="n">db</span><span class="p">][</span><span class="n">rxn</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">dblbl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">))</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span><span class="s2"> vs </span><span class="si">%s</span><span class="s2"> for </span><span class="si">%s</span><span class="s2"> subset </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">sset</span><span class="p">)</span>
        <span class="n">me</span> <span class="o">=</span> <span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;me&#39;</span><span class="p">]</span>
        <span class="c1"># generate matplotlib instructions and call or print</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mpl</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="c1"># if not running from Canopy, print line to execute from Canopy</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;mpl.iowa(</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    </span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    title=&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="se">\n</span><span class="s2">    xtitle=&#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">    xlimit=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    saveas=</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">    relpath=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    graphicsformat=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span>
                  <span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">dblbl</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xtitle</span><span class="p">,</span> <span class="n">xlimit</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">saveas</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">relpath</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">graphicsformat</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if running from Canopy, call mpl directly</span>
            <span class="n">filedict</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">iowa</span><span class="p">(</span><span class="n">dbdat</span><span class="p">,</span> <span class="n">dblbl</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xtitle</span><span class="o">=</span><span class="n">xtitle</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="n">xlimit</span><span class="p">,</span>
                                <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">,</span>
                                <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span> <span class="n">relpath</span><span class="o">=</span><span class="n">relpath</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="n">graphicsformat</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">filedict</span></div>

<div class="viewcode-block" id="Database.export_pandas"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.export_pandas">[docs]</a>    <span class="k">def</span> <span class="nf">export_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="o">=</span><span class="p">[],</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">modelchemlabels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                      <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *modelchem* is array of model chemistries, if modelchem is empty, get only benchmark</span>
<span class="sd">        is benchmark needed?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ACONF&#39;</span><span class="p">,</span> <span class="s1">&#39;SCONF&#39;</span><span class="p">,</span> <span class="s1">&#39;PCONF&#39;</span><span class="p">,</span> <span class="s1">&#39;CYCONF&#39;</span><span class="p">]:</span>
            <span class="n">saptdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_saptdata_frombfdb</span><span class="p">(</span><span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="s1">&#39;/Users/loriab/linux/bfdb/sapt_punt&#39;</span><span class="p">,</span>
                <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">)</span>

        <span class="n">listodicts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rhrxn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_hrxn</span><span class="p">(</span><span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dbrxn</span><span class="p">,</span> <span class="n">orxn</span> <span class="ow">in</span> <span class="n">rhrxn</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">wdb</span> <span class="o">=</span> <span class="n">dbrxn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">dbix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">wdb</span><span class="p">)</span>
            <span class="n">wbm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="n">benchmark</span><span class="p">][</span><span class="n">dbix</span><span class="p">]</span>
            <span class="n">wss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="n">sset</span><span class="p">][</span><span class="n">dbix</span><span class="p">]</span>
            <span class="n">woss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="p">[</span><span class="n">wdb</span><span class="p">]</span><span class="o">.</span><span class="n">oss</span><span class="p">[</span><span class="n">wss</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">Rrat</span> <span class="o">=</span> <span class="n">woss</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="s1">&#39;Rrat&#39;</span><span class="p">][</span><span class="n">woss</span><span class="o">.</span><span class="n">hrxn</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">orxn</span><span class="o">.</span><span class="n">name</span><span class="p">)]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">Rrat</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># TODO generic soln?</span>

            <span class="n">dictorxn</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;DB&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wdb</span>
            <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;System&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">tagl</span>
            <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">name</span>
            <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rrat</span>
            <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;System #&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">indx</span>
            <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;Benchmark&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span> <span class="k">if</span> <span class="n">orxn</span><span class="o">.</span><span class="n">benchmark</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">orxn</span><span class="o">.</span><span class="n">data</span><span class="p">[</span>
                <span class="n">wbm</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># this NaN exception is new and experimental</span>
            <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;QcdbSys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">dbrxn</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ACONF&#39;</span><span class="p">,</span> <span class="s1">&#39;SCONF&#39;</span><span class="p">,</span> <span class="s1">&#39;PCONF&#39;</span><span class="p">,</span> <span class="s1">&#39;CYCONF&#39;</span><span class="p">]:</span>
                <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;SAPT ELST ENERGY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">saptdata</span><span class="p">[</span><span class="n">dbrxn</span><span class="p">][</span><span class="s1">&#39;elst&#39;</span><span class="p">]</span>
                <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;SAPT EXCH ENERGY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">saptdata</span><span class="p">[</span><span class="n">dbrxn</span><span class="p">][</span><span class="s1">&#39;exch&#39;</span><span class="p">]</span>
                <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;SAPT IND ENERGY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">saptdata</span><span class="p">[</span><span class="n">dbrxn</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">]</span>
                <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;SAPT DISP ENERGY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">saptdata</span><span class="p">[</span><span class="n">dbrxn</span><span class="p">][</span><span class="s1">&#39;disp&#39;</span><span class="p">]</span>
                <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;SAPT TOTAL ENERGY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;SAPT ELST ENERGY&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;SAPT EXCH ENERGY&#39;</span><span class="p">]</span> <span class="o">+</span> \
                                                <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;SAPT IND ENERGY&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;SAPT DISP ENERGY&#39;</span><span class="p">]</span>

            <span class="n">orgts</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">rxnm</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="n">omolD</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">orgts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span>  <span class="c1"># TODO this is only going to work with Reaction ~= Reagent databases</span>
            <span class="n">npmolD</span> <span class="o">=</span> <span class="n">omolD</span><span class="o">.</span><span class="n">format_molecule_for_numpy</span><span class="p">()</span>
            <span class="n">omolA</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">orgts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span>  <span class="c1"># TODO this is only going to work with Reaction ~= Reagent databases</span>
            <span class="n">omolA</span><span class="o">.</span><span class="n">update_geometry</span><span class="p">()</span>
            <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;MonA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">omolA</span><span class="o">.</span><span class="n">natom</span><span class="p">()</span>

            <span class="c1"># this whole member fn not well defined for db of varying stoichiometry</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbse</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ACONF&#39;</span><span class="p">,</span> <span class="s1">&#39;SCONF&#39;</span><span class="p">,</span> <span class="s1">&#39;PCONF&#39;</span><span class="p">,</span> <span class="s1">&#39;CYCONF&#39;</span><span class="p">]:</span>
                <span class="n">npmolD</span> <span class="o">=</span> <span class="n">omolD</span><span class="o">.</span><span class="n">format_molecule_for_numpy</span><span class="p">()</span>
                <span class="n">npmolA</span> <span class="o">=</span> <span class="n">omolA</span><span class="o">.</span><span class="n">format_molecule_for_numpy</span><span class="p">()</span>
                <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;Geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">npmolD</span><span class="p">,</span> <span class="n">npmolA</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dictorxn</span><span class="p">[</span><span class="s1">&#39;Geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">omolD</span><span class="o">.</span><span class="n">format_molecule_for_numpy</span><span class="p">()</span>
            <span class="c1"># print &#39;\nD&#39;, npmolD.shape[0], npmolA.shape[0], dictorxn[&#39;MonA&#39;], npmolD, npmolA, dictorxn[&#39;Geometry&#39;]</span>

            <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">modelchem</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">wmc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">dbix</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="c1"># modelchem not in Database at all</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="s1">&#39;not found&#39;</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">mc</span> <span class="k">if</span> <span class="n">modelchemlabels</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">modelchemlabels</span><span class="p">[</span><span class="n">modelchem</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">mc</span><span class="p">)]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">dictorxn</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">wmc</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="c1"># reaction not in modelchem</span>
                    <span class="k">if</span> <span class="n">failoninc</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Reaction </span><span class="si">%s</span><span class="s2"> missing datum </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s1">&#39;not found&#39;</span><span class="p">)</span>
                        <span class="k">continue</span>
            <span class="n">listodicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dictorxn</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">listodicts</span><span class="p">)</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="Database.table_reactions"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.table_reactions">[docs]</a>    <span class="k">def</span> <span class="nf">table_reactions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelchem</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                        <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                        <span class="n">columnplan</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;indx&#39;</span><span class="p">,</span> <span class="s1">&#39;tagl&#39;</span><span class="p">,</span> <span class="s1">&#39;bm&#39;</span><span class="p">,</span> <span class="s1">&#39;mc&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;pe&#39;</span><span class="p">],</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Reaction energies [kcal/mol] for {sset} $\subset$ {dbse} with {mc}&quot;&quot;&quot;</span><span class="p">,</span>
                        <span class="n">indextitle</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Detailed results for {sset} $\subset$ {dbse} with {mc}&quot;&quot;&quot;</span><span class="p">,</span>
                        <span class="n">plotpath</span><span class="o">=</span><span class="s1">&#39;analysis/mols/&#39;</span><span class="p">,</span>
                        <span class="n">standalone</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s1">&#39;rxns&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;Prepare single LaTeX table to *filename* or return lines if None showing</span>
<span class="sd">        the per-reaction results for reactions in *sset* for single or array</span>
<span class="sd">        or &#39;all&#39; *modelchem*, where the last uses self.mcs(), model chemistries</span>
<span class="sd">        versus *benchmark*. Use *failoninc* to toggle between command failing</span>
<span class="sd">        or blank lines in table. Use *standalone* to toggle between full</span>
<span class="sd">        compilable document and suitable for inclusion in another LaTeX document.</span>
<span class="sd">        Use *columnplan* to customize column (from among columnreservoir, below)</span>
<span class="sd">        layout. Use *title* and *indextitle* to customize table caption and</span>
<span class="sd">        table-of-contents caption, respectively; variables in curly braces will</span>
<span class="sd">        be substituted. Use *theme* to customize the \ref{tbl:} code.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># define eligible columns for inclusion</span>
        <span class="n">columnreservoir</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;dbrxn&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;\textbf{Reaction}&quot;&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;{0:25s}&quot;&quot;&quot;</span><span class="p">],</span>
            <span class="s1">&#39;indx&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;{0:14s}&quot;&quot;&quot;</span><span class="p">],</span>
            <span class="s1">&#39;tagl&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;\textbf{Reaction}&quot;&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;{0:50s}&quot;&quot;&quot;</span><span class="p">],</span>
            <span class="s1">&#39;bm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;\multicolumn{1}{c}{\textbf{Benchmark}}&quot;&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;{0:8.2f}&quot;&quot;&quot;</span><span class="p">],</span>
            <span class="s1">&#39;mc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;\multicolumn{1}{c}{\textbf{ModelChem}}&quot;&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;{0:8.2f}&quot;&quot;&quot;</span><span class="p">],</span>
            <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;\multicolumn{1}{c}{\textbf{Error}}&quot;&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;{0:8.2f}&quot;&quot;&quot;</span><span class="p">],</span>
            <span class="s1">&#39;pe&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;\multicolumn{1}{c}{\textbf{\</span><span class="si">% E</span><span class="s2">rr.}}&quot;&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;{0:8.1f}&quot;&quot;&quot;</span><span class="p">],</span>
            <span class="s1">&#39;imag&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;\includegraphics[width=1.0cm,height=3.5mm]{</span><span class="si">%s%%</span><span class="s2">ss.png}&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotpath</span><span class="p">)],</span>  <span class="c1"># untested</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnplan</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columnreservoir</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Column {0} not recognized. Register with columnreservoir.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelchem</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">modelchem</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
                <span class="n">mcs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">modelchem</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mcs</span> <span class="o">=</span> <span class="n">modelchem</span>

        <span class="c1"># commence to generate LaTeX code</span>
        <span class="n">tablelines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">indexlines</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">standalone</span><span class="p">:</span>
            <span class="n">tablelines</span> <span class="o">+=</span> <span class="n">textables</span><span class="o">.</span><span class="n">begin_latex_document</span><span class="p">()</span>

        <span class="c1"># iterate to produce one LaTeX table per modelchem</span>
        <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">mcs</span><span class="p">:</span>
            <span class="c1"># prepare summary statistics</span>
            <span class="n">perr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">,</span>
                                           <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                           <span class="n">returnindiv</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">serrors</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">serrors</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">perr</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">format_errors</span><span class="p">(</span><span class="n">perr</span><span class="p">[</span><span class="n">db</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">serrors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_errors</span><span class="p">(</span><span class="n">perr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

            <span class="c1"># prepare individual reactions and errors</span>
            <span class="n">terrors</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">isComplete</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">lmc</span><span class="p">,</span> <span class="n">lbm</span><span class="p">,</span> <span class="n">orxn</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reactions</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span>
                                                       <span class="n">sset</span><span class="o">=</span><span class="n">sset</span><span class="p">,</span> <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">):</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">dbrxn</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">dbrxn</span>
                <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;dbrxn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dbrxn</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">_&#39;</span><span class="p">)</span>
                <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;indx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;\textit{&quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">orxn</span><span class="o">.</span><span class="n">indx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;}&quot;&quot;&quot;</span>
                <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;tagl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dbrxn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> \
                              <span class="p">(</span><span class="n">orxn</span><span class="o">.</span><span class="n">latex</span> <span class="k">if</span> <span class="n">orxn</span><span class="o">.</span><span class="n">latex</span> <span class="k">else</span> <span class="n">orxn</span><span class="o">.</span><span class="n">tagl</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">_&#39;</span><span class="p">))</span>
                <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;imag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># name of primary rgt</span>
                <span class="n">bmdatum</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">lbm</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="n">lbm</span> <span class="k">else</span> <span class="bp">None</span>
                <span class="n">mcdatum</span> <span class="o">=</span> <span class="n">orxn</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">lmc</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="n">lmc</span> <span class="k">else</span> <span class="bp">None</span>
                <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;bm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bmdatum</span>
                <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;mc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcdatum</span>
                <span class="k">if</span> <span class="n">lmc</span> <span class="ow">and</span> <span class="n">lbm</span><span class="p">:</span>
                    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcdatum</span> <span class="o">-</span> <span class="n">bmdatum</span>
                    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;pe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">mcdatum</span> <span class="o">-</span> <span class="n">bmdatum</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">bmdatum</span><span class="p">)</span>
                    <span class="c1"># TODO redefining errors not good practice</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">isComplete</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
                    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;pe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

                <span class="n">terrors</span><span class="p">[</span><span class="n">dbrxn</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columnreservoir</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">terrors</span><span class="p">[</span><span class="n">dbrxn</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">tmp</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> \
                        <span class="n">columnreservoir</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>

            <span class="n">fancymodelchem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fancy_mcs</span><span class="p">(</span><span class="n">latex</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="n">mc</span><span class="p">]</span>
            <span class="n">thistitle</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dbse</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">mc</span><span class="o">=</span><span class="n">fancymodelchem</span><span class="p">,</span>
                                     <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;All&#39;</span> <span class="k">if</span> <span class="n">sset</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span> <span class="k">else</span> <span class="n">sset</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
            <span class="n">lref</span> <span class="o">=</span> <span class="p">[</span><span class="s2">r&quot;&quot;&quot;tbl:qcdb&quot;&quot;&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">theme</span><span class="p">:</span>
                <span class="n">lref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theme</span><span class="p">)</span>
            <span class="n">lref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sset</span> <span class="o">!=</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                <span class="n">lref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sset</span><span class="p">)</span>
            <span class="n">lref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lref</span><span class="p">)</span>

            <span class="c1"># table intro</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\begingroup&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\squeezetable&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\LTcapwidth=\textwidth&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\begin{longtable}{</span><span class="si">%s</span><span class="s2">}&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">columnreservoir</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnplan</span><span class="p">])))</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\caption{</span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">thistitle</span><span class="p">))</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\label{</span><span class="si">%s</span><span class="s2">}} \\ &quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ref</span><span class="p">))</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\hline\hline&quot;&quot;&quot;</span><span class="p">)</span>

            <span class="n">columntitles</span> <span class="o">=</span> <span class="p">[</span><span class="n">columnreservoir</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnplan</span><span class="p">]</span>
            <span class="c1"># initial header</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">columntitles</span><span class="p">)</span> <span class="o">+</span> <span class="s2">r&quot;&quot;&quot; \\ &quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\hline&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\endfirsthead&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="c1"># to be continued header</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\multicolumn{</span><span class="si">%d</span><span class="s2">}{@{}l}{\textit{\ldots continued} </span><span class="si">%s</span><span class="s2">} \\ &quot;&quot;&quot;</span> <span class="o">%</span>
                              <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">columnplan</span><span class="p">),</span> <span class="n">fancymodelchem</span><span class="p">))</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\hline\hline&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">columntitles</span><span class="p">)</span> <span class="o">+</span> <span class="s2">r&quot;&quot;&quot; \\ &quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\hline&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\endhead&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="c1"># to be continued footer</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\hline\hline&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\multicolumn{</span><span class="si">%d</span><span class="s2">}{r@{}}{\textit{continued \ldots}} \\ &quot;&quot;&quot;</span> <span class="o">%</span>
                              <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">columnplan</span><span class="p">)))</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\endfoot&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="c1"># final footer</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\hline\hline&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\endlastfoot&quot;&quot;&quot;</span><span class="p">)</span>

            <span class="c1"># table body</span>
            <span class="k">for</span> <span class="n">dbrxn</span><span class="p">,</span> <span class="n">stuff</span> <span class="ow">in</span> <span class="n">terrors</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">stuff</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnplan</span><span class="p">])</span> <span class="o">+</span> <span class="s2">r&quot;&quot;&quot; \\ &quot;&quot;&quot;</span><span class="p">)</span>

            <span class="c1"># table body summary</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;pe&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnplan</span><span class="p">):</span>
                <span class="n">field_to_put_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;tagl&#39;</span><span class="p">,</span> <span class="s1">&#39;dbrxn&#39;</span><span class="p">,</span> <span class="s1">&#39;indx&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnplan</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">field_to_put_labels</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">block</span><span class="p">,</span> <span class="n">blkerrors</span> <span class="ow">in</span> <span class="n">serrors</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">blkerrors</span><span class="p">:</span>  <span class="c1"># skip e.g., NBC block in HB of DB4</span>
                            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\hline&quot;&quot;&quot;</span><span class="p">)</span>
                            <span class="n">summlines</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)]</span>
                            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnplan</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="n">field_to_put_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="sd">r&quot;&quot;&quot;\textbf{Summary Statistics: %s%s}%s&quot;&quot;&quot;</span> <span class="o">%</span> \
                                        <span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">sset</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span> <span class="k">else</span> <span class="n">sset</span> <span class="o">+</span> <span class="s2">r&quot;&quot;&quot; $\subset$ &quot;&quot;&quot;</span><span class="p">,</span>
                                         <span class="n">block</span><span class="p">,</span>
                                         <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">isComplete</span> <span class="k">else</span> <span class="s2">r&quot;&quot;&quot;, \textit{partial}&quot;&quot;&quot;</span><span class="p">))</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\textit{Minimal Signed Error}   &quot;&quot;&quot;</span><span class="p">)</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\textit{Minimal Absolute Error} &quot;&quot;&quot;</span><span class="p">)</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\textit{Maximal Signed Error}   &quot;&quot;&quot;</span><span class="p">)</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\textit{Maximal Absolute Error} &quot;&quot;&quot;</span><span class="p">)</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\textit{Mean Signed Error}      &quot;&quot;&quot;</span><span class="p">)</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\textit{Mean Absolute Error}    &quot;&quot;&quot;</span><span class="p">)</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\textit{Root-Mean-Square Error} &quot;&quot;&quot;</span><span class="p">)</span>
                                <span class="k">elif</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;pe&#39;</span><span class="p">]:</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkerrors</span><span class="p">[</span><span class="s1">&#39;nex&#39;</span> <span class="o">+</span> <span class="n">col</span><span class="p">])</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkerrors</span><span class="p">[</span><span class="s1">&#39;min&#39;</span> <span class="o">+</span> <span class="n">col</span><span class="p">])</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkerrors</span><span class="p">[</span><span class="s1">&#39;pex&#39;</span> <span class="o">+</span> <span class="n">col</span><span class="p">])</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkerrors</span><span class="p">[</span><span class="s1">&#39;max&#39;</span> <span class="o">+</span> <span class="n">col</span><span class="p">])</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkerrors</span><span class="p">[</span><span class="s1">&#39;m&#39;</span> <span class="o">+</span> <span class="n">col</span><span class="p">])</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkerrors</span><span class="p">[</span><span class="s1">&#39;ma&#39;</span> <span class="o">+</span> <span class="n">col</span><span class="p">])</span>
                                    <span class="n">summlines</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkerrors</span><span class="p">[</span><span class="s1">&#39;rms&#39;</span> <span class="o">+</span> <span class="n">col</span><span class="p">])</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">summlines</span><span class="p">)):</span>
                                        <span class="n">summlines</span><span class="p">[</span><span class="n">ln</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">summlines</span><span class="p">)):</span>
                                <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">summlines</span><span class="p">[</span><span class="n">ln</span><span class="p">])</span> <span class="o">+</span> <span class="s2">r&quot;&quot;&quot; \\ &quot;&quot;&quot;</span><span class="p">)</span>

            <span class="c1"># table conclusion</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\end{longtable}&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\endgroup&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\clearpage&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># form table index</span>
            <span class="n">thisindextitle</span> <span class="o">=</span> <span class="n">indextitle</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dbse</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">mc</span><span class="o">=</span><span class="n">fancymodelchem</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
                                               <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;All&#39;</span> <span class="k">if</span> <span class="n">sset</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span> <span class="k">else</span> <span class="n">sset</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
            <span class="n">indexlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">r&quot;&quot;&quot;\scriptsize \ref{</span><span class="si">%s</span><span class="s2">} &amp; \scriptsize </span><span class="si">%s</span><span class="s2"> \\ &quot;&quot;&quot;</span> <span class="o">%</span> \
                              <span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">thisindextitle</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">standalone</span><span class="p">:</span>
            <span class="n">tablelines</span> <span class="o">+=</span> <span class="n">textables</span><span class="o">.</span><span class="n">end_latex_document</span><span class="p">()</span>

        <span class="c1"># form table and index return structures</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tablelines</span><span class="p">,</span> <span class="n">indexlines</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.tex&#39;</span><span class="p">):</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
                <span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tablelines</span><span class="p">))</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_index.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
                <span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">indexlines</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">  LaTeX index written to {filename}_index.tex</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
                  <span class="sd">&quot;&quot;&quot;  LaTeX table written to {filename}.tex\n&quot;&quot;&quot;</span>
                  <span class="sd">&quot;&quot;&quot;  &gt;&gt;&gt; pdflatex {filename}\n&quot;&quot;&quot;</span>
                  <span class="sd">&quot;&quot;&quot;  &gt;&gt;&gt; open /Applications/Preview.app {filename}.pdf\n&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">))</span>
            <span class="n">filedict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.tex&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_index.tex&#39;</span><span class="p">)}</span>
            <span class="k">return</span> <span class="n">filedict</span></div>

<div class="viewcode-block" id="Database.table_wrapper"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.table_wrapper">[docs]</a>    <span class="k">def</span> <span class="nf">table_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mtd</span><span class="p">,</span> <span class="n">bas</span><span class="p">,</span> <span class="n">tableplan</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
                      <span class="n">opt</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CP&#39;</span><span class="p">],</span> <span class="n">err</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">],</span> <span class="n">sset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">dbse</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                      <span class="n">opttarget</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                      <span class="n">failoninc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                      <span class="n">xlimit</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">xlines</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
                      <span class="n">ialimit</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
                      <span class="n">plotpath</span><span class="o">=</span><span class="s1">&#39;autogen&#39;</span><span class="p">,</span>
                      <span class="n">subjoin</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                      <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">indextitle</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                      <span class="n">suppressblanks</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                      <span class="n">standalone</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prepares dictionary of errors for all combinations of *mtd*, *opt*,</span>
<span class="sd">        *bas* with respect to model chemistry *benchmark*, mindful of *failoninc*.</span>
<span class="sd">        The general plan for the table, as well as defaults for landscape,</span>
<span class="sd">        footnotes, *title*, *indextitle, and *theme* are got from function</span>
<span class="sd">        *tableplan*. Once error dictionary is ready, it and all other arguments</span>
<span class="sd">        are passed along to textables.table_generic. Two arrays, one of table</span>
<span class="sd">        lines and one of index lines are returned unless *filename* is given,</span>
<span class="sd">        in which case they&#39;re written to file and a filedict returned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get plan for table from *tableplan* and some default values</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;plotpath&#39;</span><span class="p">:</span> <span class="n">plotpath</span><span class="p">,</span>
                  <span class="s1">&#39;subjoin&#39;</span><span class="p">:</span> <span class="n">subjoin</span><span class="p">,</span>
                  <span class="s1">&#39;xlines&#39;</span><span class="p">:</span> <span class="n">xlines</span><span class="p">,</span>
                  <span class="s1">&#39;xlimit&#39;</span><span class="p">:</span> <span class="n">xlimit</span><span class="p">,</span>
                  <span class="s1">&#39;ialimit&#39;</span><span class="p">:</span> <span class="n">ialimit</span><span class="p">}</span>
        <span class="n">rowplan</span><span class="p">,</span> <span class="n">columnplan</span><span class="p">,</span> <span class="n">landscape</span><span class="p">,</span> <span class="n">footnotes</span><span class="p">,</span> \
        <span class="n">suggestedtitle</span><span class="p">,</span> <span class="n">suggestedtheme</span> <span class="o">=</span> <span class="n">tableplan</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1">#suggestedtitle, suggestedtheme = tableplan(plotpath=plotpath, subjoin=subjoin)</span>

        <span class="c1"># make figure files write themselves</span>
        <span class="n">autothread</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">autoliliowa</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">plotpath</span> <span class="o">==</span> <span class="s1">&#39;autogen&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnplan</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;flat&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">col</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">and</span> <span class="n">autothread</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;TODO: merge not handled&#39;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">col</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">or</span> <span class="n">autothread</span><span class="p">:</span>
                        <span class="n">autothread</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">autothread</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dummy&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
                <span class="k">elif</span> <span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;liliowa&#39;</span><span class="p">:</span>
                    <span class="n">autoliliowa</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dummy&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

        <span class="c1"># negotiate some defaults</span>
        <span class="n">dbse</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">]</span> <span class="k">if</span> <span class="n">dbse</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">dbse</span>
        <span class="n">theme</span> <span class="o">=</span> <span class="n">suggestedtheme</span> <span class="k">if</span> <span class="n">theme</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">theme</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">suggestedtitle</span> <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">title</span>
        <span class="n">indextitle</span> <span class="o">=</span> <span class="n">title</span> <span class="k">if</span> <span class="n">indextitle</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">indextitle</span>
        <span class="n">opttarget</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]}</span> <span class="k">if</span> <span class="n">opttarget</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">opttarget</span>

        <span class="k">def</span> <span class="nf">unify_options</span><span class="p">(</span><span class="n">orequired</span><span class="p">,</span> <span class="n">opossible</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Perform a merge of options tags in *orequired* and *opossible* so</span>
<span class="sd">            that the result is free of duplication and has the mode at the end.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">opt_combos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">oreq</span> <span class="ow">in</span> <span class="n">orequired</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">opos</span> <span class="ow">in</span> <span class="n">opossible</span><span class="p">:</span>
                    <span class="n">pieces</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">oreq</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">opos</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)))</span>
                    <span class="k">if</span> <span class="s1">&#39;&#39;</span> <span class="ow">in</span> <span class="n">pieces</span><span class="p">:</span>
                        <span class="n">pieces</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CP&#39;</span><span class="p">,</span> <span class="s1">&#39;unCP&#39;</span><span class="p">,</span> <span class="s1">&#39;SA&#39;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">mode</span> <span class="ow">in</span> <span class="n">pieces</span><span class="p">:</span>
                            <span class="n">pieces</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
                            <span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
                    <span class="n">pieces</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
                    <span class="n">opt_combos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">opt_combos</span>

        <span class="c1"># gather list of model chemistries for table</span>
        <span class="n">mcs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prod</span><span class="p">)</span> <span class="k">for</span> <span class="n">prod</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">mtd</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">bas</span><span class="p">)]</span>
        <span class="n">mc_translator</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">mtd</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">bas</span><span class="p">):</span>
            <span class="n">nominal_mc</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">m</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">oo</span> <span class="ow">in</span> <span class="n">unify_options</span><span class="p">([</span><span class="n">o</span><span class="p">],</span> <span class="n">opttarget</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]):</span>
                <span class="n">trial_mc</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">m</span><span class="p">,</span> <span class="n">oo</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">perr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="n">trial_mc</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>  <span class="c1"># prob. too restrictive by choosing subset</span>
                                                   <span class="n">failoninc</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">mc_translator</span><span class="p">[</span><span class="n">nominal_mc</span><span class="p">]</span> <span class="o">=</span> <span class="n">trial_mc</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mc_translator</span><span class="p">[</span><span class="n">nominal_mc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># compute errors</span>
        <span class="n">serrors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">mcs</span><span class="p">:</span>
            <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">mc_translator</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">:</span>
                    <span class="c1"># Note: not handling when one component Wdb has one translated pattern and another another</span>
                    <span class="n">perr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_statistics</span><span class="p">(</span><span class="n">mc_translator</span><span class="p">[</span><span class="n">mc</span><span class="p">],</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span>
                                                   <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">returnindiv</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                    <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_errors</span><span class="p">(</span><span class="n">perr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">failoninc</span><span class="p">:</span>
                        <span class="n">mcsscounts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_missing_reactions</span><span class="p">(</span><span class="n">mc_translator</span><span class="p">[</span><span class="n">mc</span><span class="p">],</span> <span class="n">sset</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>
                        <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;tgtcnt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcsscounts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;misscnt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mcsscounts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">autothread</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;sset&#39;</span> <span class="ow">in</span> <span class="n">autothread</span> <span class="ow">and</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">autothread</span><span class="p">[</span><span class="s1">&#39;sset&#39;</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;sset&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">autothread</span><span class="p">):</span>
                            <span class="n">mcssplots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_flat</span><span class="p">(</span><span class="n">mc_translator</span><span class="p">[</span><span class="n">mc</span><span class="p">],</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span>
                                <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;sapt&#39;</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="n">xlimit</span><span class="p">,</span> <span class="n">xlines</span><span class="o">=</span><span class="n">xlines</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                <span class="n">saveas</span><span class="o">=</span><span class="s1">&#39;flat_&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">mc</span><span class="p">]),</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">])</span>
                            <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;plotflat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcssplots</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">autoliliowa</span> <span class="ow">and</span> <span class="n">ss</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                            <span class="n">mcssplots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_liliowa</span><span class="p">(</span><span class="n">mc_translator</span><span class="p">[</span><span class="n">mc</span><span class="p">],</span> <span class="n">benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span>
                                <span class="n">failoninc</span><span class="o">=</span><span class="n">failoninc</span><span class="p">,</span> <span class="n">xlimit</span><span class="o">=</span><span class="n">ialimit</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                <span class="n">saveas</span><span class="o">=</span><span class="s1">&#39;liliowa_&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">mc</span><span class="p">]),</span> <span class="n">relpath</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">graphicsformat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">])</span>
                            <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;plotliliowa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcssplots</span><span class="p">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">perr</span><span class="p">[</span><span class="n">db</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                            <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="n">db</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="n">db</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_errors</span><span class="p">(</span><span class="n">perr</span><span class="p">[</span><span class="n">db</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">failoninc</span><span class="p">:</span>
                                <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="n">db</span><span class="p">][</span><span class="s1">&#39;tgtcnt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcsscounts</span><span class="p">[</span><span class="n">db</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                                <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="n">db</span><span class="p">][</span><span class="s1">&#39;misscnt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mcsscounts</span><span class="p">[</span><span class="n">db</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_errors</span><span class="p">(</span><span class="n">initialize_errors</span><span class="p">(),</span> <span class="n">mode</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">serrors</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">ss</span><span class="p">][</span><span class="n">db</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_errors</span><span class="p">(</span><span class="n">initialize_errors</span><span class="p">(),</span> <span class="n">mode</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">serrors</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;{:&gt;35}{:&gt;35}{}&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">mc_translator</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">serrors</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;default&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dbse</span><span class="p">][</span><span class="s1">&#39;mae&#39;</span><span class="p">]))</span>

        <span class="c1"># find indices that would be neglected in a single sweep over table_generic</span>
        <span class="n">keysinplan</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">col</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnplan</span><span class="p">],</span> <span class="n">rowplan</span><span class="p">))</span>
        <span class="n">obvious</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="n">dbse</span><span class="p">,</span> <span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="n">sset</span><span class="p">,</span> <span class="s1">&#39;mtd&#39;</span><span class="p">:</span> <span class="n">mtd</span><span class="p">,</span> <span class="s1">&#39;opt&#39;</span><span class="p">:</span> <span class="n">opt</span><span class="p">,</span> <span class="s1">&#39;bas&#39;</span><span class="p">:</span> <span class="n">bas</span><span class="p">,</span> <span class="s1">&#39;err&#39;</span><span class="p">:</span> <span class="n">err</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">vari</span> <span class="ow">in</span> <span class="n">obvious</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vari</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keysinplan</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">obvious</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">iteroers</span> <span class="o">=</span> <span class="p">[(</span><span class="n">prod</span><span class="p">)</span> <span class="k">for</span> <span class="n">prod</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">obvious</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>

        <span class="c1"># commence to generate LaTeX code</span>
        <span class="n">tablelines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">indexlines</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">standalone</span><span class="p">:</span>
            <span class="n">tablelines</span> <span class="o">+=</span> <span class="n">textables</span><span class="o">.</span><span class="n">begin_latex_document</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">io</span> <span class="ow">in</span> <span class="n">iteroers</span><span class="p">:</span>
            <span class="n">actvargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">obvious</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="p">[[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">io</span><span class="p">]))</span>
            <span class="n">nudbse</span> <span class="o">=</span> <span class="n">actvargs</span><span class="p">[</span><span class="s1">&#39;dbse&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;dbse&#39;</span> <span class="ow">in</span> <span class="n">actvargs</span> <span class="k">else</span> <span class="n">dbse</span>
            <span class="n">nusset</span> <span class="o">=</span> <span class="n">actvargs</span><span class="p">[</span><span class="s1">&#39;sset&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;sset&#39;</span> <span class="ow">in</span> <span class="n">actvargs</span> <span class="k">else</span> <span class="n">sset</span>
            <span class="n">numtd</span> <span class="o">=</span> <span class="n">actvargs</span><span class="p">[</span><span class="s1">&#39;mtd&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;mtd&#39;</span> <span class="ow">in</span> <span class="n">actvargs</span> <span class="k">else</span> <span class="n">mtd</span>
            <span class="n">nuopt</span> <span class="o">=</span> <span class="n">actvargs</span><span class="p">[</span><span class="s1">&#39;opt&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;opt&#39;</span> <span class="ow">in</span> <span class="n">actvargs</span> <span class="k">else</span> <span class="n">opt</span>
            <span class="n">nubas</span> <span class="o">=</span> <span class="n">actvargs</span><span class="p">[</span><span class="s1">&#39;bas&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;bas&#39;</span> <span class="ow">in</span> <span class="n">actvargs</span> <span class="k">else</span> <span class="n">bas</span>
            <span class="n">nuerr</span> <span class="o">=</span> <span class="n">actvargs</span><span class="p">[</span><span class="s1">&#39;err&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;err&#39;</span> <span class="ow">in</span> <span class="n">actvargs</span> <span class="k">else</span> <span class="n">err</span>

            <span class="n">table</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">textables</span><span class="o">.</span><span class="n">table_generic</span><span class="p">(</span>
                <span class="n">mtd</span><span class="o">=</span><span class="n">numtd</span><span class="p">,</span> <span class="n">bas</span><span class="o">=</span><span class="n">nubas</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="n">nuopt</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="n">nuerr</span><span class="p">,</span> <span class="n">sset</span><span class="o">=</span><span class="n">nusset</span><span class="p">,</span> <span class="n">dbse</span><span class="o">=</span><span class="n">nudbse</span><span class="p">,</span>
                <span class="n">rowplan</span><span class="o">=</span><span class="n">rowplan</span><span class="p">,</span> <span class="n">columnplan</span><span class="o">=</span><span class="n">columnplan</span><span class="p">,</span> <span class="n">serrors</span><span class="o">=</span><span class="n">serrors</span><span class="p">,</span>
                <span class="n">plotpath</span><span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">plotpath</span> <span class="o">==</span> <span class="s1">&#39;autogen&#39;</span> <span class="k">else</span> <span class="n">plotpath</span><span class="p">,</span>
                <span class="n">subjoin</span><span class="o">=</span><span class="n">subjoin</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">indextitle</span><span class="o">=</span><span class="n">indextitle</span><span class="p">,</span>
                <span class="n">suppressblanks</span><span class="o">=</span><span class="n">suppressblanks</span><span class="p">,</span>
                <span class="n">landscape</span><span class="o">=</span><span class="n">landscape</span><span class="p">,</span> <span class="n">footnotes</span><span class="o">=</span><span class="n">footnotes</span><span class="p">,</span>
                <span class="n">standalone</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">)</span>

            <span class="n">tablelines</span> <span class="o">+=</span> <span class="n">table</span>
            <span class="n">tablelines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">indexlines</span> <span class="o">+=</span> <span class="n">index</span>

        <span class="k">if</span> <span class="n">standalone</span><span class="p">:</span>
            <span class="n">tablelines</span> <span class="o">+=</span> <span class="n">textables</span><span class="o">.</span><span class="n">end_latex_document</span><span class="p">()</span>

        <span class="c1"># form table and index return structures</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tablelines</span><span class="p">,</span> <span class="n">indexlines</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.tex&#39;</span><span class="p">):</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
                <span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tablelines</span><span class="p">))</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_index.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
                <span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">indexlines</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">  LaTeX index written to {filename}_index.tex</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
                  <span class="sd">&quot;&quot;&quot;  LaTeX table written to {filename}.tex\n&quot;&quot;&quot;</span>
                  <span class="sd">&quot;&quot;&quot;  &gt;&gt;&gt; pdflatex {filename}\n&quot;&quot;&quot;</span>
                  <span class="sd">&quot;&quot;&quot;  &gt;&gt;&gt; open /Applications/Preview.app {filename}.pdf\n&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">))</span>
            <span class="n">filedict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.tex&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_index.tex&#39;</span><span class="p">)}</span>
            <span class="k">return</span> <span class="n">filedict</span></div>

<div class="viewcode-block" id="Database.table_scrunch"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.table_scrunch">[docs]</a>    <span class="k">def</span> <span class="nf">table_scrunch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotpath</span><span class="p">,</span> <span class="n">subjoin</span><span class="p">):</span>
        <span class="n">rowplan</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mtd&#39;</span><span class="p">]</span>
        <span class="n">columnplan</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">r&#39;Method&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">r&#39;Description&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">empty</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">r&#39;aug-cc-pVDZ&#39;</span><span class="p">,</span> <span class="s1">&#39;unCP&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;bas&#39;</span><span class="p">:</span> <span class="s1">&#39;adz&#39;</span><span class="p">,</span> <span class="s1">&#39;opt&#39;</span><span class="p">:</span> <span class="s1">&#39;unCP&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">r&#39;aug-cc-pVDZ&#39;</span><span class="p">,</span> <span class="s1">&#39;CP&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;bas&#39;</span><span class="p">:</span> <span class="s1">&#39;adz&#39;</span><span class="p">,</span> <span class="s1">&#39;opt&#39;</span><span class="p">:</span> <span class="s1">&#39;CP&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">r&#39;aug-cc-pVTZ&#39;</span><span class="p">,</span> <span class="s1">&#39;unCP&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;bas&#39;</span><span class="p">:</span> <span class="s1">&#39;atz&#39;</span><span class="p">,</span> <span class="s1">&#39;opt&#39;</span><span class="p">:</span> <span class="s1">&#39;unCP&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">r&#39;aug-cc-pVTZ&#39;</span><span class="p">,</span> <span class="s1">&#39;CP&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;bas&#39;</span><span class="p">:</span> <span class="s1">&#39;atz&#39;</span><span class="p">,</span> <span class="s1">&#39;opt&#39;</span><span class="p">:</span> <span class="s1">&#39;CP&#39;</span><span class="p">}]]</span>

        <span class="n">footnotes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">landscape</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">theme</span> <span class="o">=</span> <span class="s1">&#39;summavg&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;Classification and Performance of model chemistries. Interaction energy [kcal/mol] {{err}} statistics.&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">rowplan</span><span class="p">,</span> <span class="n">columnplan</span><span class="p">,</span> <span class="n">landscape</span><span class="p">,</span> <span class="n">footnotes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">theme</span></div>

<div class="viewcode-block" id="Database.table_merge_abbr"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.table_merge_abbr">[docs]</a>    <span class="k">def</span> <span class="nf">table_merge_abbr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotpath</span><span class="p">,</span> <span class="n">subjoin</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Specialization of table_generic into table with minimal statistics</span>
<span class="sd">        (three S22 and three overall) plus embedded slat diagram as suitable</span>
<span class="sd">        for main paper. A single table is formed in sections by *bas* with</span>
<span class="sd">        lines *mtd* within each section.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rowplan</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bas&#39;</span><span class="p">,</span> <span class="s1">&#39;mtd&#39;</span><span class="p">]</span>
        <span class="n">columnplan</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;Method \&amp; Basis Set&quot;&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">r&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;HB&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;hb&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;S22&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">r&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;MX/DD&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;mxdd&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;S22&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">r&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;TT&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;tt&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;S22&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">r&#39;Overall&#39;</span><span class="p">,</span> <span class="s1">&#39;HB&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;hb&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;DB4&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">r&#39;Overall&#39;</span><span class="p">,</span> <span class="s1">&#39;MX/DD&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;mxdd&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;DB4&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">r&#39;Overall&#39;</span><span class="p">,</span> <span class="s1">&#39;TT&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;tt&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;DB4&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;Error Distribution\footnotemark[1]&quot;&quot;&quot;</span><span class="p">,</span>
             <span class="sd">r&quot;&quot;&quot;\includegraphics[width=6.67cm,height=3.5mm]{%s%s.pdf}&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotpath</span><span class="p">,</span> <span class="s1">&#39;blank&#39;</span><span class="p">),</span>
             <span class="n">textables</span><span class="o">.</span><span class="n">graphics</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">r&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">empty</span><span class="p">,</span> <span class="p">{}]]</span>
        <span class="c1"># TODO Time column not right at all</span>

        <span class="n">footnotes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fnreservoir</span><span class="p">[</span><span class="s1">&#39;blankslat&#39;</span><span class="p">]]</span>
        <span class="n">landscape</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">theme</span> <span class="o">=</span> <span class="s1">&#39;smmerge&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;Interaction energy [kcal/mol] {{err}} subset statistics with computed with {{opt}}{0}.&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">subjoin</span> <span class="k">else</span> <span class="s2">r&quot;&quot;&quot; and {bas}&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rowplan</span><span class="p">,</span> <span class="n">columnplan</span><span class="p">,</span> <span class="n">landscape</span><span class="p">,</span> <span class="n">footnotes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">theme</span></div>

<div class="viewcode-block" id="Database.table_merge_suppmat"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.Database.table_merge_suppmat">[docs]</a>    <span class="k">def</span> <span class="nf">table_merge_suppmat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotpath</span><span class="p">,</span> <span class="n">subjoin</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Specialization of table_generic into table with as many statistics</span>
<span class="sd">        as will fit (mostly fullcurve and a few 5min) plus embedded slat</span>
<span class="sd">        diagram as suitable for supplementary material. Multiple tables are</span>
<span class="sd">        formed, one for each in *bas* with lines *mtd* within each table.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rowplan</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bas&#39;</span><span class="p">,</span> <span class="s1">&#39;mtd&#39;</span><span class="p">]</span>
        <span class="n">columnplan</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;Method \&amp; Basis Set&quot;&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;HB&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;hb&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;S22&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;MX&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;S22&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;DD&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;S22&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;S22&#39;</span><span class="p">,</span> <span class="s1">&#39;TT&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;tt&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;S22&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;NBC10&#39;</span><span class="p">,</span> <span class="s1">&#39;MX&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;NBC10&#39;</span><span class="p">,</span> <span class="s1">&#39;DD&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;NBC10&#39;</span><span class="p">,</span> <span class="s1">&#39;TT&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;tt&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;HBC6&#39;</span><span class="p">,</span> <span class="s1">&#39;HB/TT&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;tt&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;HBC1&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;HSG&#39;</span><span class="p">,</span> <span class="s1">&#39;HB&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;hb&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;HSG&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;HSG&#39;</span><span class="p">,</span> <span class="s1">&#39;MX&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;HSG&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;HSG&#39;</span><span class="p">,</span> <span class="s1">&#39;DD&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;HSG&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;HSG&#39;</span><span class="p">,</span> <span class="s1">&#39;TT&#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;tt&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;HSG&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;Avg&#39;</span><span class="p">,</span> <span class="s1">&#39;TT &#39;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;tt&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;DB4&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;Error Distribution\footnotemark[1]&quot;&quot;&quot;</span><span class="p">,</span>
             <span class="sd">r&quot;&quot;&quot;\includegraphics[width=6.67cm,height=3.5mm]{%s%s.pdf}&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotpath</span><span class="p">,</span> <span class="s1">&#39;blank&#39;</span><span class="p">),</span>
             <span class="n">textables</span><span class="o">.</span><span class="n">graphics</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;NBC10&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;TT\footnotemark[2]&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;tt-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;NBC1&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;HBC6&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;TT\footnotemark[2] &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;tt-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;HBC1&#39;</span><span class="p">}],</span>
            <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;Avg&#39;</span><span class="p">,</span> <span class="s2">r&quot;&quot;&quot;TT\footnotemark[2]&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">textables</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;sset&#39;</span><span class="p">:</span> <span class="s1">&#39;tt-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;dbse&#39;</span><span class="p">:</span> <span class="s1">&#39;DB4&#39;</span><span class="p">}]]</span>

        <span class="n">footnotes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fnreservoir</span><span class="p">[</span><span class="s1">&#39;blankslat&#39;</span><span class="p">],</span> <span class="n">fnreservoir</span><span class="p">[</span><span class="s1">&#39;5min&#39;</span><span class="p">]]</span>
        <span class="n">landscape</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">theme</span> <span class="o">=</span> <span class="s1">&#39;lgmerge&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;Interaction energy [kcal/mol] {{err}} subset statistics with computed with {{opt}}{0}.&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">subjoin</span> <span class="k">else</span> <span class="s2">r&quot;&quot;&quot; and {bas}&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rowplan</span><span class="p">,</span> <span class="n">columnplan</span><span class="p">,</span> <span class="n">landscape</span><span class="p">,</span> <span class="n">footnotes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">theme</span></div></div>


<div class="viewcode-block" id="DB4"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4">[docs]</a><span class="k">class</span> <span class="nc">DB4</span><span class="p">(</span><span class="n">Database</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">loadfrompickle</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize FourDatabases object from SuperDatabase&quot;&quot;&quot;</span>
        <span class="n">Database</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;s22&#39;</span><span class="p">,</span> <span class="s1">&#39;nbc10&#39;</span><span class="p">,</span> <span class="s1">&#39;hbc6&#39;</span><span class="p">,</span> <span class="s1">&#39;hsg&#39;</span><span class="p">],</span> <span class="n">dbse</span><span class="o">=</span><span class="s1">&#39;DB4&#39;</span><span class="p">,</span>
                          <span class="n">pythonpath</span><span class="o">=</span><span class="n">pythonpath</span><span class="p">,</span> <span class="n">loadfrompickle</span><span class="o">=</span><span class="n">loadfrompickle</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># # load up data and definitions</span>
        <span class="c1"># self.load_qcdata_byproject(&#39;dft&#39;)</span>
        <span class="c1"># self.load_qcdata_byproject(&#39;pt2&#39;)</span>
        <span class="c1"># #self.load_qcdata_byproject(&#39;dhdft&#39;)</span>
        <span class="c1"># self.load_subsets()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">define_supersubsets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">define_supermodelchems</span><span class="p">()</span>

<div class="viewcode-block" id="DB4.define_supersubsets"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.define_supersubsets">[docs]</a>    <span class="k">def</span> <span class="nf">define_supersubsets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;tt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;hb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hb&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;hb&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;mx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;mx&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;dd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;mxdd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxdd&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;mxdd&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;pp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxddpp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddpp&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;np&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxddnp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddnp&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;mxdd&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;5min&#39;</span><span class="p">,</span> <span class="s1">&#39;5min&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;hb-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hb&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;5min&#39;</span><span class="p">,</span> <span class="s1">&#39;hb&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;mx-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="s1">&#39;mx-5min&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;mx&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;dd-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;dd-5min&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;mxdd-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxdd&#39;</span><span class="p">,</span> <span class="s1">&#39;5min&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;mxdd&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;pp-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxddpp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddpp-5min&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;np-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxddnp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddnp-5min&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;mxdd&#39;</span><span class="p">]</span></div>

    <span class="c1"># def benchmark(self):</span>
    <span class="c1">#     &quot;&quot;&quot;Returns the model chemistry label for the database&#39;s benchmark.&quot;&quot;&quot;</span>
    <span class="c1">#     return &#39;C2001BENCH&#39;</span>

<div class="viewcode-block" id="DB4.define_supermodelchems"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.define_supermodelchems">[docs]</a>    <span class="k">def</span> <span class="nf">define_supermodelchems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="s1">&#39;C2011BENCH&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;C2010BENCH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S22A&#39;</span><span class="p">,</span> <span class="s1">&#39;NBC100&#39;</span><span class="p">,</span> <span class="s1">&#39;HBC60&#39;</span><span class="p">,</span> <span class="s1">&#39;HSG0&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;C2011BENCH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S22B&#39;</span><span class="p">,</span> <span class="s1">&#39;NBC10A&#39;</span><span class="p">,</span> <span class="s1">&#39;HBC6A&#39;</span><span class="p">,</span> <span class="s1">&#39;HSGA&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-adz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-hadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-hatz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-adtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-hadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-adtzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-adtzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-adtzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atzhadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzadtz&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;CCSD-CP-atqzhadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzatz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzhatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzhatz&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-adz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-hadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-hatz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-adtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-hadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-adtzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-adtzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-adtzadz&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;SCSCCSD-CP-adtzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atzadz&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;SCSCCSD-CP-atzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atqzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atqzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atqzadz&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;SCSCCSD-CP-atqzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atzadtz&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;SCSCCSD-CP-atzhadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atqzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atqzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atqzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atqzadtz&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;SCSCCSD-CP-atqzhadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atqzatz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSCCSD-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atqzhatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atqzatz&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;SCSCCSD-CP-atqzhatz&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-adz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-adz&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;SCSMICCSD-CP-hadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atz&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;SCSMICCSD-CP-hatz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-adtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-adtz&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;SCSMICCSD-CP-hadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-adtzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-adtzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-adtzadz&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;SCSMICCSD-CP-adtzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atzadz&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;SCSMICCSD-CP-atzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atqzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atqzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atqzadz&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;SCSMICCSD-CP-atqzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atzadtz&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;SCSMICCSD-CP-atzhadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atqzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atqzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atqzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atqzadtz&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SCSMICCSD-CP-atqzhadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atqzatz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SCSMICCSD-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atqzhatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atqzatz&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;SCSMICCSD-CP-atqzhatz&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-adz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-hadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-hatz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-adtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-hadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-adtzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-adtzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-adtzadz&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;CCSDT-CP-adtzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzadz&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;CCSDT-CP-atqzhadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atzadtz&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;CCSDT-CP-atzhadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzadtz&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;CCSDT-CP-atqzhadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcs</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzatz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzhatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzatz&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;CCSDT-CP-atqzhatz&#39;</span><span class="p">]</span></div>

        <span class="c1"># def make_pt2_flats(self):</span>
        <span class="c1"># def plot_all_flats(self):</span>
        <span class="c1">#    &quot;&quot;&quot;Generate pieces for inclusion into tables for PT2 paper.</span>
        <span class="c1">#    Note that DB4 flats use near-equilibrium subset.</span>
        <span class="c1">#</span>
        <span class="c1">#   &quot;&quot;&quot;</span>
        <span class="c1"># Database.plot_all_flats(self, modelchem=None, sset=&#39;tt-5min&#39;, xlimit=4.0,</span>
        <span class="c1">#    graphicsformat=[&#39;pdf&#39;])</span>

<div class="viewcode-block" id="DB4.make_pt2_Figure_3"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.make_pt2_Figure_3">[docs]</a>    <span class="k">def</span> <span class="nf">make_pt2_Figure_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot all the graphics needed for the calendar grey bars plot</span>
<span class="sd">        in Fig. 3 of PT2.</span>

<span class="sd">        Note that in the modern implementation of class DB4, would need to</span>
<span class="sd">        pass ``sset=[&#39;tt-5min&#39;, &#39;hb-5min&#39;, &#39;mx-5min&#39;, &#39;dd-5min&#39;]`` to get</span>
<span class="sd">        published figure.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Fig. bars (a)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP2-CP-dz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-jadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-adz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2-CP-qz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-aaqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-maqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-jaqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-haqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-aqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2-CP-tqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-matqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-jatqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-hatqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-atqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2-CP-a5z&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-aq5z&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSMP2-CP-dz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-jadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-adz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2-CP-qz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-aaqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-maqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-jaqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-haqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2-CP-aqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2-CP-tqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-matqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-jatqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-hatqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-atqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2-CP-a5z&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-aq5z&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSNMP2-CP-dz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-jadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-adz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2-CP-qz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-aaqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-maqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-jaqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-haqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2-CP-aqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2-CP-tqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-matqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-jatqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-hatqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-atqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2-CP-a5z&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-aq5z&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2-CP-qz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-aaqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-maqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-jaqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2-CP-haqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-aqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2-CP-tqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-matqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-jatqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-hatqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2-CP-atqz&#39;</span><span class="p">,</span>
                        <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;DWMP2-CP-dz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-jadz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-adz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DWMP2-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DWMP2-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DWMP2-CP-qz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-aaqz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-maqz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-jaqz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-haqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DWMP2-CP-aqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DWMP2-CP-tqz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-matqz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-jatqz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-hatqz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-atqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DWMP2-CP-a5z&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-aq5z&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP2C-CP-dz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-jadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-adz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2C-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2C-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-aqz&#39;</span><span class="p">,</span>
                        <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqz&#39;</span><span class="p">,</span>
                        <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP2C-CP-atqzdz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqzjadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqzadz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2C-CP-atqztz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqzmatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqzjatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqzhatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqzatz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2C-CP-atqzdtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqzjadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqzadtz&#39;</span><span class="p">])</span>

        <span class="c1"># Fig. bars (c)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP2F12-CP-dz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-jadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-adz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2F12-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2F12-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2F12-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSMP2F12-CP-dz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-jadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-adz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2F12-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-hatz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2F12-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2F12-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2F12-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSNMP2F12-CP-dz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-jadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-adz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2F12-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-hatz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2F12-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2F12-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2F12-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2F12-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2F12-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2F12-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2F12-CP-hatz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2F12-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2F12-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2F12-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2F12-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2F12-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2F12-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2F12-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;DWMP2F12-CP-dz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-jadz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-adz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DWMP2F12-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DWMP2F12-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DWMP2F12-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP2CF12-CP-dz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-jadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-adz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2CF12-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-matz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-jatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2CF12-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-jadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2CF12-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP2CF12-CP-atqzdz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqzjadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqzadz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2CF12-CP-atqztz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqzmatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqzjatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqzhatz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2CF12-CP-atqzatz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2CF12-CP-atqzdtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqzjadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqzadtz&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="DB4.make_pt2_Figure_2"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.make_pt2_Figure_2">[docs]</a>    <span class="k">def</span> <span class="nf">make_pt2_Figure_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot all the graphics needed for the diffuse augmented grey</span>
<span class="sd">        bars plot in Fig. 2 of PT2.</span>

<span class="sd">        Note that in the modern implementation of class DB4, would need to</span>
<span class="sd">        pass ``sset=[&#39;tt-5min&#39;, &#39;hb-5min&#39;, &#39;mx-5min&#39;, &#39;dd-5min&#39;]`` to get</span>
<span class="sd">        published figure.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Fig. bars (a)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP2-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-atqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-a5z&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-aq5z&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSMP2-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-atqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2-CP-a5z&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2-CP-aq5z&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSNMP2-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-atqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2-CP-a5z&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2-CP-aq5z&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSMIMP2-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSMIMP2-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-tz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2-CP-dtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-qz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-tqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;DWMP2-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DWMP2-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-atqz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-a5z&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2-CP-aq5z&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP2C-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-adtzadz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2C-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-aq5zadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2C-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-aq5zatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2C-CP-atqzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqz&#39;</span><span class="p">])</span>

        <span class="c1"># Fig. bars (b)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP3-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP3-CP-atqzadz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP3-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP3-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP3-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP3-CP-atqzadtz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP25-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP25-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP25-CP-atqzadz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP25-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP25-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP25-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP25-CP-atqzadtz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;CCSD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzadz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;CCSD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzadtz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSCCSD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-adtzadz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSCCSD-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atqzatz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSCCSD-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSD-CP-atqzadtz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSMICCSD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-adtzadz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMICCSD-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atqzatz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMICCSD-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMICCSD-CP-atqzadtz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;CCSDT-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-adtzadz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;CCSDT-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzatz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;CCSDT-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzadtz&#39;</span><span class="p">])</span>

        <span class="c1"># Fig. bars (c)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP2F12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-adtz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2F12-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2F12-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSMP2F12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMP2F12-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMP2F12-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSNMP2F12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2F12-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2F12-CP-aqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSNMP2F12-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSMIMP2F12-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2F12-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2F12-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2F12-CP-aqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;SCSMIMP2F12-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSMIMP2F12-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2F12-CP-tz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2F12-CP-dtz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;DWMP2F12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-atz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DWMP2F12-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-aqz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWMP2F12-CP-atqz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;MP2CF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-adtzadz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2CF12-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqzatz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2CF12-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-atqzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12-CP-aqz&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;MP2CF12-CP-atqz&#39;</span><span class="p">])</span>

        <span class="c1"># Fig. bars (d)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;CCSDAF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDAF12-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDAF12-CP-atqzadz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;CCSDBF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDBF12-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDBF12-CP-atqzadz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSCCSDAF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSDAF12-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSDAF12-CP-atqzadz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCSCCSDBF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSDBF12-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSCCSDBF12-CP-atqzadz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCMICCSDAF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCMICCSDAF12-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCMICCSDAF12-CP-atqzadz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;SCMICCSDBF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCMICCSDBF12-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCMICCSDBF12-CP-atqzadz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;CCSDTAF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDTAF12-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDTAF12-CP-atqzadz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;CCSDTBF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDTBF12-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDTBF12-CP-atqzadz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span><span class="s1">&#39;DWCCSDTF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWCCSDTF12-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWCCSDTF12-CP-atqzadz&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="DB4.plot_dhdft_flats"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.plot_dhdft_flats">[docs]</a>    <span class="k">def</span> <span class="nf">plot_dhdft_flats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate pieces for grey bars figure for DH-DFT paper.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_all_flats</span><span class="p">(</span>
            <span class="p">[</span><span class="s1">&#39;B97D3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE0D3-CP-adz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;WB97XD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-CP-adz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;VV10-CP-adz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;LCVV10-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3-CP-adz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DSDPBEP86D2OPT-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-adz&#39;</span><span class="p">],</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_all_flats</span><span class="p">([</span><span class="s1">&#39;B97D3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-unCP-adz&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;PBE0D3-unCP-adz&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;WB97XD-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-unCP-adz&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;M11-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10-unCP-adz&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;LCVV10-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-unCP-adz&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;B2PLYPD3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-unCP-adz&#39;</span><span class="p">],</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_all_flats</span><span class="p">(</span>
            <span class="p">[</span><span class="s1">&#39;B97D3-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE0D3-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;WB97XD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;VV10-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;LCVV10-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DSDPBEP86D2OPT-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-atz&#39;</span><span class="p">],</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_all_flats</span><span class="p">([</span><span class="s1">&#39;B97D3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-unCP-atz&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;PBE0D3-unCP-atz&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;WB97XD-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-unCP-atz&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;M11-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10-unCP-atz&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;LCVV10-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-unCP-atz&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;B2PLYPD3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-unCP-atz&#39;</span><span class="p">],</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DB4.make_dhdft_Figure_1"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.make_dhdft_Figure_1">[docs]</a>    <span class="k">def</span> <span class="nf">make_dhdft_Figure_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot all the graphics needed for the grey bars plot</span>
<span class="sd">        in Fig. 1 of DHDFT.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Fig. bars (a)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span>
            <span class="s1">&#39;M052X-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;M062X-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;M08SO-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;M08HX-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;M11-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;M11L-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-CP-atz&#39;</span><span class="p">],</span>
            <span class="n">sset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;hb-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;mx-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;dd-5min&#39;</span><span class="p">])</span>

        <span class="c1"># Fig. bars (b)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span>
            <span class="s1">&#39;PBED3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;B97D3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B97D3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B97D3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B97D3-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;PBE0D3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE0D3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE0D3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE0D3-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;B3LYPD3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;DLDFD-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;WB97XD-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XD-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XD-CP-atz&#39;</span><span class="p">],</span>
            <span class="n">sset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;hb-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;mx-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;dd-5min&#39;</span><span class="p">])</span>

        <span class="c1"># Fig. bars (c)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span>
            <span class="s1">&#39;VV10-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;LCVV10-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;LCVV10-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;LCVV10-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;LCVV10-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;WB97XV-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-CP-atz&#39;</span><span class="p">],</span>
            <span class="n">sset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;hb-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;mx-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;dd-5min&#39;</span><span class="p">])</span>

        <span class="c1"># Fig. bars (d)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span>
            <span class="s1">&#39;PBE02-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;WB97X2-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;B2PLYPD3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;DSDPBEP86D2OPT-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT-CP-atz&#39;</span><span class="p">],</span>
            <span class="n">sset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;hb-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;mx-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;dd-5min&#39;</span><span class="p">])</span>

        <span class="c1"># Fig. bars (e)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span>
            <span class="s1">&#39;MP2-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-atz&#39;</span><span class="p">],</span>
            <span class="n">sset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;hb-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;mx-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;dd-5min&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="DB4.make_dhdft_Figure_2"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.make_dhdft_Figure_2">[docs]</a>    <span class="k">def</span> <span class="nf">make_dhdft_Figure_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot all the graphics needed for the SAPT/DFT/WFN</span>
<span class="sd">        comparison plot in Fig. 2 of DHDFT.</span>

<span class="sd">        Note that benchmark set as reminder, not necessity, since default.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_bars</span><span class="p">([</span>
            <span class="s1">&#39;SAPT0S-CP-jadz&#39;</span><span class="p">,</span> <span class="s1">&#39;SAPTDFT-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;SAPT2P-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SAPT3M-CP-atz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;SAPT2PCM-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;B97D3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-CP-adz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;M052X-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-CP-atz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DSDPBEP86D2OPT-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3-CP-atz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-atz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;SCSMP2-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2-CP-qz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2C-CP-atqzadz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;MP2CF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;SCMICCSDAF12-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CCSDT-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;DWCCSDTF12-CP-adz&#39;</span><span class="p">],</span>
            <span class="n">sset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;hb-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;mx-5min&#39;</span><span class="p">,</span> <span class="s1">&#39;dd-5min&#39;</span><span class="p">],</span>
            <span class="n">benchmark</span><span class="o">=</span><span class="s1">&#39;C2011BENCH&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DB4.plot_dhdft_modelchems"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.plot_dhdft_modelchems">[docs]</a>    <span class="k">def</span> <span class="nf">plot_dhdft_modelchems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_modelchems</span><span class="p">(</span>
            <span class="p">[</span><span class="s1">&#39;B97D3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE0D3-CP-adz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;WB97XD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-CP-adz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;VV10-CP-adz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;LCVV10-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3-CP-adz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DSDPBEP86D2OPT-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-adz&#39;</span><span class="p">],</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_modelchems</span><span class="p">([</span><span class="s1">&#39;B97D3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-unCP-adz&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;PBE0D3-unCP-adz&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;WB97XD-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-unCP-adz&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;M11-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10-unCP-adz&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;LCVV10-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-unCP-adz&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;B2PLYPD3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-unCP-adz&#39;</span><span class="p">],</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_modelchems</span><span class="p">(</span>
            <span class="p">[</span><span class="s1">&#39;B97D3-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE0D3-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;WB97XD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;VV10-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;LCVV10-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DSDPBEP86D2OPT-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-CP-atz&#39;</span><span class="p">],</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_modelchems</span><span class="p">([</span><span class="s1">&#39;B97D3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-unCP-atz&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;PBE0D3-unCP-atz&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;WB97XD-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-unCP-atz&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;M11-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10-unCP-atz&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;LCVV10-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-unCP-atz&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;B2PLYPD3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2-unCP-atz&#39;</span><span class="p">],</span> <span class="n">sset</span><span class="o">=</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DB4.plot_minn_modelchems"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.plot_minn_modelchems">[docs]</a>    <span class="k">def</span> <span class="nf">plot_minn_modelchems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_modelchems</span><span class="p">(</span>
            <span class="p">[</span><span class="s1">&#39;DLDFD-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-unCP-adz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;M11L-unCP-adz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DLDFD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-CP-adz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;M11L-CP-adz&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_modelchems</span><span class="p">(</span>
            <span class="p">[</span><span class="s1">&#39;DlDFD-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-unCP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;M11L-unCP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DLDFD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;M11L-CP-atz&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="DB4.make_dhdft_Table_I"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.make_dhdft_Table_I">[docs]</a>    <span class="k">def</span> <span class="nf">make_dhdft_Table_I</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the in-manuscript summary slat table for DHDFT.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_wrapper</span><span class="p">(</span><span class="n">mtd</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B97D3&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;PBE0D3&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XD&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;M08SO&#39;</span><span class="p">,</span> <span class="s1">&#39;M11&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10&#39;</span><span class="p">,</span> <span class="s1">&#39;LCVV10&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;PBE02&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;MP2&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSNMP2&#39;</span><span class="p">,</span> <span class="s1">&#39;SCSMIMP2&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2CF12&#39;</span><span class="p">,</span> <span class="s1">&#39;SCMICCSDAF12&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;SAPTDFT&#39;</span><span class="p">,</span> <span class="s1">&#39;SAPT0S&#39;</span><span class="p">,</span> <span class="s1">&#39;SAPT2P&#39;</span><span class="p">,</span> <span class="s1">&#39;SAPT3M&#39;</span><span class="p">,</span> <span class="s1">&#39;SAPT2PCM&#39;</span><span class="p">],</span>
                           <span class="n">bas</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;adz&#39;</span><span class="p">,</span> <span class="s1">&#39;atz&#39;</span><span class="p">],</span>
                           <span class="n">tableplan</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">table_scrunch</span><span class="p">,</span>
                           <span class="n">opt</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CP&#39;</span><span class="p">,</span> <span class="s1">&#39;unCP&#39;</span><span class="p">],</span> <span class="n">err</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">],</span>
                           <span class="n">subjoin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                           <span class="n">plotpath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                           <span class="n">standalone</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;tblssets_ex1&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DB4.make_dhdft_Table_II"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.make_dhdft_Table_II">[docs]</a>    <span class="k">def</span> <span class="nf">make_dhdft_Table_II</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the in-manuscript CP slat table for DHDFT.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_wrapper</span><span class="p">(</span><span class="n">mtd</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B97D3&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;PBE0D3&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XD&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;M08SO&#39;</span><span class="p">,</span> <span class="s1">&#39;M11&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10&#39;</span><span class="p">,</span> <span class="s1">&#39;LCVV10&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;PBE02&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2&#39;</span><span class="p">],</span>
                           <span class="n">bas</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;adz&#39;</span><span class="p">,</span> <span class="s1">&#39;atz&#39;</span><span class="p">],</span>
                           <span class="n">tableplan</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">table_merge_abbr</span><span class="p">,</span>
                           <span class="n">opt</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CP&#39;</span><span class="p">],</span> <span class="n">err</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">],</span>
                           <span class="n">subjoin</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                           <span class="n">plotpath</span><span class="o">=</span><span class="s1">&#39;analysis/flats/mplflat_&#39;</span><span class="p">,</span>  <span class="c1"># proj still has &#39;mpl&#39; prefix</span>
                           <span class="n">standalone</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;tblssets_ex2&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DB4.make_dhdft_Table_III"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.make_dhdft_Table_III">[docs]</a>    <span class="k">def</span> <span class="nf">make_dhdft_Table_III</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the in-manuscript unCP slat table for DHDFT.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_wrapper</span><span class="p">(</span><span class="n">mtd</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B97D3&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;PBE0D3&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XD&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;M08SO&#39;</span><span class="p">,</span> <span class="s1">&#39;M11&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10&#39;</span><span class="p">,</span> <span class="s1">&#39;LCVV10&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;PBE02&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3&#39;</span><span class="p">,</span> <span class="s1">&#39;MP2&#39;</span><span class="p">],</span>
                           <span class="n">bas</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;adz&#39;</span><span class="p">,</span> <span class="s1">&#39;atz&#39;</span><span class="p">],</span>
                           <span class="n">tableplan</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">table_merge_abbr</span><span class="p">,</span>
                           <span class="n">opt</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unCP&#39;</span><span class="p">],</span> <span class="n">err</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">],</span>
                           <span class="n">subjoin</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                           <span class="n">plotpath</span><span class="o">=</span><span class="s1">&#39;analysis/flats/mplflat_&#39;</span><span class="p">,</span>  <span class="c1"># proj still has &#39;mpl&#39; prefix</span>
                           <span class="n">standalone</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;tblssets_ex3&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DB4.make_dhdft_Tables_SII"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.make_dhdft_Tables_SII">[docs]</a>    <span class="k">def</span> <span class="nf">make_dhdft_Tables_SII</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the subset details suppmat Part II tables and their indices for DHDFT.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_wrapper</span><span class="p">(</span><span class="n">mtd</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B97D3&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;PBE0D3&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XD&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;M08SO&#39;</span><span class="p">,</span> <span class="s1">&#39;M11&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10&#39;</span><span class="p">,</span> <span class="s1">&#39;LCVV10&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;PBE02&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3&#39;</span><span class="p">],</span>  <span class="c1"># &#39;MP2&#39;]</span>
                           <span class="n">bas</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;adz&#39;</span><span class="p">,</span> <span class="s1">&#39;atz&#39;</span><span class="p">],</span>
                           <span class="n">tableplan</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">table_merge_suppmat</span><span class="p">,</span>
                           <span class="n">opt</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CP&#39;</span><span class="p">,</span> <span class="s1">&#39;unCP&#39;</span><span class="p">],</span> <span class="n">err</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;mape&#39;</span><span class="p">],</span>
                           <span class="n">subjoin</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                           <span class="n">plotpath</span><span class="o">=</span><span class="s1">&#39;analysis/flats/mplflat_&#39;</span><span class="p">,</span>  <span class="c1"># proj still has &#39;mpl&#39; prefix</span>
                           <span class="n">standalone</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;tblssets&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DB4.make_dhdft_Tables_SIII"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.DB4.make_dhdft_Tables_SIII">[docs]</a>    <span class="k">def</span> <span class="nf">make_dhdft_Tables_SIII</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the per-reaction suppmat Part III tables and their indices for DHDFT.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_reactions</span><span class="p">(</span>
            <span class="p">[</span><span class="s1">&#39;B97D3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B97D3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B97D3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B97D3-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;PBED3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBED3-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;M11L-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11L-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DLDFD-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;DLDFD-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;B3LYPD3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B3LYPD3-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;PBE0D3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE0D3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE0D3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE0D3-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;WB97XD-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XD-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XD-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;M052X-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M052X-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;M062X-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M062X-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;M08HX-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08HX-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;M08SO-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M08SO-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;M11-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;M11-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;VV10-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;LCVV10-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;LCVV10-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;LCVV10-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;LCVV10-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;WB97XV-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97XV-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;PBE02-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;PBE02-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;WB97X2-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X2-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DSDPBEP86D2OPT-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;DSDPBEP86D2OPT-CP-atz&#39;</span><span class="p">,</span>
             <span class="s1">&#39;B2PLYPD3-unCP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3-unCP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;B2PLYPD3-CP-atz&#39;</span><span class="p">],</span>
            <span class="c1"># &#39;MP2-unCP-adz&#39;, &#39;MP2-CP-adz&#39;, &#39;MP2-unCP-atz&#39;, &#39;MP2-CP-atz&#39;],</span>
            <span class="n">standalone</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;tblrxn_all&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ThreeDatabases"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.ThreeDatabases">[docs]</a><span class="k">class</span> <span class="nc">ThreeDatabases</span><span class="p">(</span><span class="n">Database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize ThreeDatabases object from Database&quot;&quot;&quot;</span>
        <span class="n">Database</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;s22&#39;</span><span class="p">,</span> <span class="s1">&#39;a24&#39;</span><span class="p">,</span> <span class="s1">&#39;hsg&#39;</span><span class="p">],</span> <span class="n">dbse</span><span class="o">=</span><span class="s1">&#39;DB3&#39;</span><span class="p">,</span> <span class="n">pythonpath</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="c1"># load up data and definitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_qcdata_byproject</span><span class="p">(</span><span class="s1">&#39;pt2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_qcdata_byproject</span><span class="p">(</span><span class="s1">&#39;dilabio&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_qcdata_byproject</span><span class="p">(</span><span class="s1">&#39;f12dilabio&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_subsets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">define_supersubsets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">define_supermodelchems</span><span class="p">()</span>

<div class="viewcode-block" id="ThreeDatabases.define_supersubsets"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.ThreeDatabases.define_supersubsets">[docs]</a>    <span class="k">def</span> <span class="nf">define_supersubsets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;tt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;hb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hb&#39;</span><span class="p">,</span> <span class="s1">&#39;hb&#39;</span><span class="p">,</span> <span class="s1">&#39;hb&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;mx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="s1">&#39;mx&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;dd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;mxdd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxdd&#39;</span><span class="p">,</span> <span class="s1">&#39;mxdd&#39;</span><span class="p">,</span> <span class="s1">&#39;mxdd&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;pp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxddpp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddpp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddpp&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;np&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxddnp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddnp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddnp&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;tt-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;hb-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hb&#39;</span><span class="p">,</span> <span class="s1">&#39;hb&#39;</span><span class="p">,</span> <span class="s1">&#39;hb&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;mx-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="s1">&#39;mx&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;dd-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;mxdd-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxdd&#39;</span><span class="p">,</span> <span class="s1">&#39;mxdd&#39;</span><span class="p">,</span> <span class="s1">&#39;mxdd&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;pp-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxddpp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddpp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddpp&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;np-5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mxddnp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddnp&#39;</span><span class="p">,</span> <span class="s1">&#39;mxddnp&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;weak&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weak&#39;</span><span class="p">,</span> <span class="s1">&#39;weak&#39;</span><span class="p">,</span> <span class="s1">&#39;weak&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;weak_hb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weak_hb&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;weak_hb&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;weak_mx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weak_mx&#39;</span><span class="p">,</span> <span class="s1">&#39;weak_mx&#39;</span><span class="p">,</span> <span class="s1">&#39;weak_mx&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sset</span><span class="p">[</span><span class="s1">&#39;weak_dd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weak_dd&#39;</span><span class="p">,</span> <span class="s1">&#39;weak_dd&#39;</span><span class="p">,</span> <span class="s1">&#39;weak_dd&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="ThreeDatabases.define_supermodelchems"><a class="viewcode-back" href="../../autodoc_driver.html#qcdb.dbwrap.ThreeDatabases.define_supermodelchems">[docs]</a>    <span class="k">def</span> <span class="nf">define_supermodelchems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-adz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-adz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-adtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-adtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-adtzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-adtzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-adtzadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atzadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atzadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzatz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSD-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzhatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSD-CP-atqzatz&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-adz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-adz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-hadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-adz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-hatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-adtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-adtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-hadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-adtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-adtzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-adtzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-adtzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-adtzadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atzadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzadz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzhadz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzadz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atzadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzadtz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzhadtz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzadtz&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzatz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCSDT-CP-atqzatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzhatz&#39;</span><span class="p">,</span> <span class="s1">&#39;CCSDT-CP-atqzatz&#39;</span><span class="p">]</span></div></div>

<span class="c1"># print certain statistic for all 4 db and summary and indiv sys if min or max</span>

<span class="n">fnreservoir</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">fnreservoir</span><span class="p">[</span><span class="s1">&#39;blankslat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;Errors with respect to Benchmark. Guide lines are at 0, 0.3, and 1.0 kcal/mol overbound ($-$) and underbound ($+$).&quot;&quot;&quot;</span>
<span class="n">fnreservoir</span><span class="p">[</span><span class="s1">&#39;5min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;Only equilibrium and near-equilibrium systems included. (All S22 and HSG, 50/194 NBC10, 28/118 HBC6.)&quot;&quot;&quot;</span>
<span class="n">fnreservoir</span><span class="p">[</span><span class="s1">&#39;liliowa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;{0}MAE (dark by {1} kcal/mol) for subsets in residue classes cation, anion, polar, aliphatic, \&amp; aromatic (L to R).&quot;&quot;&quot;</span>
<span class="n">fnreservoir</span><span class="p">[</span><span class="s1">&#39;flat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">r&quot;&quot;&quot;{0}Errors with respect to benchmark within $\pm${1} kcal/mol. Guide lines are at {2} overbound ($-$) and underbound ($+$).&quot;&quot;&quot;</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../contents.html" title="Table Of Contents"
             >toc</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">Psi4 [1.0.0 6a9a71b]</a> &raquo; </li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, The Psi4 Project.
      Last updated on Tuesday, 05 July 2016 02:54AM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
    <!-- cloud_sptheme 1.3 -->
  </body>
</html>