


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>functional &mdash; PSI4 [beta2] documentation</title>
    
    <link rel="stylesheet" href="../_static/psi4.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'beta2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/toggle_sections.js"></script>
    <link rel="top" title="PSI4 [beta2] documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
    <script type="text/javascript" src="../_static/copybutton.js"></script> 

  </head>
  <body>
    <div class="relbar-top">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
    <li><a href="../index.html">PSI4 [beta2]</a> &raquo; </li>

          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for functional</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module to provide lightweight definitions of functionals and</span>
<span class="sd">SuperFunctionals</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">PsiMod</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">psiexceptions</span> <span class="kn">import</span> <span class="o">*</span>


<span class="c">## ==&gt; Functionals &lt;== ##</span>


<div class="viewcode-block" id="build_s_x_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_s_x_functional">[docs]</a><span class="k">def</span> <span class="nf">build_s_x_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;S_X&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;S_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    Slater LSDA Exchange</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    J.C. Slater, Phys. Rev., 81(3):385-390, 1951</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_b88_x_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_b88_x_functional">[docs]</a><span class="k">def</span> <span class="nf">build_b88_x_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;B88_X&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B88_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    Becke88 GGA Exchange</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    A.D. Becke, Phys. Rev. A, 38(6):3098-3100, 1988</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B88_d&#39;</span><span class="p">,</span> <span class="mf">0.0042</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B88_a&#39;</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_b3_x_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_b3_x_functional">[docs]</a><span class="k">def</span> <span class="nf">build_b3_x_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;B88_X&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B3_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    Becke88 GGA Exchange (B3LYP weighting)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    P.J. Stephens et. al., J. Phys. Chem., 98, 11623-11627, 1994</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B88_d&#39;</span><span class="p">,</span> <span class="mf">0.0042</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B88_a&#39;</span><span class="p">,</span> <span class="mf">0.9000</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_pbe_x_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_pbe_x_functional">[docs]</a><span class="k">def</span> <span class="nf">build_pbe_x_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;PBE_X&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;PBE_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBE GGA Exchange Hole (Parameter Free)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    J.P. Perdew et. al., Phys. Rev. Lett., 77(18), 3865-3868, 1996</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PBE_kp&#39;</span><span class="p">,</span> <span class="mf">0.804</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PBE_mu&#39;</span><span class="p">,</span> <span class="mf">0.2195149727645171</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_pbesol_x_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_pbesol_x_functional">[docs]</a><span class="k">def</span> <span class="nf">build_pbesol_x_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;PBE_X&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;PBEsol_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBEsol GGA Exchange Hole (Parameter Free)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    J.P. Perdew et. al., Phys. Rev. Lett., 77(18), 3865-3868, 1996</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PBE_kp&#39;</span><span class="p">,</span> <span class="mf">0.804</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PBE_mu&#39;</span><span class="p">,</span> <span class="mf">10.0</span> <span class="o">/</span> <span class="mf">81.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_pw91_x_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_pw91_x_functional">[docs]</a><span class="k">def</span> <span class="nf">build_pw91_x_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;PW91_X&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;PW91_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PW91 Parameterized GGA Exchange</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    J.P. Perdew et. al., Phys. Rev. B., 46(11), 6671-6687, 1992</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">k01</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">6.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
    <span class="n">k02</span> <span class="o">=</span> <span class="n">k01</span> <span class="o">*</span> <span class="n">k01</span>
    <span class="n">k04</span> <span class="o">=</span> <span class="n">k02</span> <span class="o">*</span> <span class="n">k02</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PW91_a1&#39;</span><span class="p">,</span> <span class="mf">0.19645</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">k01</span><span class="p">))</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PW91_a2&#39;</span><span class="p">,</span> <span class="mf">7.79560</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">k01</span><span class="p">))</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PW91_a3&#39;</span><span class="p">,</span> <span class="mf">0.27430</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">k02</span><span class="p">))</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PW91_a4&#39;</span><span class="p">,</span> <span class="mf">0.15080</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">k02</span><span class="p">))</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PW91_a5&#39;</span><span class="p">,</span> <span class="mf">100.000</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">k02</span><span class="p">))</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PW91_a6&#39;</span><span class="p">,</span> <span class="mf">0.00400</span> <span class="o">/</span> <span class="p">(</span><span class="mf">16.0</span> <span class="o">*</span> <span class="n">k04</span><span class="p">))</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_b97_x_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_b97_x_functional">[docs]</a><span class="k">def</span> <span class="nf">build_b97_x_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;B97_X&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    B97 Parameterized GGA Exchange</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    A.D. Becke, J. Chem. Phys., 107(20), 8554-8560, 1997</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_vwn5_c_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_vwn5_c_functional">[docs]</a><span class="k">def</span> <span class="nf">build_vwn5_c_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;VWN5_C&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;VWN5_C&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    VWN5 LSDA Correlation</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    S.H. Vosko, L. Wilk, and M. Nusair, Can. J. Phys., 58, 1200-1211, 1980</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10498</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_3&#39;</span><span class="p">,</span> <span class="mf">3.72744</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_4&#39;</span><span class="p">,</span> <span class="mf">12.9352</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32500</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_3&#39;</span><span class="p">,</span> <span class="mf">7.06042</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_4&#39;</span><span class="p">,</span> <span class="mf">18.0578</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ac_2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00475840</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ac_3&#39;</span><span class="p">,</span> <span class="mf">1.13107</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ac_4&#39;</span><span class="p">,</span> <span class="mf">13.0045</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_vwn5rpa_c_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_vwn5rpa_c_functional">[docs]</a><span class="k">def</span> <span class="nf">build_vwn5rpa_c_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;VWN5_C&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;VWN5RPA_C&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    VWN5 (RPA) LSDA Correlation</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    S.H. Vosko, L. Wilk, and M. Nusair, Can. J. Phys., 58, 1200-1211, 1980</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.409286</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_3&#39;</span><span class="p">,</span> <span class="mf">13.0720</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_4&#39;</span><span class="p">,</span> <span class="mf">42.7198</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.743294</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_3&#39;</span><span class="p">,</span> <span class="mf">20.1231</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_4&#39;</span><span class="p">,</span> <span class="mf">101.578</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ac_2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.228344</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ac_3&#39;</span><span class="p">,</span> <span class="mf">1.06835</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ac_4&#39;</span><span class="p">,</span> <span class="mf">11.4813</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_vwn3_c_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_vwn3_c_functional">[docs]</a><span class="k">def</span> <span class="nf">build_vwn3_c_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;VWN3_C&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;VWN3_C&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    VWN3 LSDA Correlation</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    S.H. Vosko, L. Wilk, and M. Nusair, Can. J. Phys., 58, 1200-1211, 1980</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10498</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_3&#39;</span><span class="p">,</span> <span class="mf">3.72744</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_4&#39;</span><span class="p">,</span> <span class="mf">12.9352</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32500</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_3&#39;</span><span class="p">,</span> <span class="mf">7.06042</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_4&#39;</span><span class="p">,</span> <span class="mf">18.0578</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_vwn3rpa_c_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_vwn3rpa_c_functional">[docs]</a><span class="k">def</span> <span class="nf">build_vwn3rpa_c_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;VWN3_C&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;VWN3RPA_C&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    VWN3 (RPA) LSDA Correlation</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    S.H. Vosko, L. Wilk, and M. Nusair, Can. J. Phys., 58, 1200-1211, 1980</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.409286</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_3&#39;</span><span class="p">,</span> <span class="mf">13.0720</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcP_4&#39;</span><span class="p">,</span> <span class="mf">42.7198</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.743294</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_3&#39;</span><span class="p">,</span> <span class="mf">20.1231</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;EcF_4&#39;</span><span class="p">,</span> <span class="mf">101.578</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_ws_x_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_ws_x_functional">[docs]</a><span class="k">def</span> <span class="nf">build_ws_x_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;wS_X&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wS_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    Slater Short-Range LSDA Exchange</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Adamson et. al., J. Comput. Chem., 20(9), 921-927, 1999</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_wpbe_x_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wpbe_x_functional">[docs]</a><span class="k">def</span> <span class="nf">build_wpbe_x_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;wPBE_X&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wPBE_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBE Short-Range GGA Exchange (HJS Formalism)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Henderson et. al., J. Chem. Phys., 128, 194105, 2008</span><span class="se">\n</span><span class="s">    Weintraub, Henderson, and Scuseria, J. Chem. Theory. Comput., 5, 754 (2009)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span>  <span class="mf">0.7572110</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1063640</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1186490</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;D&#39;</span><span class="p">,</span>  <span class="mf">0.6096500</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;E&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0477963</span><span class="p">)</span>

    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha0&#39;</span><span class="p">,</span>  <span class="mf">0.0000000</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha1&#39;</span><span class="p">,</span>  <span class="mf">0.0000000</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha2&#39;</span><span class="p">,</span>  <span class="mf">0.0159941</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha3&#39;</span><span class="p">,</span>  <span class="mf">0.0852995</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1603680</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha5&#39;</span><span class="p">,</span>  <span class="mf">0.1526450</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha6&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0971263</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha7&#39;</span><span class="p">,</span>  <span class="mf">0.0422061</span><span class="p">)</span>

    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb0&#39;</span><span class="p">,</span>  <span class="mf">1.0000000</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb1&#39;</span><span class="p">,</span>  <span class="mf">5.3331900</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.478000</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb3&#39;</span><span class="p">,</span>  <span class="mf">11.098800</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.1101300</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb5&#39;</span><span class="p">,</span>  <span class="mf">1.7146800</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb6&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6103800</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb7&#39;</span><span class="p">,</span>  <span class="mf">0.3075550</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb8&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0770547</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb9&#39;</span><span class="p">,</span>  <span class="mf">0.0334840</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_wpbesol_x_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wpbesol_x_functional">[docs]</a><span class="k">def</span> <span class="nf">build_wpbesol_x_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;wPBE_X&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wPBEsol_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBEsol Short-Range GGA Exchange (HJS Formalism)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Henderson et. al., J. Chem. Phys., 128, 194105, 2008</span><span class="se">\n</span><span class="s">    Weintraub, Henderson, and Scuseria, J. Chem. Theory. Comput., 5, 754 (2009)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span>  <span class="mf">0.7572110</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1063640</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1186490</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;D&#39;</span><span class="p">,</span>  <span class="mf">0.6096500</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;E&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0477963</span><span class="p">)</span>

    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha0&#39;</span><span class="p">,</span>  <span class="mf">0.0000000</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha1&#39;</span><span class="p">,</span>  <span class="mf">0.0000000</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha2&#39;</span><span class="p">,</span>  <span class="mf">0.0047333</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha3&#39;</span><span class="p">,</span>  <span class="mf">0.0403304</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0574615</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha5&#39;</span><span class="p">,</span>  <span class="mf">0.0435395</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha6&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0216251</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha7&#39;</span><span class="p">,</span>  <span class="mf">0.0063721</span><span class="p">)</span>

    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb0&#39;</span><span class="p">,</span>  <span class="mf">1.00000</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb1&#39;</span><span class="p">,</span>  <span class="mf">8.52056</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.9885</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb3&#39;</span><span class="p">,</span>  <span class="mf">9.28583</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.27287</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb5&#39;</span><span class="p">,</span>  <span class="mf">0.843499</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb6&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.235543</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb7&#39;</span><span class="p">,</span>  <span class="mf">0.0847074</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb8&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0171561</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb9&#39;</span><span class="p">,</span>  <span class="mf">0.0050552</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_wb88_x_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wb88_x_functional">[docs]</a><span class="k">def</span> <span class="nf">build_wb88_x_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="s">&#39;wB88_X&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wB88_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    B88 Short-Range GGA Exchange (HJS Formalism)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Henderson et. al., J. Chem. Phys., 128, 194105, 2008</span><span class="se">\n</span><span class="s">    Weintraub, Henderson, and Scuseria, J. Chem. Theory. Comput., 5, 754 (2009)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c"># Custom parameters</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span>  <span class="mf">0.7572110</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1063640</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1186490</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;D&#39;</span><span class="p">,</span>  <span class="mf">0.6096500</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;E&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0477963</span><span class="p">)</span>

    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha0&#39;</span><span class="p">,</span>  <span class="mf">0.0000000</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha1&#39;</span><span class="p">,</span>  <span class="mf">0.0000000</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha2&#39;</span><span class="p">,</span>  <span class="mf">0.0253933</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0673075</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha4&#39;</span><span class="p">,</span>  <span class="mf">0.0891476</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha5&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0454168</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha6&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0076581</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Ha7&#39;</span><span class="p">,</span>  <span class="mf">0.0142506</span><span class="p">)</span>

    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb0&#39;</span><span class="p">,</span>  <span class="mf">1.00000</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.65060</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb2&#39;</span><span class="p">,</span>  <span class="mf">3.91108</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.31509</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb4&#39;</span><span class="p">,</span>  <span class="mf">1.54485</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb5&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.198386</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb6&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.136112</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb7&#39;</span><span class="p">,</span>  <span class="mf">0.0647862</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb8&#39;</span><span class="p">,</span>  <span class="mf">0.0159586</span><span class="p">)</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Hb9&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.45066E-4</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

</div>
<div class="viewcode-block" id="build_primitive_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_primitive_functional">[docs]</a><span class="k">def</span> <span class="nf">build_primitive_functional</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;W&#39;</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s">&#39;w&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="n">build_base</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">description</span><span class="p">())</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">citation</span><span class="p">())</span>

    <span class="c"># These should be set by build_base, but prove that you know what&#39;s up</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_gga</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">is_gga</span><span class="p">())</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_meta</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">is_meta</span><span class="p">())</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">alpha</span><span class="p">())</span>
    <span class="n">fun</span><span class="o">.</span><span class="n">set_omega</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">omega</span><span class="p">())</span>

    <span class="c"># Custom parameters</span>
    <span class="c"># Always built-in for this functional</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="k">return</span> <span class="n">fun</span>

<span class="c"># Functional lookup table</span></div>
<span class="n">functionals</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;s_x&#39;</span>         <span class="p">:</span> <span class="n">build_s_x_functional</span><span class="p">,</span>
        <span class="s">&#39;b88_x&#39;</span>       <span class="p">:</span> <span class="n">build_b88_x_functional</span><span class="p">,</span>
        <span class="s">&#39;b3_x&#39;</span>        <span class="p">:</span> <span class="n">build_b3_x_functional</span><span class="p">,</span>
        <span class="s">&#39;pbe_x&#39;</span>       <span class="p">:</span> <span class="n">build_pbe_x_functional</span><span class="p">,</span>
        <span class="s">&#39;pbesol_x&#39;</span>    <span class="p">:</span> <span class="n">build_pbesol_x_functional</span><span class="p">,</span>
        <span class="s">&#39;pw91_x&#39;</span>      <span class="p">:</span> <span class="n">build_pw91_x_functional</span><span class="p">,</span>
        <span class="s">&#39;b97_x&#39;</span>       <span class="p">:</span> <span class="n">build_b97_x_functional</span><span class="p">,</span>
        <span class="s">&#39;ws_x&#39;</span>        <span class="p">:</span> <span class="n">build_ws_x_functional</span><span class="p">,</span>
        <span class="s">&#39;wb97_x&#39;</span>      <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
        <span class="s">&#39;wpbe_x&#39;</span>      <span class="p">:</span> <span class="n">build_wpbe_x_functional</span><span class="p">,</span>
        <span class="s">&#39;wpbesol_x&#39;</span>   <span class="p">:</span> <span class="n">build_wpbesol_x_functional</span><span class="p">,</span>
        <span class="s">&#39;wb88_x&#39;</span>      <span class="p">:</span> <span class="n">build_wb88_x_functional</span><span class="p">,</span>
        <span class="s">&#39;ft97b_x&#39;</span>     <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
        <span class="s">&#39;m_x&#39;</span>         <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
        <span class="s">&#39;lyp_c&#39;</span>       <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
        <span class="s">&#39;pz81_c&#39;</span>      <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
        <span class="s">&#39;p86_c&#39;</span>       <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
        <span class="s">&#39;vwn5rpa_c&#39;</span>   <span class="p">:</span> <span class="n">build_vwn5rpa_c_functional</span><span class="p">,</span>
        <span class="s">&#39;vwn5_c&#39;</span>      <span class="p">:</span> <span class="n">build_vwn5_c_functional</span><span class="p">,</span>
        <span class="s">&#39;vwn3rpa_c&#39;</span>   <span class="p">:</span> <span class="n">build_vwn3rpa_c_functional</span><span class="p">,</span>
        <span class="s">&#39;vwn3_c&#39;</span>      <span class="p">:</span> <span class="n">build_vwn3_c_functional</span><span class="p">,</span>
        <span class="s">&#39;pw91_c&#39;</span>      <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
        <span class="s">&#39;pw92_c&#39;</span>      <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
        <span class="s">&#39;pbe_c&#39;</span>       <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
        <span class="s">&#39;ft97_c&#39;</span>      <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
        <span class="s">&#39;b_c&#39;</span>         <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
        <span class="s">&#39;m_c&#39;</span>         <span class="p">:</span> <span class="n">build_primitive_functional</span><span class="p">,</span>
    <span class="p">}</span>


<div class="viewcode-block" id="build_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_functional">[docs]</a><span class="k">def</span> <span class="nf">build_functional</span><span class="p">(</span><span class="n">alias</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">alias</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">functionals</span><span class="p">[</span><span class="n">name</span><span class="p">](</span><span class="n">name</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="functional_list"><a class="viewcode-back" href="../autodoc_driver.html#functional.functional_list">[docs]</a><span class="k">def</span> <span class="nf">functional_list</span><span class="p">():</span>
    <span class="n">val</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">functionals</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">functionals</span><span class="p">[</span><span class="n">key</span><span class="p">](</span><span class="n">key</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">val</span>

<span class="c">## ==&gt; SuperFunctionals &lt;== ##</span>

</div>
<div class="viewcode-block" id="build_ws_x_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_ws_x_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_ws_x_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wS_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    Slater Short-Range LSDA Exchange</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Adamson et. al., J. Comput. Chem., 20(9), 921-927, 1999</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;wS_X&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_wpbe_x_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wpbe_x_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wpbe_x_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wPBE_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBE Short-Range GGA Exchange (HJS Model)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Henderson et. al., J. Chem. Phys., 128, 194105, 2008</span><span class="se">\n</span><span class="s">    Weintraub, Henderson, and Scuseria, J. Chem. Theory. Comput., 5, 754 (2009)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;wPBE_X&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_wpbesol_x_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wpbesol_x_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wpbesol_x_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wPBEsol_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBEsol Short-Range GGA Exchange (HJS Model)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Henderson et. al., J. Chem. Phys., 128, 194105, 2008</span><span class="se">\n</span><span class="s">    Weintraub, Henderson, and Scuseria, J. Chem. Theory. Comput., 5, 754 (2009)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;wPBEsol_X&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_wb88_x_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wb88_x_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wb88_x_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wB88_X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    B88 Short-Range GGA Exchange (HJS Model)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Henderson et. al., J. Chem. Phys., 128, 194105, 2008</span><span class="se">\n</span><span class="s">    Weintraub, Henderson, and Scuseria, J. Chem. Theory. Comput., 5, 754 (2009)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;wB88_X&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_svwn_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_svwn_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_svwn_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;SVWN&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    SVWN3 (RPA) LSDA Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Adamson et. al., J. Comput. Chem., 20(9), 921-927, 1999</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;S_X&#39;</span><span class="p">))</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;VWN3RPA_C&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_blyp_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_blyp_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_blyp_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;BLYP&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    BLYP GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    P.J. Stephens et. al., J. Phys. Chem., 98, 11623-11627, 1994</span><span class="se">\n</span><span class="s">    B. Miehlich et. al., Chem. Phys. Lett., 157(3), 200-206 1989</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B88_X&#39;</span><span class="p">))</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;LYP_C&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_pw91_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_pw91_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_pw91_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;PW91&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PW91 GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    J.P. Perdew et. al., Phys. Rev. B., 46(11), 6671-6687, 1992</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;PW91_X&#39;</span><span class="p">))</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;PW91_C&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_bp86_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_bp86_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_bp86_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;BP86&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    BP86 GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Null</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B88_X&#39;</span><span class="p">))</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;P86_C&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_ft97_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_ft97_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_ft97_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;FT97&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;   FT97 GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    M. Filatov and W. Theil, Int. J. Quant. Chem., 62, 603-616, 1997</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;FT97B_X&#39;</span><span class="p">))</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;FT97_C&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_pbe_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_pbe_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_pbe_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;PBE&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBE GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    J.P. Perdew et. al., Phys. Rev. Lett., 77(18), 3865-3868, 1996</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;PBE_X&#39;</span><span class="p">))</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;PBE_C&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_pbe0_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_pbe0_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_pbe0_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="n">sup</span> <span class="o">=</span> <span class="n">build_pbe_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;PBE0&#39;</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBE0 Hybrid GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_b3lyp_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_b3lyp_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_b3lyp_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B3LYP&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    B3LYP Hybrid-GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    P.J. Stephens et. al., J. Phys. Chem., 98, 11623-11627, 1994</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">b3</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B3_X&#39;</span><span class="p">)</span>
    <span class="n">b3</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">b3</span><span class="p">)</span>
    <span class="n">lyp</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;LYP_C&#39;</span><span class="p">)</span>
    <span class="n">lyp</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.81</span><span class="p">)</span>
    <span class="n">vwn</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;VWN3RPA_C&#39;</span><span class="p">)</span>
    <span class="n">vwn</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.19</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">vwn</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">lyp</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_b3lyp5_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_b3lyp5_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_b3lyp5_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B3LYP5&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    B3LYP5 Hybrid-GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    P.J. Stephens et. al., J. Phys. Chem., 98, 11623-11627, 1994</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">b3</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B3_X&#39;</span><span class="p">)</span>
    <span class="n">b3</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">b3</span><span class="p">)</span>
    <span class="n">lyp</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;LYP_C&#39;</span><span class="p">)</span>
    <span class="n">lyp</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.81</span><span class="p">)</span>
    <span class="n">vwn</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;VWN5RPA_C&#39;</span><span class="p">)</span>
    <span class="n">vwn</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.19</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">lyp</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">vwn</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_b970_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_b970_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_b970_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-0&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    B97-0 Hybrid-GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    A.D. Becke, J. Chem. Phys., 107(20), 8554-8560, 1997</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-0_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">0.8057</span><span class="p">)</span>

    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a0&#39;</span><span class="p">,</span> <span class="mf">0.8094</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a1&#39;</span><span class="p">,</span> <span class="mf">0.5073</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a2&#39;</span><span class="p">,</span> <span class="mf">0.7481</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-0_C&#39;</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">0.9454</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">0.7471</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.5961</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">0.1737</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="mf">2.3487</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4868</span><span class="p">)</span>

    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.1943</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_b971_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_b971_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_b971_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-1&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    B97-1 Hybrid-GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    F.A. Hamprecht et. al., J. Chem. Phys., 109(15), 6264-6271, 1998</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-1_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">0.79</span><span class="p">)</span>

    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a0&#39;</span><span class="p">,</span> <span class="mf">0.789518</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a1&#39;</span><span class="p">,</span> <span class="mf">0.573805</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a2&#39;</span><span class="p">,</span> <span class="mf">0.660975</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-1_C&#39;</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">0.955689</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">0.788552</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.47869</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">0.0820011</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="mf">2.71681</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.87103</span><span class="p">)</span>

    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.21</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_b972_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_b972_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_b972_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-2&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    B97-2 Hybrid-GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    P.J. Wilson et. al., J. Chem. Phys., 115(20), 9233-9242, 2001</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-2_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">0.79</span><span class="p">)</span>

    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a0&#39;</span><span class="p">,</span> <span class="mf">0.827642</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a1&#39;</span><span class="p">,</span> <span class="mf">0.047840</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a2&#39;</span><span class="p">,</span> <span class="mf">1.761250</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-2_C&#39;</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">0.999849</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">1.40626</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.44060</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">0.585808</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.691682</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="mf">0.394796</span><span class="p">)</span>

    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.21</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_b97d_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_b97d_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_b97d_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-D&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    B97-D Pure-GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    S. Grimme, J. Comput. Chem., 27, 1787-1799, 2006</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-D_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a0&#39;</span><span class="p">,</span> <span class="mf">1.08662</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.52127</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a2&#39;</span><span class="p">,</span> <span class="mf">3.25429</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B97-D_C&#39;</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">0.69041</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">6.30270</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.9712</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">0.22340</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.56208</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="mf">3.25429</span><span class="p">)</span>

    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># =&gt; -D2 (s = 1.25) &lt;= #</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_dispersion</span><span class="p">(</span><span class="n">PsiMod</span><span class="o">.</span><span class="n">Dispersion</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s">&#39;-D2&#39;</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_hcth_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_hcth_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_hcth_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    HCTH Pure-GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    F.A. Hamprecht et. al., J. Chem. Phys., 109(15), 6264-6271</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a0&#39;</span><span class="p">,</span> <span class="mf">1.09320</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.744056</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a2&#39;</span><span class="p">,</span> <span class="mf">5.59920</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.78549</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a4&#39;</span><span class="p">,</span> <span class="mf">4.49357</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH_C&#39;</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">0.729974</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">3.35287</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.5430</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a3&#39;</span><span class="p">,</span> <span class="mf">8.08564</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.47857</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">0.222601</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0338622</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0125170</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.802496</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a4&#39;</span><span class="p">,</span> <span class="mf">1.55396</span><span class="p">)</span>

    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_hcth120_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_hcth120_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_hcth120_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH120&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    HCTH120 Pure-GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    A.D. Boese, et. al., J. Chem. Phys., 112(4), 1670-1678, 2000</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH120_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a0&#39;</span><span class="p">,</span> <span class="mf">1.09163</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.747215</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a2&#39;</span><span class="p">,</span> <span class="mf">5.07833</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.10746</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a4&#39;</span><span class="p">,</span> <span class="mf">1.17173</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH120_C&#39;</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">0.514730</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">6.92982</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.7073</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a3&#39;</span><span class="p">,</span> <span class="mf">23.1098</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.3234</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">0.489508</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.260699</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="mf">0.432917</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.99247</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a4&#39;</span><span class="p">,</span> <span class="mf">2.48531</span><span class="p">)</span>

    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_hcth147_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_hcth147_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_hcth147_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH147&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    HCTH147 Pure-GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    A.D. Boese, et. al., J. Chem. Phys., 112(4), 1670-1678, 2000</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH147_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a0&#39;</span><span class="p">,</span> <span class="mf">1.09025</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.799194</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a2&#39;</span><span class="p">,</span> <span class="mf">5.57212</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.86760</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a4&#39;</span><span class="p">,</span> <span class="mf">3.04544</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH147_C&#39;</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">0.542352</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">7.01464</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.3822</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a3&#39;</span><span class="p">,</span> <span class="mf">35.0329</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.4284</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">0.562576</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="mf">0.0171436</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.30636</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a3&#39;</span><span class="p">,</span> <span class="mf">1.05747</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a4&#39;</span><span class="p">,</span> <span class="mf">0.885429</span><span class="p">)</span>

    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_hcth407_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_hcth407_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_hcth407_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH407&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    HCTH407 Pure-GGA Exchange-Correlation Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    A.D. Boese and N.C. Handy, J. Chem. Phys., 114(13), 5497-5503, 2001</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH407_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a0&#39;</span><span class="p">,</span> <span class="mf">1.08184</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.518339</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a2&#39;</span><span class="p">,</span> <span class="mf">3.42562</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.62901</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a4&#39;</span><span class="p">,</span> <span class="mf">2.28855</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;HCTH407_C&#39;</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">0.589076</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">4.42374</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.2218</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a3&#39;</span><span class="p">,</span> <span class="mf">42.5721</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">42.0052</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">1.18777</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.40292</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="mf">5.61741</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.17923</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a4&#39;</span><span class="p">,</span> <span class="mf">6.24798</span><span class="p">)</span>

    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_blypd_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_blypd_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_blypd_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="n">sup</span> <span class="o">=</span> <span class="n">build_blyp_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;BLYP-D&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; -D2 &lt;= #</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_dispersion</span><span class="p">(</span><span class="n">PsiMod</span><span class="o">.</span><span class="n">Dispersion</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s">&#39;-D2&#39;</span><span class="p">,</span> <span class="mf">1.20</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_b3lypd_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_b3lypd_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_b3lypd_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="n">sup</span> <span class="o">=</span> <span class="n">build_b3lyp_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B3LYP-D&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; -D2 &lt;= #</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_dispersion</span><span class="p">(</span><span class="n">PsiMod</span><span class="o">.</span><span class="n">Dispersion</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s">&#39;-D2&#39;</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_b3lyp5d_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_b3lyp5d_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_b3lyp5d_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="n">sup</span> <span class="o">=</span> <span class="n">build_b3lyp5_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;B3LYP5-D&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; -D2 &lt;= #</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_dispersion</span><span class="p">(</span><span class="n">PsiMod</span><span class="o">.</span><span class="n">Dispersion</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s">&#39;-D2&#39;</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_bp86d_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_bp86d_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_bp86d_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="n">sup</span> <span class="o">=</span> <span class="n">build_bp86_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;BP86-D&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; -D2 &lt;= #</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_dispersion</span><span class="p">(</span><span class="n">PsiMod</span><span class="o">.</span><span class="n">Dispersion</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s">&#39;-D2&#39;</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_pbed_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_pbed_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_pbed_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="n">sup</span> <span class="o">=</span> <span class="n">build_pbe_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;PBE-D&#39;</span><span class="p">)</span>

    <span class="c"># =&gt; -D2 &lt;= #</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_dispersion</span><span class="p">(</span><span class="n">PsiMod</span><span class="o">.</span><span class="n">Dispersion</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s">&#39;-D2&#39;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_wsvwn_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wsvwn_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wsvwn_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wSVWN&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    LSDA SR-XC Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Adamson et. al., J. Comput. Chem., 20(9), 921-927, 1999</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;wS_X&#39;</span><span class="p">))</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;VWN3RPA_C&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_wpbe_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wpbe_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wpbe_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wPBE&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBE SR-XC Functional (HJS Model)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Henderson et. al., J. Chem. Phys., 128, 194105, 2008</span><span class="se">\n</span><span class="s">    Weintraub, Henderson, and Scuseria, J. Chem. Theory. Comput., 5, 754 (2009)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;wPBE_X&#39;</span><span class="p">))</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;PBE_C&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_wpbe0_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wpbe0_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wpbe0_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="n">sup</span> <span class="o">=</span> <span class="n">build_wpbe_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wPBE0&#39;</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBE0 SR-XC Functional (HJS Model)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_wpbesol_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wpbesol_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wpbesol_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wPBEsol&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBEsol SR-XC Functional (HJS Model)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Henderson et. al., J. Chem. Phys., 128, 194105, 2008</span><span class="se">\n</span><span class="s">    Weintraub, Henderson, and Scuseria, J. Chem. Theory. Comput., 5, 754 (2009)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;wPBEsol_X&#39;</span><span class="p">))</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;PBE_C&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_wpbesol0_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wpbesol0_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wpbesol0_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="n">sup</span> <span class="o">=</span> <span class="n">build_wpbesol_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wPBEsol0&#39;</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    PBEsol0 SR-XC Functional (HJS Model)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_wblyp_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wblyp_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wblyp_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wBLYP&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    BLYP SR-XC Functional (HJS Model)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Henderson et. al., J. Chem. Phys., 128, 194105, 2008</span><span class="se">\n</span><span class="s">    Weintraub, Henderson, and Scuseria, J. Chem. Theory. Comput., 5, 754 (2009)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;wB88_X&#39;</span><span class="p">))</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;LYP_C&#39;</span><span class="p">))</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_wb97_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wb97_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wb97_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wB97&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    Parameterized LRC B97 GGA XC Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    J.-D. Chai and M. Head-Gordon, J. Chem. Phys., 128, 084106, 2008</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;wB97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wB97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a0&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a1&#39;</span><span class="p">,</span> <span class="mf">1.13116E0</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.74915E0</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a3&#39;</span><span class="p">,</span> <span class="mf">1.20900E1</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.71642E0</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wB97_C&#39;</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">3.99051E0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.70066E1</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a3&#39;</span><span class="p">,</span> <span class="mf">1.07292E0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a4&#39;</span><span class="p">,</span> <span class="mf">8.88211E0</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.55352E0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="mf">1.18926E1</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.69452E1</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a4&#39;</span><span class="p">,</span> <span class="mf">1.70927E1</span><span class="p">)</span>

    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_wb97x_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wb97x_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wb97x_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wB97X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    Parameterized Hybrid LRC B97 GGA XC Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    J.-D. Chai and M. Head-Gordon, J. Chem. Phys., 128, 084106, 2008</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;wB97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wB97X_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.157706</span><span class="p">))</span>

    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a0&#39;</span><span class="p">,</span> <span class="mf">8.42294E-1</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a1&#39;</span><span class="p">,</span> <span class="mf">7.26479E-1</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a2&#39;</span><span class="p">,</span> <span class="mf">1.04760E0</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.70635E0</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a4&#39;</span><span class="p">,</span> <span class="mf">1.32794E1</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wB97X_C&#39;</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">2.37031E0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.13995E1</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a3&#39;</span><span class="p">,</span> <span class="mf">6.58405E0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.78132E0</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.33879E0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="mf">1.82308E1</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.17430E1</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a4&#39;</span><span class="p">,</span> <span class="mf">1.72901E1</span><span class="p">)</span>

    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.157706</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>
</div>
<div class="viewcode-block" id="build_wb97xd_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_wb97xd_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_wb97xd_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wB97X-D&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    Parameterized Hybrid LRC B97 GGA XC Functional with Dispersion</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    J.-D. Chai and M. Head-Gordon, Phys. Chem. Chem. Phys., 10, 6615-6620, 2008</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">2.22036E-1</span><span class="p">;</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;wB97_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wB97X_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">))</span>

    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_gamma&#39;</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a0&#39;</span><span class="p">,</span> <span class="mf">7.77964E-1</span><span class="p">)</span>    <span class="c"># Table 1: c_{x\sigma,0}</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a1&#39;</span><span class="p">,</span> <span class="mf">6.61160E-1</span><span class="p">)</span>    <span class="c"># Table 1: c_{x\sigma,1}</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a2&#39;</span><span class="p">,</span> <span class="mf">5.74541E-1</span><span class="p">)</span>    <span class="c"># Table 1: c_{x\sigma,2}</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.25671E0</span><span class="p">)</span>    <span class="c"># Table 1: c_{x\sigma,3}</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_a4&#39;</span><span class="p">,</span> <span class="mf">1.16386E1</span><span class="p">)</span>     <span class="c"># Table 1: c_{x\sigma,4}</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;B_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;wB97X_C&#39;</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>        <span class="c"># Table 1: c_{c\alpha\beta,0}</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">1.79413E0</span><span class="p">)</span>  <span class="c"># Table 1: c_{c\alpha\beta,1}</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.20477E1</span><span class="p">)</span> <span class="c"># Table 1: c_{c\alpha\beta,2}</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a3&#39;</span><span class="p">,</span> <span class="mf">1.40847E1</span><span class="p">)</span>  <span class="c"># Table 1: c_{c\alpha\beta,3}</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.50809E0</span><span class="p">)</span> <span class="c"># Table 1: c_{c\alpha\beta,4}</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>        <span class="c"># Table 1: c_{c\sigma\sigma,0}</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.90539E0</span><span class="p">)</span> <span class="c"># Table 1: c_{c\sigma\sigma,1}</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="mf">3.13343E1</span><span class="p">)</span>  <span class="c"># Table 1: c_{c\sigma\sigma,2}</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.10533E1</span><span class="p">)</span> <span class="c"># Table 1: c_{c\sigma\sigma,3}</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a4&#39;</span><span class="p">,</span> <span class="mf">2.64423E1</span><span class="p">)</span>  <span class="c"># Table 1: c_{c\sigma\sigma,4}</span>

    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>   <span class="c"># Table 1: omega</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>   <span class="c"># Table 1: c_x</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; -D2 (CHG Damping Function) &lt;= #</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_dispersion</span><span class="p">(</span><span class="n">PsiMod</span><span class="o">.</span><span class="n">Dispersion</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s">&#39;-CHG&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_m05_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_m05_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_m05_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;M05&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    Heavily Parameterized Hybrid Meta-GGA XC Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Zhao et. al., J. Chem. Phys., 123, 161103, 2005</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;M_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;M05_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="c"># LSDA Exchange type is Slater, no parameters</span>

    <span class="c"># GGA Exchange type is PBE, special parameters because Truhlar is lazy</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="mf">3.36116E-3</span>  <span class="c"># Should be reported/implemented to more digits</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="mf">4.49267E-3</span>  <span class="c"># Should be reported/implemented to more digits</span>
    <span class="n">K0</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">),</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
    <span class="n">k0</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">6.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
    <span class="n">kp</span> <span class="o">=</span> <span class="n">C1</span> <span class="o">/</span> <span class="p">(</span><span class="n">C2</span> <span class="o">*</span> <span class="n">K0</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">k0</span> <span class="o">*</span> <span class="n">k0</span> <span class="o">*</span> <span class="n">kp</span> <span class="o">*</span> <span class="n">C2</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PBE_kp&#39;</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span>  <span class="c"># Different effective kp</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PBE_mu&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>  <span class="c"># Different effective mu</span>

    <span class="c"># Meta Exchange type is insane mess of w power series expansion</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a0&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a1&#39;</span><span class="p">,</span> <span class="mf">0.08151</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43956</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.22422</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a4&#39;</span><span class="p">,</span> <span class="mf">2.01819</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a5&#39;</span><span class="p">,</span> <span class="mf">8.79431</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a6&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00295</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a7&#39;</span><span class="p">,</span> <span class="mf">9.82029</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a8&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.82351</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a9&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">48.17574</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a10&#39;</span><span class="p">,</span> <span class="mf">3.64802</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a11&#39;</span><span class="p">,</span> <span class="mf">34.02248</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;M_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;M05_C&#39;</span><span class="p">)</span>

    <span class="c"># LSDA Correlation type is PW92, no parameters</span>

    <span class="c"># GGA Correlation type is B97</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.0031</span> <span class="o">*</span> <span class="mf">2.0</span><span class="p">)</span>  <span class="c"># This makes me mad. Truhlar is too lazy to report the B97 gradient expansion formula, but then does not use the canonical definition.</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">3.78569</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.15261</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.46589</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a4&#39;</span><span class="p">,</span> <span class="mf">17.94491</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span> <span class="mf">3.77344</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.04463</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a3&#39;</span><span class="p">,</span> <span class="mf">30.69913</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.22695</span><span class="p">)</span>

    <span class="c"># Meta Correlation type is Becke metric, no parameters</span>

    <span class="c"># Add the functionals in</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.28</span><span class="p">)</span>  <span class="c"># Hartree-Fock exact exchange</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

</div>
<div class="viewcode-block" id="build_m05_2x_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_m05_2x_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_m05_2x_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;M05-2X&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s">&#39;    Heavily Parameterized Hybrid Meta-GGA XC Functional</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="s">&#39;    Zhao et. al., J. Chem. Theory Comput., 2, 364, 2006</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c"># Add member functionals</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;M_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;M05_2X_X&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="c"># LSDA Exchange type is Slater, no parameters</span>

    <span class="c"># GGA Exchange type is PBE, special parameters because Truhlar is lazy</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="mf">3.36116E-3</span><span class="p">;</span> <span class="c"># Should be reported/implemented to more digits</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="mf">4.49267E-3</span><span class="p">;</span> <span class="c"># Should be reported/implemented to more digits</span>
    <span class="n">K0</span> <span class="o">=</span> <span class="mf">3.0</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">),</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">);</span>
    <span class="n">k0</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">6.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">);</span>
    <span class="n">kp</span> <span class="o">=</span> <span class="n">C1</span> <span class="o">/</span> <span class="p">(</span><span class="n">C2</span> <span class="o">*</span> <span class="n">K0</span><span class="p">);</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">k0</span> <span class="o">*</span> <span class="n">k0</span> <span class="o">*</span> <span class="n">kp</span> <span class="o">*</span> <span class="n">C2</span><span class="p">;</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PBE_kp&#39;</span><span class="p">,</span> <span class="n">kp</span><span class="p">);</span> <span class="c"># Different effective kp</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;PBE_mu&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="p">);</span> <span class="c"># Different effective mu</span>

<span class="c"># Meta Exchange type is insane mess of w power series expansion</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a0&#39;</span> <span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a1&#39;</span> <span class="p">,</span><span class="o">-</span><span class="mf">0.56833</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a2&#39;</span> <span class="p">,</span><span class="o">-</span><span class="mf">1.30057</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a3&#39;</span> <span class="p">,</span> <span class="mf">5.50070</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a4&#39;</span> <span class="p">,</span> <span class="mf">9.06402</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a5&#39;</span> <span class="p">,</span><span class="o">-</span><span class="mf">32.21075</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a6&#39;</span> <span class="p">,</span><span class="o">-</span><span class="mf">23.73298</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a7&#39;</span> <span class="p">,</span> <span class="mf">70.22996</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a8&#39;</span> <span class="p">,</span> <span class="mf">29.88614</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a9&#39;</span> <span class="p">,</span><span class="o">-</span><span class="mf">60.25778</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a10&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">13.22205</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;Meta_a11&#39;</span><span class="p">,</span> <span class="mf">15.23694</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="s">&#39;M_C&#39;</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s">&#39;M05_2X_C&#39;</span><span class="p">)</span>

    <span class="c"># LSDA Correlation type is PW92, no parameters</span>

    <span class="c"># GGA Correlation type is B97</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_gamma&#39;</span><span class="p">,</span> <span class="mf">0.0031</span> <span class="o">*</span> <span class="mf">2.0</span><span class="p">)</span> <span class="c"># This makes me mad. Truhlar is too lazy to report the B97 gradient expansion formula, but then does not use the canonical definition.</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a0&#39;</span><span class="p">,</span> <span class="mf">1.00000</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a1&#39;</span><span class="p">,</span> <span class="mf">1.09297</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">3.79171</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a3&#39;</span><span class="p">,</span> <span class="mf">2.82810</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_os_a4&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">10.58909</span><span class="p">)</span>

    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_gamma&#39;</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a0&#39;</span><span class="p">,</span> <span class="mf">1.00000</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">3.05430</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a2&#39;</span><span class="p">,</span> <span class="mf">7.61854</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a3&#39;</span><span class="p">,</span> <span class="mf">1.47665</span><span class="p">)</span>
    <span class="n">C</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s">&#39;B97_ss_a4&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">11.92365</span><span class="p">)</span>

    <span class="c"># Meta Correlation type is Becke metric, no parameters</span>

    <span class="c"># Add the functionals in</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.56</span><span class="p">)</span> <span class="c"># Hartree-Fock exact exchange</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>
</div>
<div class="viewcode-block" id="build_primitive_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_primitive_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_primitive_superfunctional</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>

    <span class="c"># Call this first</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">SuperFunctional</span><span class="o">.</span><span class="n">blank</span><span class="p">()</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_max_points</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_deriv</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>

    <span class="c"># =&gt; User-Customization &lt;= #</span>

    <span class="n">key</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">build_functional</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="c"># No spaces, keep it short and according to convention</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">description</span><span class="p">())</span>
    <span class="c"># Tab in, trailing newlines</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_citation</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">citation</span><span class="p">())</span>

    <span class="c"># Add member functionals</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;X&#39;</span><span class="p">):</span>
        <span class="n">sup</span><span class="o">.</span><span class="n">add_x_functional</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sup</span><span class="o">.</span><span class="n">add_c_functional</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>

    <span class="c"># Set GKS up after adding functionals</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_omega</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_x_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">set_c_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># =&gt; End User-Customization &lt;= #</span>

    <span class="c"># Call this last</span>
    <span class="n">sup</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sup</span>

<span class="c"># Superfunctional lookup table</span></div>
<span class="n">superfunctionals</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;s_x&#39;</span>       <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;b88_x&#39;</span>     <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;b3_x&#39;</span>      <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;pbe_x&#39;</span>     <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;pbesol_x&#39;</span>  <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;pw91_x&#39;</span>    <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;ws_x&#39;</span>      <span class="p">:</span> <span class="n">build_ws_x_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wpbe_x&#39;</span>    <span class="p">:</span> <span class="n">build_wpbe_x_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wpbesol_x&#39;</span> <span class="p">:</span> <span class="n">build_wpbesol_x_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wb88_x&#39;</span>    <span class="p">:</span> <span class="n">build_wb88_x_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;lyp_c&#39;</span>     <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;ft97b_x&#39;</span>   <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;pz81_c&#39;</span>    <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;p86_c&#39;</span>     <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;pw91_c&#39;</span>    <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;pw92_c&#39;</span>    <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;pbe_c&#39;</span>     <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;ft97_c&#39;</span>    <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;vwn5rpa_c&#39;</span> <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;vwn5_c&#39;</span>    <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;vwn3rpa_c&#39;</span> <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;vwn3_c&#39;</span>    <span class="p">:</span> <span class="n">build_primitive_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;svwn&#39;</span>      <span class="p">:</span> <span class="n">build_svwn_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;blyp&#39;</span>      <span class="p">:</span> <span class="n">build_blyp_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;bp86&#39;</span>      <span class="p">:</span> <span class="n">build_bp86_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;pw91&#39;</span>      <span class="p">:</span> <span class="n">build_pw91_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;pbe&#39;</span>       <span class="p">:</span> <span class="n">build_pbe_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;ft97&#39;</span>      <span class="p">:</span> <span class="n">build_ft97_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;b3lyp&#39;</span>     <span class="p">:</span> <span class="n">build_b3lyp_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;b3lyp5&#39;</span>    <span class="p">:</span> <span class="n">build_b3lyp5_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;pbe0&#39;</span>      <span class="p">:</span> <span class="n">build_pbe0_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;b97-0&#39;</span>     <span class="p">:</span> <span class="n">build_b970_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;b97-1&#39;</span>     <span class="p">:</span> <span class="n">build_b971_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;b97-2&#39;</span>     <span class="p">:</span> <span class="n">build_b972_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;hcth&#39;</span>      <span class="p">:</span> <span class="n">build_hcth_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;hcth120&#39;</span>   <span class="p">:</span> <span class="n">build_hcth120_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;hcth147&#39;</span>   <span class="p">:</span> <span class="n">build_hcth147_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;hcth407&#39;</span>   <span class="p">:</span> <span class="n">build_hcth407_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;blyp-d&#39;</span>    <span class="p">:</span> <span class="n">build_blypd_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;pbe-d&#39;</span>     <span class="p">:</span> <span class="n">build_pbed_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;bp86-d&#39;</span>    <span class="p">:</span> <span class="n">build_bp86_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;b97-d&#39;</span>     <span class="p">:</span> <span class="n">build_b97d_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;b3lyp-d&#39;</span>   <span class="p">:</span> <span class="n">build_b3lypd_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;b3lyp5-d&#39;</span>  <span class="p">:</span> <span class="n">build_b3lyp5d_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wsvwn&#39;</span>     <span class="p">:</span> <span class="n">build_wsvwn_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wpbe&#39;</span>      <span class="p">:</span> <span class="n">build_wpbe_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wpbe0&#39;</span>     <span class="p">:</span> <span class="n">build_wpbe0_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wpbesol&#39;</span>   <span class="p">:</span> <span class="n">build_wpbesol_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wpbesol0&#39;</span>  <span class="p">:</span> <span class="n">build_wpbesol0_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wblyp&#39;</span>     <span class="p">:</span> <span class="n">build_wblyp_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wb97&#39;</span>      <span class="p">:</span> <span class="n">build_wb97_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wb97x&#39;</span>     <span class="p">:</span> <span class="n">build_wb97x_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;wb97x-d&#39;</span>   <span class="p">:</span> <span class="n">build_wb97xd_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;m05&#39;</span>       <span class="p">:</span> <span class="n">build_m05_superfunctional</span><span class="p">,</span>
        <span class="s">&#39;m05-2x&#39;</span>    <span class="p">:</span> <span class="n">build_m05_2x_superfunctional</span><span class="p">,</span>
        <span class="c">#&#39;m06-2x&#39;    : build_m06_2x_superfunctional,</span>
    <span class="p">}</span>


<div class="viewcode-block" id="build_superfunctional"><a class="viewcode-back" href="../autodoc_driver.html#functional.build_superfunctional">[docs]</a><span class="k">def</span> <span class="nf">build_superfunctional</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">alias</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">superfunctionals</span><span class="p">[</span><span class="n">name</span><span class="p">](</span><span class="n">name</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">deriv</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="superfunctional_list"><a class="viewcode-back" href="../autodoc_driver.html#functional.superfunctional_list">[docs]</a><span class="k">def</span> <span class="nf">superfunctional_list</span><span class="p">():</span>
    <span class="n">val</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">superfunctionals</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">superfunctionals</span><span class="p">[</span><span class="n">key</span><span class="p">](</span><span class="n">key</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">val</span>

</div>
<div class="viewcode-block" id="test_ccl_functional"><a class="viewcode-back" href="../autodoc_driver.html#functional.test_ccl_functional">[docs]</a><span class="k">def</span> <span class="nf">test_ccl_functional</span><span class="p">(</span><span class="n">functional</span><span class="p">,</span> <span class="n">ccl_functional</span><span class="p">):</span>

    <span class="n">check</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s">&#39;data_pt_</span><span class="si">%s</span><span class="s">.html&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ccl_functional</span><span class="p">))):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">&#39;wget ftp://ftp.dl.ac.uk/qcg/dft_library/data_pt_</span><span class="si">%s</span><span class="s">.html&#39;</span> <span class="o">%</span> <span class="n">ccl_functional</span><span class="p">)</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;data_pt_</span><span class="si">%s</span><span class="s">.html&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ccl_functional</span><span class="p">))</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">point</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">rho_line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;^\s*rhoa=\s*(-?\d+\.\d+E[+-]\d+)\s*rhob=\s*(-?\d+\.\d+E[+-]\d+)\s*sigmaaa=\s*(-?\d+\.\d+E[+-]\d+)\s*sigmaab=\s*(-?\d+\.\d+E[+-]\d+)\s*sigmabb=\s*(-?\d+\.\d+E[+-]\d+)\s*&#39;</span><span class="p">)</span>
    <span class="n">val_line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;^\s*(\w*)\s*=\s*(-?\d+\.\d+E[+-]\d+)&#39;</span><span class="p">)</span>

    <span class="n">aliases</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;zk&#39;</span>            <span class="p">:</span> <span class="s">&#39;v&#39;</span><span class="p">,</span>
                <span class="s">&#39;vrhoa&#39;</span>         <span class="p">:</span> <span class="s">&#39;v_rho_a&#39;</span><span class="p">,</span>
                <span class="s">&#39;vrhob&#39;</span>         <span class="p">:</span> <span class="s">&#39;v_rho_b&#39;</span><span class="p">,</span>
                <span class="s">&#39;vsigmaaa&#39;</span>      <span class="p">:</span> <span class="s">&#39;v_gamma_aa&#39;</span><span class="p">,</span>
                <span class="s">&#39;vsigmaab&#39;</span>      <span class="p">:</span> <span class="s">&#39;v_gamma_ab&#39;</span><span class="p">,</span>
                <span class="s">&#39;vsigmabb&#39;</span>      <span class="p">:</span> <span class="s">&#39;v_gamma_bb&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2rhoa2&#39;</span>       <span class="p">:</span> <span class="s">&#39;v_rho_a_rho_a&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2rhoab&#39;</span>       <span class="p">:</span> <span class="s">&#39;v_rho_a_rho_b&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2rhob2&#39;</span>       <span class="p">:</span> <span class="s">&#39;v_rho_b_rho_b&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2rhoasigmaaa&#39;</span> <span class="p">:</span> <span class="s">&#39;v_rho_a_gamma_aa&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2rhoasigmaab&#39;</span> <span class="p">:</span> <span class="s">&#39;v_rho_a_gamma_ab&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2rhoasigmabb&#39;</span> <span class="p">:</span> <span class="s">&#39;v_rho_a_gamma_bb&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2rhobsigmaaa&#39;</span> <span class="p">:</span> <span class="s">&#39;v_rho_b_gamma_aa&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2rhobsigmaab&#39;</span> <span class="p">:</span> <span class="s">&#39;v_rho_b_gamma_ab&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2rhobsigmabb&#39;</span> <span class="p">:</span> <span class="s">&#39;v_rho_b_gamma_bb&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2sigmaaa2&#39;</span>    <span class="p">:</span> <span class="s">&#39;v_gamma_aa_gamma_aa&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2sigmaaaab&#39;</span>   <span class="p">:</span> <span class="s">&#39;v_gamma_aa_gamma_ab&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2sigmaaabb&#39;</span>   <span class="p">:</span> <span class="s">&#39;v_gamma_aa_gamma_bb&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2sigmaab2&#39;</span>    <span class="p">:</span> <span class="s">&#39;v_gamma_ab_gamma_ab&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2sigmaabbb&#39;</span>   <span class="p">:</span> <span class="s">&#39;v_gamma_ab_gamma_bb&#39;</span><span class="p">,</span>
                <span class="s">&#39;v2sigmabb2&#39;</span>    <span class="p">:</span> <span class="s">&#39;v_gamma_bb_gamma_bb&#39;</span><span class="p">,</span>
              <span class="p">}</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>

        <span class="n">mobj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">rho_line</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">mobj</span><span class="p">):</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
                <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
                <span class="n">point</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="n">point</span><span class="p">[</span><span class="s">&#39;rho_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mobj</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">point</span><span class="p">[</span><span class="s">&#39;rho_b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mobj</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">point</span><span class="p">[</span><span class="s">&#39;gamma_aa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mobj</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
            <span class="n">point</span><span class="p">[</span><span class="s">&#39;gamma_ab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mobj</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
            <span class="n">point</span><span class="p">[</span><span class="s">&#39;gamma_bb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mobj</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

            <span class="k">continue</span>

        <span class="n">mobj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">val_line</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">mobj</span><span class="p">):</span>
            <span class="n">point</span><span class="p">[</span><span class="n">aliases</span><span class="p">[</span><span class="n">mobj</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)]]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mobj</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>

    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">rho_a</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">rho_b</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">gamma_aa</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">gamma_ab</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">gamma_bb</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">tau_a</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">tau_b</span> <span class="o">=</span> <span class="n">PsiMod</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
        <span class="n">rho_a</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="s">&#39;rho_a&#39;</span><span class="p">]</span>
        <span class="n">rho_b</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="s">&#39;rho_b&#39;</span><span class="p">]</span>
        <span class="n">gamma_aa</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="s">&#39;gamma_aa&#39;</span><span class="p">]</span>
        <span class="n">gamma_ab</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="s">&#39;gamma_ab&#39;</span><span class="p">]</span>
        <span class="n">gamma_bb</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="s">&#39;gamma_bb&#39;</span><span class="p">]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="nb">super</span> <span class="o">=</span> <span class="n">build_superfunctional</span><span class="p">(</span><span class="n">functional</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nb">super</span><span class="o">.</span><span class="n">test_functional</span><span class="p">(</span><span class="n">rho_a</span><span class="p">,</span> <span class="n">rho_b</span><span class="p">,</span> <span class="n">gamma_aa</span><span class="p">,</span> <span class="n">gamma_ab</span><span class="p">,</span> <span class="n">gamma_bb</span><span class="p">,</span> <span class="n">tau_a</span><span class="p">,</span> <span class="n">tau_b</span><span class="p">)</span>

    <span class="n">v</span> <span class="o">=</span> <span class="nb">super</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s">&#39;V&#39;</span><span class="p">)</span>
    <span class="n">v_rho_a</span> <span class="o">=</span> <span class="nb">super</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s">&#39;V_RHO_A&#39;</span><span class="p">)</span>
    <span class="n">v_rho_b</span> <span class="o">=</span> <span class="nb">super</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s">&#39;V_RHO_B&#39;</span><span class="p">)</span>
    <span class="n">v_gamma_aa</span> <span class="o">=</span> <span class="nb">super</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s">&#39;V_GAMMA_AA&#39;</span><span class="p">)</span>
    <span class="n">v_gamma_ab</span> <span class="o">=</span> <span class="nb">super</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s">&#39;V_GAMMA_AB&#39;</span><span class="p">)</span>
    <span class="n">v_gamma_bb</span> <span class="o">=</span> <span class="nb">super</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s">&#39;V_GAMMA_BB&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">v_gamma_aa</span><span class="p">:</span>
        <span class="n">v_gamma_aa</span> <span class="o">=</span> <span class="n">tau_a</span>
        <span class="n">v_gamma_ab</span> <span class="o">=</span> <span class="n">tau_a</span>
        <span class="n">v_gamma_bb</span> <span class="o">=</span> <span class="n">tau_a</span>

    <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;v&#39;</span><span class="p">,</span> <span class="s">&#39;v_rho_a&#39;</span><span class="p">,</span> <span class="s">&#39;v_rho_b&#39;</span><span class="p">,</span> <span class="s">&#39;v_gamma_aa&#39;</span><span class="p">,</span> <span class="s">&#39;v_gamma_ab&#39;</span><span class="p">,</span> <span class="s">&#39;v_gamma_bb&#39;</span><span class="p">]</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;v&#39;</span><span class="p">:</span> <span class="n">v</span><span class="p">,</span>
            <span class="s">&#39;v_rho_a&#39;</span><span class="p">:</span> <span class="n">v_rho_a</span><span class="p">,</span>
            <span class="s">&#39;v_rho_b&#39;</span><span class="p">:</span> <span class="n">v_rho_b</span><span class="p">,</span>
            <span class="s">&#39;v_gamma_aa&#39;</span><span class="p">:</span> <span class="n">v_gamma_aa</span><span class="p">,</span>
            <span class="s">&#39;v_gamma_ab&#39;</span><span class="p">:</span> <span class="n">v_gamma_ab</span><span class="p">,</span>
            <span class="s">&#39;v_gamma_bb&#39;</span><span class="p">:</span> <span class="n">v_gamma_bb</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nb">super</span><span class="o">.</span><span class="n">print_detail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
        <span class="n">PsiMod</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s">&#39;rho_a= </span><span class="si">%11.3E</span><span class="s">, rho_b= </span><span class="si">%11.3E</span><span class="s">, gamma_aa= </span><span class="si">%11.3E</span><span class="s">, gamma_ab= </span><span class="si">%11.3E</span><span class="s">, gamma_bb= </span><span class="si">%11.3E</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rho_a</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">rho_b</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">gamma_aa</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">gamma_ab</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">gamma_bb</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>

        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
            <span class="n">v_ref</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="n">task</span><span class="p">]</span>
            <span class="n">v_obs</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">[</span><span class="n">task</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">v_obs</span> <span class="o">-</span> <span class="n">v_ref</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">v_ref</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">):</span>
                <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">epsilon</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">delta</span> <span class="o">/</span> <span class="n">v_ref</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">epsilon</span> <span class="o">&lt;</span> <span class="mf">1.0E-11</span><span class="p">):</span>
                <span class="n">passed</span> <span class="o">=</span> <span class="s">&#39;PASSED&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">passed</span> <span class="o">=</span> <span class="s">&#39;FAILED&#39;</span>
                <span class="n">check</span> <span class="o">=</span> <span class="bp">False</span>

            <span class="n">PsiMod</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="si">%-15s</span><span class="s"> </span><span class="si">%24.16E</span><span class="s"> </span><span class="si">%24.16E</span><span class="s"> </span><span class="si">%24.16E</span><span class="s"> </span><span class="si">%24.16E</span><span class="s"> </span><span class="si">%6s</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">v_ref</span><span class="p">,</span> <span class="n">v_obs</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">passed</span><span class="p">))</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">PsiMod</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">check</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
    <li><a href="../index.html">PSI4 [beta2]</a> &raquo; </li>

          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>

    <div class="footer">
        &copy; Copyright 2012, Psi4 Project.
      Last updated on Aug 25, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>