<!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->






<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Interface to Molden — molden()</title>
    <link rel="stylesheet" href="_static/psi4.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script type="text/javascript" src="_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="_static/cloud.base.js"></script>
    <script type="text/javascript" src="_static/cloud.js"></script>
    <link rel="shortcut icon" href="_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Interface to MRCC by M. Kállay" href="mrcc.html" />
    <link rel="prev" title="Interface to Libint by E. Valeev" href="libint.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="mrcc.html" title="Interface to MRCC by M. Kállay"
             accesskey="N"><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="libint.html" title="Interface to Libint by E. Valeev"
             accesskey="P"><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             accesskey="C"><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/molden.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/ecbda83">1.3.2</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="interfacing.html" accesskey="U">Interfaces: Enhancing <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> Capabilities</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="interface-to-molden-w-w-molden">
<span id="sec-molden"></span><span id="index-0"></span><h1>Interface to Molden — <a class="reference internal" href="#psi4.molden" title="psi4.molden"><code class="xref py py-func docutils literal notranslate"><span class="pre">molden()</span></code></a><a class="headerlink" href="#interface-to-molden-w-w-molden" title="Permalink to this headline">¶</a></h1>
<p><em>Code author: Justin M. Turney</em></p>
<p><em>Section author: C. David Sherrill</em></p>
<p><span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> contains an interface to the Molden program.  Molden is a
visualization program for electronic structure developed by Gijs Schaftenaar
at the University of of Nijmegen, Netherlands.  It is available at
<a class="reference external" href="http://www.cmbi.ru.nl/molden/">http://www.cmbi.ru.nl/molden/</a>.  Molden can
plot atomic orbitals, densities, electrostatic potentials (ESP’s), etc.
<span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> can create a file containing
atomic coordinates, basis set, and SCF orbital coefficients in the
so-called Molden format.  This file is
written by the SCF module (see Section <a class="reference internal" href="scf.html#sec-scf"><span class="std std-ref">SCF</span></a>)
if the user sets the <a class="reference internal" href="autodoc_glossary_options_c.html#term-molden-write-scf"><span class="xref std std-term">MOLDEN_WRITE</span></a> keyword to true.  This Molden file is
also used to pass information between <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> and WebMO, if <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>
computations are invoked using the WebMO GUI.  The filename of the
Molden file ends in “.molden”, and the prefix is determined by
<a class="reference internal" href="autodoc_glossary_options_c.html#term-writer-file-label-globals"><span class="xref std std-term">WRITER_FILE_LABEL</span></a> (if set), or else by the name of the output
file plus the name of the current molecule. If <a class="reference internal" href="autodoc_glossary_options_c.html#term-molden-with-virtual-globals"><span class="xref std std-term">MOLDEN_WITH_VIRTUAL</span></a>
is set to false, the unoccupied orbitals are not written to the Molden
file.</p>
<dl class="function">
<dt id="psi4.molden">
<code class="descclassname">psi4.</code><code class="descname">molden</code><span class="sig-paren">(</span><em>wfn</em>, <em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/psi4/driver/driver.html#molden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psi4.molden" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to write wavefunction information in <em>wfn</em> to <em>filename</em> in
molden format. Will write natural orbitals from <em>density</em> (MO basis) if supplied.
Warning! Most post-SCF Wavefunctions do not build the density as this is often
much more costly than the energy. In addition, the Wavefunction density attributes
(Da and Db) return the SO density and must be transformed to the MO basis
to use with this function.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.5: </span><em>wfn</em> parameter passed explicitly</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">None</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>wfn</strong> (<a class="reference internal" href="psi4api.html#psi4.core.Wavefunction" title="psi4.core.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a>) – set of molecule, basis, orbitals from which to generate cube files</li>
<li><strong>filename</strong> (<em>string</em>) – destination file name for MOLDEN file (optional)</li>
<li><strong>density_a</strong> (<a class="reference internal" href="psi4api.html#psi4.core.Matrix" title="psi4.core.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>) – density in the MO basis to build alpha NO’s from (optional)</li>
<li><strong>density_b</strong> (<a class="reference internal" href="psi4api.html#psi4.core.Matrix" title="psi4.core.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>) – density in the MO basis to build beta NO’s from, assumes restricted if not supplied (optional)</li>
<li><strong>dovirtual</strong> (<em>bool</em>) – do write all the MOs to the MOLDEN file (true) or discard the unoccupied MOs, not valid for NO’s (false) (optional)</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># [1] Molden file for DFT calculation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">energy</span><span class="p">(</span><span class="s1">&#39;b3lyp&#39;</span><span class="p">,</span> <span class="n">return_wfn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molden</span><span class="p">(</span><span class="n">wfn</span><span class="p">,</span> <span class="s1">&#39;mycalc.molden&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># [2] Molden file for CI/MCSCF computation using NO roots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">energy</span><span class="p">(</span><span class="s1">&#39;ci&#39;</span><span class="p">,</span> <span class="n">return_wfn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molden</span><span class="p">(</span><span class="n">wfn</span><span class="p">,</span> <span class="s1">&#39;no_root1.molden&#39;</span><span class="p">,</span> <span class="n">density_a</span><span class="o">=</span><span class="n">wfn</span><span class="o">.</span><span class="n">opdm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># [3] The following does NOT work, please see below</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">energy</span><span class="p">(</span><span class="s1">&#39;ccsd&#39;</span><span class="p">,</span> <span class="n">return_wfn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molden</span><span class="p">(</span><span class="n">wfn</span><span class="p">,</span> <span class="s1">&#39;ccsd_no.molden&#39;</span><span class="p">,</span> <span class="n">density_a</span><span class="o">=</span><span class="n">wfn</span><span class="o">.</span><span class="n">Da</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># [4] This WILL work, note the transformation of Da (SO-&gt;MO)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">properties</span><span class="p">(</span><span class="s1">&#39;ccsd&#39;</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dipole&#39;</span><span class="p">],</span> <span class="n">return_wfn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Da_so</span> <span class="o">=</span> <span class="n">wfn</span><span class="o">.</span><span class="n">Da</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SCa</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">doublet</span><span class="p">(</span><span class="n">wfn</span><span class="o">.</span><span class="n">S</span><span class="p">(),</span> <span class="n">wfn</span><span class="o">.</span><span class="n">Ca</span><span class="p">(),</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Da_mo</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">triplet</span><span class="p">(</span><span class="n">SCa</span><span class="p">,</span> <span class="n">Da_so</span><span class="p">,</span> <span class="n">SCa</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molden</span><span class="p">(</span><span class="n">wfn</span><span class="p">,</span> <span class="s1">&#39;ccsd_no.molden&#39;</span><span class="p">,</span> <span class="n">density_a</span><span class="o">=</span><span class="n">Da_mo</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<div class="section" id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<div class="section" id="molden-write">
<h3><a class="reference internal" href="autodoc_glossary_options_c.html#term-molden-write-scf"><span class="xref std std-term">MOLDEN_WRITE</span></a><a class="headerlink" href="#molden-write" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Do write a MOLDEN output file? If so, the filename will end in .molden, and the prefix is determined by <a class="reference internal" href="autodoc_glossary_options_c.html#term-writer-file-label-globals"><span class="xref std std-term">WRITER_FILE_LABEL</span></a> (if set), or else by the name of the output file plus the name of the current molecule.</p>
<ul class="simple">
<li><strong>Type</strong>: <a class="reference internal" href="notes_c.html#op-c-boolean"><span class="std std-ref">boolean</span></a></li>
<li><strong>Default</strong>: false</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="writer-file-label">
<h3><a class="reference internal" href="autodoc_glossary_options_c.html#term-writer-file-label-globals"><span class="xref std std-term">WRITER_FILE_LABEL</span></a><a class="headerlink" href="#writer-file-label" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Base filename for text files written by PSI, such as the MOLDEN output file, the Hessian file, the internal coordinate file, etc. Use the add_str_i function to make this string case sensitive.</p>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Default</strong>: No Default</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="molden-with-virtual">
<h3><a class="reference internal" href="autodoc_glossary_options_c.html#term-molden-with-virtual-globals"><span class="xref std std-term">MOLDEN_WITH_VIRTUAL</span></a><a class="headerlink" href="#molden-with-virtual" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Write all the MOs to the MOLDEN file (true) or discard the unoccupied MOs (false).</p>
<ul class="simple">
<li><strong>Type</strong>: <a class="reference internal" href="notes_c.html#op-c-boolean"><span class="std std-ref">boolean</span></a></li>
<li><strong>Default</strong>: true</li>
</ul>
</div></blockquote>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="index.html" title="index">
          <img class="logo" src="_static/psi4square.png" alt="Logo"/>
        </a></p><!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->


<div id="searchbox" style="display: none" role="search">
  <!--<h3>Quick search</h3>-->
    <form class="search" action="search.html" method="get">
      <!--<div><input type="text" name="q" placeholder="search docs" /></div>-->
      <div><input type="text" name="q" placeholder="&#xF002;" style="font-family:FontAwesome, Ariel" /></div>
      <!--<div><input type="submit" value="Go" /></div>-->
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="index.html">table of contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Interface to Molden — <code class="docutils literal notranslate"><span class="pre">molden()</span></code></a><ul>
<li><a class="reference internal" href="#options">Options</a><ul>
<li><a class="reference internal" href="#molden-write"><code class="docutils literal notranslate"><span class="pre">MOLDEN_WRITE</span></code></a></li>
<li><a class="reference internal" href="#writer-file-label"><code class="docutils literal notranslate"><span class="pre">WRITER_FILE_LABEL</span></code></a></li>
<li><a class="reference internal" href="#molden-with-virtual"><code class="docutils literal notranslate"><span class="pre">MOLDEN_WITH_VIRTUAL</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="mrcc.html" title="Interface to MRCC by M. Kállay"
             ><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="libint.html" title="Interface to Libint by E. Valeev"
             ><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             ><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/molden.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/ecbda83">1.3.2</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="interfacing.html" >Interfaces: Enhancing <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> Capabilities</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, The Psi4 Project.
      Last updated on Wednesday, 15 May 2019 08:49PM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>